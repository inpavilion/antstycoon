{"version":3,"sources":["units/units/db.js","units/units/reactAssembler.js","components/CodeMirrorEditor.js","managers/KeyboardManager.js","managers/TimerManager.js","units/main.js","units/units/actionFlow.js","units/units/brand.js","units/units/bubbleBoard.js","units/units/bubbleFlow.js","units/units/bubbleGuns.js","units/units/bubbleTest.js","units/units/bubbleTypes.js","units/units/parseObjIntoMold.js","units/units/parseStringIntoComp.js","units/units/prettyScode.js","components/MyInput.js","components/TreeDiagram.js","components/TreeMap.js","units/units/reactUtils.js","units/units/store.js","units/units/testDataGenerator.js","units/units/testMolds.js","units/units/testTplAssembling.js","units/units/tplObjParse.js","units/units/treeCardsBuilder.js","units/units/treeIterator.js","units/units/uids.js","units/init.js","units/index.js","FlatAnt5.js","App.js","serviceWorker.js","index.js","../../data-department/dataManager.js","logo.svg"],"names":["lodash__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","lodash__WEBPACK_IMPORTED_MODULE_0___default","n","faker__WEBPACK_IMPORTED_MODULE_1__","faker__WEBPACK_IMPORTED_MODULE_1___default","pouchdb__WEBPACK_IMPORTED_MODULE_2__","pouchdb_find__WEBPACK_IMPORTED_MODULE_3__","pouchdb_quick_search__WEBPACK_IMPORTED_MODULE_4__","pouchdb_quick_search__WEBPACK_IMPORTED_MODULE_4___default","PouchDB","plugin","PouchDBFind","PouchDBQuickSearch","cu","window","ub","ctx","serialize","obj","_","cloneDeepWith","value","isFunction","TYPE","body","toString","deserialize","item","fn","eval","e","save","id","db","this","uid","generateUid","_id","get","then","doc","rev","_rev","put","i","catch","err","load","_this","cfg","state","nextId","prefix","init","name","auto_compaction","Date","getTime","Math","random","Object","create","destroy","alert","loadfilter","selector","count","sort","find","partialTextSearch","word","query","emit","text","split","filter","length","forEach","element","type","map","mapId","parent","parentId","test","startKey","endKey","searchText","search","fields","include_docs","highlighting","loadFromIndex","sortField","sortDir","limit","$gt","set","createIndex","index","result","docs","x","y","obj2","run","def","debug","tb","model","data","getter","cloneDeep","mold","tpl","applyOps","ops","props","tplid","newOps","op","action","path","join","PATH","VALUE","unset","console","error","inputs","#color","#handle","#test2","#test1","#title","tests","pin","reactAssembler","moldAssembler","require","Component","DataManager","KeyboardManager","setup","isInitialized","$","on","evt","handleKey","setTrigger","layout","getValue","altKey","push","ctrlKey","metaKey","shiftKey","key","toLowerCase","comb","TimerManager","wallet","timers","start","delay","clearTimeout","timer","setTimeout","cancel","date","end","actionsBundle","saveItems","v","items","isArray","uids","loadItem","loadedItems","append","loadItems","actions","appendById","setValue","ids","keys","searchItems","loadFilter","log","core","triggerRerun","val","running","shouldRerun","runAllOps","prepareOp","args","src","input","isString","undefined","partial","missing","OP","runOp","getUid","master","opIsDone","ncOps","checkGuards","values","pinTo","staticValue","privat","getFromPrivate","getValueWithPrefix","triggers","isPartial","guards","target","slot","generic","assembleObj","opState","isEqual","tpls","listTemplate","list","useTpl","flowGuards","makeTriggers","makeTrigger","guard","trigger","opt","opsCollection","valuesChain","open","addTriggers","addActionsCollection","addMainOps","addValuesChains","chains","chain","collection","info","fetchCollection","addActions","assign","isCollection","merge","getAction","addOps","triggerCollection","concat","opName","extra","changeData","getOpen","applyValuesChain","reset","actionFlow","specs","setupFlow","opts","_this2","actionsFlow","refreshOpen","getRandomFn","str","seed","charCodeAt","sin","floor","getBrand","randomFn","baseBrand","brand","mainColor_hsl","getColor","complementColor_hsl","mainColor","complementColor","fadedColor","baseColor","hue","color","chroma","hsl","getRandom","scale","max","pointsStar","polies","_loop","j","poligonPoints","col","classname","round","points","getLogo","bubbleBoard","addItem","getId","mergeItem","minStep","changed","appendTo","results","versions","isReady","completedAt","rewindTo","onchanged","step","createdAt","hasChanges","bubbleid","charAt","substring","isObject","isMatch","version","evalItems","affected","_evalItems","isCompleteValues","evalItem","node","getNode","bubble","defaultsDeep","trails","rels","bellow","above","uses","checkIfComplete","evaluateflow","getVersion","bubbleFlow","fns","doubleCheck","evaluate","checks","check","shaddow","score","subs","total","resolved","unresolved","tplParams","defined","parameters","param","targetId","_setup","shaft","fullPath","getFull","route","base","relPath","fetch","it","cb","oldValues","sub","paths","stateCurrentId","currentItem","targetid","compile","clues","needes","provides","collections","subScore","params","undefinedCount","definedCount","bubbleGuns","bubbleTypes","dispatch","bubbleTest","nodeType","tplObjParse","viewAs","dataNode","reactNode","neededValues","cues","pins","mirror","description","newItem","bubbles","cache","newId","newValues","mirrorBubble","types","payload","oldPayload","comments","getTpl","opValues","newValue","indexOf","replace","addOp","stage","addComment","comment","finalOp","firstChar","concatParent","parseObjIntoMold","phase1","html","trim","nest","document","createElement","innerHTML","childNodes","el","spec","_spec","nodeValue","attributes","attr","all","char","toUpperCase","class","className","style","_style","componentName","nodeName","children","htmlSlot","child","match","reg","css","exec","phase2","attrs","watchAttrs","iterate","a","b","handleObj","childrenPath","subPath","handleProp","prepareAction","concatOp","_this3","parseStringIntoComp","nextUID","makestr","indent","usequouts","js_beautify","indent_size","indent_level","preserve_newlines","max_preserve_newlines","indent_inner_html","trimStart","lines","isObjectLike","isNil","beautify","prettyScode","MyInput","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","onChange","bind","assertThisInitialized","setState","nextProps","React","MapDiagram","ref","createRef","makeTree","drawTree","graph","svg","d3","current","d3cola","webcola","avoidOverlaps","h","height","w","width","nodes","radius","pageBounds","realGraphNodes","slice","topLeft","fixed","tlIndex","bottomRight","brIndex","constraints","nodeRadius","axis","left","right","gap","size","links","linkDistance","flowLayout","symmetricDiffLinkLengths","selectAll","enter","d","drag","titles","source","newprops","react_default","TreeMap","vis","DataSet","edges","network","Network","randomSeed","autoResize","getNodeAt","pointer","DOM","onClick","update","clear","add","customComponents","myinput","mapdiagram","treemap","makeComponent","flattenDeep","component","reactUtils","tplComponent","createStore","hapi","store","parents","stopPropagation","change","runWith","runWithParam","getItem","getSubs","registerTpl","cases","faker","company","catchPhrase","setter","level","generated","uuid","arrayElement","prepare","ret","integrate","addPayload","_case","testDataGenerator","parser","testMolds","parseTpl","renderTpl","assembleTpl","molds","iterateBubbles","shouldAssemble","isRegistered","addBubble","computedAtStep","addedAtStep","salut","testTplAssembing","value_setter","content","#test","tplId","isUnparsedTpl","isObjTpl","parseHtml","parseObj","_check","payload1","tplsMapping","defaultTpl","usedGlobalStyles","addSubs","card","useTemplate","skipGlobalStyle","root","globalStyle","title","getMolds","buildTpls","iterator","addGlobalStyles","gbs","styles","makeSelector","treeCardsBuilder","repo","mappings","treeIterator","mub","pending","passes","shift","group","groupEnd","ctxpins","newAPI","TimerManagerBuilder","myUB","setCombined","loader","fnsub","make","old","setupAll","makeUb","tb.db","goSetup","autostart","runAll","scrollIntoViewSelected","scrollIntoViewIfNeeded","alertAnimation","addClass","removeClass","onready","request_save","waiting","c","promise","Promise","resolve","setupRequired","ubs","detach","getFromParent","names","addUb","addUbs","setupUb","_this4","getItemsToSave","promises","makePreview","argsArray","antId","makeTreeMap","shops","go","actionName","getWallet","createShop","view","loaderPath","blockcfg","markChangeOn","tree","treeTemplate","processNode","makeNode","startId","startNode","maxLevel","field","defaultValue","makeMold","main","outcome","import","my","runop","combineMoldInOps","needed","maps","previewIds","no","previews","myx","iterateList","generatePreview","DONE","generatePreviewItems","getItemsWithsNoPreview","subitems","line","time","timestamp","xcontent","getSubitems","placedAt","makeTime","moment","fromNow","reject","runopOnList","opargs","selectIds","withPreview","wt","preview","rels.allSubs","summary","updatedAt","use","latestSubs","bundle","getLatestSubs","latest","startedAt","position","_s","getActions","select","getNodes","parentIndex","getNodesVis","label","to","from","showMindMap","runOnLoader","showhud","currentView","goToCard","placeorder","which","flow","place","restart","parseinput","parse","focus","afterRenderActions","goToInfo","bridge","bridgeLoader","loadBridge","selectMap","mapview","loadMap","getAll","showMenu","hideMenu","addEntries","showSearch","noPlace","substr","editStartedAt","firstCharAt","antsDbState","getParent","prevStep","selectItem","addInfo","changeItem","createMap","ant","allSubs","history","changeAt","now","hasInfo","mergeRoot","_this5","startIds","related","top","notdb","recent","ant1","_this6","customTpl","logo","generateId","skipPreview","triggerChange","_this7","timerPreview","shop","setRel","rel","mapView","frame","topic","entry","other","button","handle","bridgeTitle","mapTitle","uistate","rows","selected","otherTpl","moldsMap","cardMold","background","colors","getBody","setV","memo","cleanV","getBodyList","isSelected","afterContent","getHandle","String","fromCharCode","moldName","titleMold","titlePath","addVFn","tplSpecs","byLevel","borderColor","advanceView","makeItem","makeList","stack","clean","stacks","pop","_this8","onbeforeunload","saveAll","loadAll","_this9","tosave","savings","saveitem","loaditem","onload","runOn","starter","done","overPanel","bubbleitem","menuitem","orderText","order","loading","dependsOn","updateVersionsMap","viewState","changeOrder","bumbAction","placeOrder","dim","barHeight","bubbleList","bumb","textColor","menu","panel","historyManager","recording","runToStart","Frame","_this10","_this11","components","FlatAnt","_this12","scode","FlatAnt5_Frame","App","FlatAnt5","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","src_App_0","getElementById","publicUrl","URL","process","href","origin","addEventListener","response","contentType","headers","status","ready","unregister","reload","checkValidServiceWorker","currentStack","startStack","prevStack","skipClone","endStack","_DataManager","gettingValue","meta","loadersCache","currentVersion","dependencies","agenda","tasks","toStart","flags","setCtx","basePath","ctxPath","getCtx","runFn","fnName","targetPath","getInfluenced","influenced","dep","skipPartialValueCheck","checkCache","partialPath","partialResult","partialSlot","partialValue","listToValue","setCache","shouldUpdate","ignoreUpdates","prepareCache","contains","diffCache","oldCache","addDependency","remDependency","newC","oldC","depOn","walletValue","srcPath","rootPath","_item","_i","silentSet","skipPathAffected","getAffectedPaths","postponedSteps","hasSteps","snoozeCount","getFromLoader","addLog","lhs","rhs","cachedValue","xcache","requester","force","logger","prism","loadedPrism","getFromDispatch","_value","TB","skipCache","runUtils","apply","mergeValue","oldValue","changedPaths","addPath","pauseAll","setObObj","updateVersionForAll","req_triggers","runningReqTriggers_timer","clearInterval","runningAgendaTriggers_timer","setInterval","callback","stop","requestAnimationFrame","stopFn","asyncTriggers","affected_checked","lazy_checkTriggers","req_Agenda","asyncTriggersAgenda","runTrigger","listener","token","sortAgenda","taskA","taskB","salience","appendToArray","setVersion","setByLoader","isLoaders","strPath","affected_version","skipTrigger","incAffected","incVersion","updateVersion","markChangedPaths","checkTriggers","setUpdateFlag","runTriggers","fetchValues","onlyPaths","_path","_path2","KEY","loaders","loadersPaths","afterOp","isEmpty","currentPins","_pin","pinKey","isLoader","dest","hasVersion","hasLoaders","lPath","buildModel","tokens","modelName","MODEL","handleTokens","modelObj","modelSpec","_value2","newObj","setLoader","getStaticValue","getUID","getTrigger","remTrigger","listenerPath","oldTrigger","destination","prepareLoader","deepTransformObj","setMap","versionsTree","getVersionTree","objectDiff","oldObject","newObject","changes","oldO","newO","subChanges","act","ACT","toolbox","run_fetch","singlePath","SINGLEPATH","subPrefix","_subPrefix","pathOf","last_src","detached","feed","arguments","in","module","exports","p"],"mappings":"oIAAA,IAAAA,oCAAAC,oBAAA,GAAAC,4CAAAD,oBAAAE,EAAAH,qCAAAI,mCAAAH,oBAAA,GAAAI,2CAAAJ,oBAAAE,EAAAC,oCAAAE,qCAAAL,oBAAA,IAAAM,0CAAAN,oBAAA,KAAAO,kDAAAP,oBAAA,KAAAQ,0DAAAR,oBAAAE,EAAAK,mDAMAE,uCAAQC,OAAOC,6CACfF,uCAAQC,OAAOE,6DAEf,IAAIC,GAAKC,OAAOD,GAGZE,GAAK,CAELC,IAAK,GAELC,UAAY,SAAUC,GAKlB,OAJWC,8CAAEC,cAAeF,EAAK,SAAWG,GACxC,GAAKF,8CAAEG,WAAYD,GAAU,MAAO,CAAEE,KAAO,KAAMC,KAAOH,EAAMI,eAMxEC,YAAc,SAAAA,YAAWR,KACrB,IAAIS,KAAOR,8CAAEC,cAAeF,IAAK,SAAWG,OACxC,GAAKA,OAAuB,MAAdA,MAAME,KAAe,CAC/B,IAAIK,GACJ,IACIC,KAAM,MAAQR,MAAMG,MACtB,MAAOM,IAGT,OAAOF,MAIf,OAAOD,MAGXI,KAAM,SAAUV,EAAOW,GACnB,IAAIC,EAAKC,KAAKlB,IAAIiB,GAEdN,EAAOO,KAAKjB,UAAWI,GAI3B,OAHKM,EAAKQ,MAAKR,EAAKQ,IAAMH,GAAML,EAAKK,IAAME,KAAKE,eAC3CT,EAAKU,MAAKV,EAAKU,IAAMV,EAAKQ,KAExBF,EAAGK,IAAIX,EAAKU,KAChBE,KAAK,SAACC,GACL,IAAIC,EAAMD,EAAIC,IACVC,EAAOF,EAAIE,KAIf,OAFAf,EAAKc,IAAMA,EACXd,EAAKe,KAAOA,EACLT,EAAGU,IAAIhB,GAAMY,KAAM,SAAEK,QAG7BC,MAAM,SAAAC,GACL,OAAOb,EAAGU,IAAIhB,MAStBoB,KAAM,SAAUf,GAAI,IAAAgB,EAAAd,KAChB,OAAOA,KAAKlB,IAAIiB,GAAGK,IAAIN,GAAIa,MAAO,SAAAf,GAC9B,OAAO,OAEVS,KAAO,SAAAZ,GAEJ,OADKA,IAAOA,EAAOqB,EAAKtB,YAAaC,IAC9BA,KAKfS,YAAc,WAEV,OADAF,KAAKe,IAAIC,MAAMC,SACRjB,KAAKe,IAAIC,MAAME,OAAS,IAAMlB,KAAKe,IAAIC,MAAMC,QAGxDE,KAAM,SAAUC,GACZ,IAAItC,EAAM,CACNiB,GAAI,IAAIxB,uCAAQ6C,EAAM,CAACC,iBAAiB,IACxCL,MAAO,CACHE,QAAQ,IAAII,MAAOC,UAAUhC,WAAa,IAAMiC,KAAKC,SAASlC,WAC9D0B,OAAQ,EACRnB,GAAK,UAITL,EAAOiC,OAAOC,OAAO3B,MASzB,OAPAP,EAAKX,IAAMA,EAEXW,EAAKoB,KAAK,SAASR,KAAK,SAAAW,GACfA,EAAQvB,EAAKX,IAAIkC,MAAQA,EACzBvB,EAAKI,KAAMJ,EAAKX,IAAIkC,SAGtBvB,GAGXmC,QAAU,WACN5B,KAAKlB,IAAIiB,GAAG6B,UACPvB,KAAO,WAEJwB,MAAO,mBAInBC,WAAa,SAAWC,EAAUC,EAAOC,GACrC,OAAOjC,KAAKlB,IAAIiB,GAAGmC,KAAM,CAAEH,cAG/BI,kBAAoB,SAAWC,GAC3B,OAAOpC,KAAKlB,IAAIiB,GAAGsC,MAAO,SAAC/B,EAAKgC,GACtBhC,EAAIiC,MACGjC,EAAIiC,KAAKC,MAAO,QACtBC,OAAQ,SAAAL,GAAI,OAAIA,EAAKM,OAAS,IAAIC,QAAQ,SAAAC,GAC7CN,EAAMM,EAAS,CAAEC,KAAOvC,EAAIuC,KAAMC,IAAMxC,EAAIyC,MAAQC,OAAS1C,EAAI2C,SAAUC,KAAO,aAEvF,CAACC,SAAWf,EAAMgB,OAAShB,EAAO,QAGzCiB,WAAa,SAAWd,GACpB,OAAOvC,KAAKlB,IAAIiB,GAAGuD,OAAQ,CACvBjB,MAAOE,EACPgB,OAAQ,CAAC,QAAS,QAClBC,cAAc,EACdC,cAAc,KAItBC,cAAgB,SAAW3B,EAAU4B,EAAWC,EAASC,EAAON,GAC5D,IAAIxD,EAAKC,KAAKlB,IAAIiB,GAGZgC,EAAS4B,KAAa5B,EAAS4B,GAAa,CAAEG,IAAM,OAC1D,IAAI7B,EAAO,CAAChD,8CAAE8E,IAAK,GAAIJ,EAAWC,EAAU,OAAS,QACrD,OACI7D,EAAGiE,YACC,CAACC,MAAQ,CACLV,OAASA,KAGhBlD,KAAO,SAAC6D,GACL,OAAOA,EAAO9C,OAEjBf,KAAM,SAAC4D,GAEJ,OAAOlE,EAAGmC,KAAM,CAACH,WAAW8B,QAAO5B,SAAO5B,KAAM,SAAA6D,GAAM,OAAIA,EAAOC,WAU7EjB,KAAO,SAACgB,GACRA,EAAOlF,IAAMH,GAAGE,UAAW,CAACqF,EAAI,aAAkBC,EAAI,SAEtDH,EAAOI,KAAOzF,GAAGW,YAAa0E,EAAOlF,KAErCH,GAAGsC,KAAK,WAIZxC,GAAGoB,GAAK,CAEJwE,IAAK,SAAUnD,GACX,OAAOvC,GAAGsC,KAAKC,IAGnBoD,IAAG,SAGHC,MAAO,CACH5F,GAAIA,qKCtLZ,IAAAhB,oCAAAC,oBAAA,GAAAC,4CAAAD,oBAAAE,EAAAH,qCACIc,GAAKC,OAAOD,GAGZE,GAAK,CAELC,IAAK,CACD4F,GAAI,IAGRH,IAAK,SAAUI,EAAOC,EAAMC,GAExB,IAAI7F,GADJ2F,EAAQ1F,8CAAE6F,UAAUH,IACJI,KAAKC,IASrB,OAPAhF,KAAKiF,SAASN,EAAMI,KAAKG,IAAKlG,EAAK4F,EAAMC,GAGrC7F,EAAImG,QACJnG,EAAImG,MAAMC,MAAQT,EAAM1E,KAGrBjB,GAGXiG,SAAU,SAAAA,SAAUC,IAAKlG,IAAK4F,KAAMC,QAIhC,IAHA,IAAIzE,IAAMyE,QAAU5F,8CAAEmB,IAElBiF,OAAS,GACJ3E,EAAI,EAAGA,EAAIwE,IAAIxC,OAAQhC,IAAK,CAEjC,IAAI4E,GAAKJ,IAAIxE,GAEb,GAAe,SAAX4E,GAAGzC,KAAiB,CACpB,IAAI1D,MAAQiB,IAAIwE,KAAMU,GAAGC,OAAQD,GAAID,QACrCpG,8CAAE8E,IAAI/E,IAAKsG,GAAGE,KAAMrG,YAEnB,GAAe,iBAAXmG,GAAGzC,KAAyB,CACjC,IAAI1D,OAAQmG,GAAGnG,MACfF,8CAAE8E,IAAI/E,IAAKsG,GAAGE,KAAMrG,aAEnB,GAAe,UAAXmG,GAAGzC,KAAkB,CAC1B,IAAI1D,QAAQiB,IAAIpB,IAAKsG,GAAGE,KAAMF,GAAID,QAAQI,KAAK,IAC/CxG,8CAAE8E,IAAI/E,IAAKsG,GAAGE,KAAMrG,cAEnB,GAAe,WAAXmG,GAAGzC,KAAmB,CAC3B,IAAI1D,QAAQiB,IAAIpB,IAAKsG,GAAGE,KAAMF,GAAID,QAElCpG,8CAAE8E,IAAK/E,IAAKG,QAAMuG,KAAMvG,QAAMwG,OAC9B1G,8CAAE2G,MAAO5G,IAAKsG,GAAGE,WAEhB,GAAe,gBAAXF,GAAGzC,KAAwB,CAChC,IAAIvD,KAAOc,IAAIpB,IAAKsG,GAAGE,KAAMF,GAAID,QAAQI,KAAK,IAC9C,IACI,IAAI/F,QAAE,EACNC,KAAK,MAAQL,MAEbL,8CAAE8E,IAAI/E,IAAKsG,GAAGE,KAAM9F,IAExB,MAAOE,GACHiG,QAAQC,MAAQ,iBAAmBxG,QAK3C+F,OAAO3C,QACP1C,KAAKiF,SAASI,OAAQrG,IAAK4F,KAAMC,UAOzCkB,OAAS,CACTnB,KAAM,CACFoB,SAAU,GACVC,UAAW,SACXC,SAAU,QACVC,SAAU,QACVC,SAAU,gBAIdlD,KAAO,SAACgB,GAER,IAAIa,EAAOpG,GAAG0H,MAAMjG,IAAI,UAExB,IAAK2E,EAAM,MAAO,UAElB,IAAI5F,EAAQN,GAAG0F,IAAIQ,EAAMgB,OAAOnB,MAEhCV,EAAO/E,MAAQA,EACf+E,EAAOa,KAAOA,EAEdpG,GAAG0H,MAAMC,IAAI,YAAanH,IAK9BR,GAAG4H,eAAiB,CAGhBhC,IAAK,SAAUQ,EAAMH,EAAMC,GACvB,OAAOhG,GAAG0F,IAAIQ,EAAMH,EAAMC,IAG9B1D,KAAM,aAGNqD,IAAG,SAGHC,MAAO,CACH5F,GAAIA,KAIZF,GAAG6H,cAAgB7H,GAAG4H,sLChHtBE,EAAQ,KAEuBC,gDCD3BC,eAAc/H,OAAO+H,aAGrBC,EAAkB,CAClBC,MAAO,WAAY,IAAA/F,EAAAd,KACXA,KAAK8G,gBAETC,IAAE,QAAQC,GAAG,UAAW,SAACC,GACrBnG,EAAKoG,UAAUD,KAGnBN,EAAYQ,WAAW,2BAA4B,aAAc,CAC7D5C,IAAK,WACDzD,EAAKD,UAGbb,KAAKa,SAGTA,KAAM,WACF,IAAIuG,EAAST,EAAYU,SAAS,4BAClCrH,KAAKoH,OAASA,GAAU,IAG5BF,UAAW,SAAUD,GACjB,IAAI7F,EAAO,GACP6F,EAAIK,QAAQlG,EAAKmG,KAAK,OACtBN,EAAIO,SAASpG,EAAKmG,KAAK,QACvBN,EAAIQ,SAASrG,EAAKmG,KAAK,QACvBN,EAAIS,UAAUtG,EAAKmG,KAAK,SAE5BnG,EAAKmG,KAAKN,EAAIU,IAAIC,eAClB,IAAIC,EAAOzG,EAAKqE,KAAK,KAErB,GAAIzF,KAAKoH,OAAOS,GACZ,OAAO7H,KAAKuE,IAAIvE,KAAKoH,OAAOS,GAAOA,IAG3CtD,IAAK,SAAUgB,EAAOsC,GAClB,OAAI5I,IAAEG,WAAWmG,GAAgBA,EAAOsC,EAAMtC,GACrCA,EAAOhB,IACLgB,EAAOhB,IAAIsD,EAAMtC,QADvB,IAKbqB,EAAgBC,QAEDD,ICpDXkB,EAAe,CACf3G,KAAO,SAAWwF,GAChB,IAAIlH,EAAOiC,OAAOC,OAAQ3B,MAI1B,OAFAP,EAAKkH,YAAcA,EACnBlH,EAAKsI,OAAS,CAACC,OAAS,IACjBvI,GAETsI,OAAQ,CAAEC,OAAQ,IAElBC,MAAO,SAAU7G,EAAMmE,EAAQ2C,GAAO,IAAApH,EAAAd,KAChCA,KAAK+H,OAAOC,OAAO5G,IAAOxC,OAAOuJ,aAAanI,KAAK+H,OAAOC,OAAO5G,IAErE,IAAIgH,EAAQxJ,OAAOyJ,WAAW,WAC5BvH,EAAKwH,OAAQlH,GACbmE,EAAOnE,EAAMmE,EAAQ2C,IACpBA,GAEHlI,KAAK+H,OAAOC,OAAO5G,GAAQgH,EAE3B,IAAIG,EAAO,IAAIjH,KACftB,KAAK2G,YAAY5C,IAAI,sBAAyB3C,EAAO,CAAE6G,MAAQM,EAAKhH,UAAWiH,IAAMD,EAAKhH,UAAY2G,KAGxGI,OAAQ,SAAUlH,GACZpB,KAAK+H,OAAOC,OAAO5G,IAAOxC,OAAOuJ,aAAanI,KAAK+H,OAAOC,OAAO5G,WAC9DpB,KAAK+H,OAAOC,OAAO5G,GAC1BpB,KAAK2G,YAAY5C,IAAI,sBAAyB3C,EAAO,+CC1BvDzC,EAAK,GAETC,OAAOD,GAAKA,EAEGA,QCHXA,EAAKC,OAAOD,GAGZ8J,EAAgB,GAEpBA,EAAc1I,GAAK,CAEf2I,UAAY,SAAWpD,EAAIqD,GACvB,IAAIC,EAAQ3J,IAAE4J,QAASvD,EAAGsD,OAAUtD,EAAGsD,MAAQ,CAACtD,EAAGsD,OACnDD,EAAEjE,GAAG3E,GAAG2I,UAAW/J,EAAGmK,KAAKvE,MAAQqE,IAGvCG,SAAU,SAAUzD,EAAIqD,GAEpB,IACIK,EAEC1D,EAAG2D,QAAUN,EAAE/D,KAAMU,EAAG2D,UACzBD,EAAeL,EAAE/D,KAAMU,EAAG2D,SAG9BN,EAAEjE,GAAG3E,GAAGmJ,UAAU,CAAC5D,EAAGxF,IAAKkJ,GAAc3I,KAAK,SAAAZ,GAEtCkJ,EAAEL,SAEFhD,EAAG2D,QACHN,EAAEQ,QAAQC,WAAW,CAAE5D,KAAMF,EAAG2D,OAAQ9J,MAAOM,GAAQkJ,GAGvDrD,EAAGgB,KACHqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAMF,EAAGgB,IAAKnH,MAAOM,EAAK,IAAMkJ,OAKjEO,UAAW,SAAU5D,EAAIqD,GACrB,IACIK,EADAM,EAAMrK,IAAE4J,QAAQvD,EAAGgE,KAAOhE,EAAGgE,IAAM5H,OAAO6H,KAAKjE,EAAGgE,KAGjDhE,EAAG2D,QAAUN,EAAE/D,KAAMU,EAAG2D,UACzBD,EAAeL,EAAE/D,KAAMU,EAAG2D,SAG9BN,EAAEjE,GAAG3E,GAAGmJ,UAAUI,EAAKN,GAAa3I,KAAK,SAAAuI,GAEjCD,EAAEL,SAGFhD,EAAG2D,QACHN,EAAEQ,QAAQC,WAAW,CAAE5D,KAAMF,EAAG2D,OAAQ9J,MAAOyJ,GAASD,GAExDrD,EAAGgB,KACHqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAMF,EAAGgB,IAAKnH,MAAOyJ,GAASD,OAK/DjF,cAAgB,SAAW4B,EAAIqD,GAC3BA,EAAEjE,GAAG3E,GAAG2D,cAAe4B,GAAKjF,KAAM,SAAAuI,GAE1BD,EAAEL,SAGFhD,EAAG2D,QACHN,EAAEQ,QAAQC,WAAW,CAAE5D,KAAMF,EAAG2D,OAAQ9J,MAAOyJ,GAASD,GAExDrD,EAAGgB,KACHqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAMF,EAAGgB,IAAKnH,MAAOyJ,GAASD,OAI/Da,YAAa,SAAUlE,EAAIqD,GACvB,IAAIlG,EAAS6C,EAAG7C,OAEhBkG,EAAEjE,GAAG3E,GAAG0J,WAAWhH,GAAQpC,KAAK,SAAA8D,GAE5B,IAAIyE,EAAQzE,EAAKA,KAEbwE,EAAEL,SAGNzC,QAAQ6D,IAAI,eAAgBd,GAGxBtD,EAAG2D,QACHN,EAAEQ,QAAQC,WAAW,CAAE5D,KAAMF,EAAG2D,OAAQ9J,MAAOyJ,GAASD,GAExDrD,EAAGgB,KACHqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAMF,EAAGgB,IAAKnH,MAAOyJ,GAASD,OAK/DtF,WAAY,SAAUiC,EAAIqD,GACtB3I,KAAK0E,GAAG3E,GAAGsD,WAAWiC,EAAG/C,MAAMlC,KAAK,SAAAuI,GAE5BD,EAAEL,QAGFhD,EAAGgB,KACHqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAMF,EAAGgB,IAAKnH,MAAOyJ,GAASD,OAKnEF,EAAckB,KAAO,CACjBC,aAAc,SAAUC,EAAKlB,GACrBA,EAAEmB,QACFnB,EAAEoB,aAAc,EAGhBpB,EAAEQ,QAAQa,UAAU,GAAIrB,IAIhCsB,UAAW,SAAU3E,EAAIqD,GACrB,IAAIuB,EAAO,CAAEC,IAAK,IAClB,IAAK,IAAIzJ,KAAK4E,EAAG8E,MACb,GAAS,QAAL1J,EAAawJ,EAAKrH,KAAOyC,EAAG8E,MAAM1J,QACjC,GAAKzB,IAAEoL,SAAS/E,EAAG8E,MAAM1J,IACzB,CACDwJ,EAAKC,IAAIzJ,GAAK4E,EAAG8E,MAAM1J,GACvB,IAAIvB,EAAQwJ,EAAEQ,QAAQ9B,SAAS/B,EAAG8E,MAAM1J,GAAIiI,GAC5C,QAAc2B,IAAVnL,EAAqB,CACrB,IAAKmG,EAAGiF,QACJ,OAAO,KAEFL,EAAKM,UAASN,EAAKM,QAAU,IAClCN,EAAKM,QAAQjD,KAAK7G,QAGrBwJ,EAAKxJ,GAAKvB,OAZgB+K,EAAKxJ,GAAK4E,EAAG8E,MAAM1J,GAe1D,IAAK,IAAIA,KAAK4E,EACD,SAAL5E,IACAwJ,EAAKxJ,GAAK4E,EAAG5E,IAKrB,OAFAwJ,EAAKO,GAAKnF,EAEH4E,GAEXQ,MAAO,SAAUpF,EAAIqD,GACZrD,EAAGrF,MAAKqF,EAAGrF,IAAM0I,EAAEQ,QAAQwB,OAAO,GAAIhC,IAC3C,IAAIuB,EAAOvB,EAAEQ,QAAQc,UAAU3E,EAAIqD,GACnC,OAAa,OAATuB,EACO,eAGPA,EAAK9I,OAAM8I,EAAK5D,IAAM4D,EAAK9I,MAE1BuH,EAAEQ,QAAQe,EAAKrH,OAChBgD,QAAQC,MAAM,CAAE6C,IAAGuB,OAAM5E,OAIf,gBAFFqD,EAAEQ,QAAQe,EAAKrH,MAAMqH,EAAMvB,GAEH,mBAApC,IAGJgC,OAAQ,SAAUT,EAAMvB,GAGpB,OAFAA,EAAEiC,OAAO5J,MAAMC,SACN,MAAQ0H,EAAEiC,OAAO5J,MAAMC,QAIpC4J,SAAU,SAAUvF,EAAIqD,GACpB,OAAIrD,EAAGiF,YACFjF,EAAGgB,UAEyBgE,IAA1BrL,IAAEmB,IAAIuI,EAAE/D,KAAMU,EAAGgB,OAG5B0D,UAAW,SAAUE,EAAMvB,GAMvB,IAAK,IAAIjI,KALTiI,EAAEmC,MAAQ,GAEVnC,EAAEmB,SAAU,EACZnB,EAAEoB,aAAc,EAEFpB,EAAEzD,IAAK,CACjB,IAAII,EAAKqD,EAAEzD,IAAIxE,GAGf,IADaiI,EAAEQ,QAAQ0B,SAASvF,EAAIqD,GAIlB,gBAFFA,EAAEQ,QAAQuB,MAAMpF,EAAIqD,GAEHA,EAAEmC,MAAMvD,KAAKjC,GACrCqD,EAAEoB,aAAc,EAI7BpB,EAAEzD,IAAMyD,EAAEmC,MAEVnC,EAAEmB,SAAU,EAERnB,EAAEoB,aACFpB,EAAEoB,aAAc,EAChB/J,KAAKgK,UAAUE,EAAMvB,IAIC,GAAlBA,EAAEmC,MAAMpI,QACRiG,EAAEQ,QAAQ4B,YAAY,CAAEvF,KAAM,QAAUmD,KAaxDF,EAAcuC,OAAS,CACnBC,MAAO,SAAUf,EAAM/K,EAAOwJ,GACtBuB,EAAK5D,KACLqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAM0E,EAAK5D,IAAKnH,MAAOA,GAASwJ,IAI7DuC,YAAa,SAAUhB,EAAMvB,GACzBA,EAAEQ,QAAQ8B,MAAMf,EAAMA,EAAK/K,MAAOwJ,IAGtCtB,SAAU,SAAU7B,EAAMmD,GACtB,OAAIA,EAAEwC,OAAenL,KAAKoL,eAAgB5F,EAAMmD,GAC5CA,EAAEzH,OAAelB,KAAKqL,mBAAmB7F,EAAMmD,GAC5C1J,IAAEmB,IAAIuI,EAAE/D,KAAMY,IAGzB4F,eAAiB,SAAW5F,EAAMmD,GAC9B,IAAIxJ,EAAQF,IAAEmB,IAAKuI,EAAEwC,OAAQ3F,GAC7B,YAAc8E,GAATnL,EAA4BA,EAE7BwJ,EAAEzH,OAAelB,KAAKqL,mBAAmB7F,EAAMmD,GAE5C1J,IAAEmB,IAAIuI,EAAE/D,KAAMY,IAGzB6F,mBAAoB,SAAU7F,EAAMmD,GAChC,IAAIxJ,EAAQF,IAAEmB,IAAIuI,EAAE/D,KAAM+D,EAAEzH,OAAS,IAAMsE,GAE3C,YADc8E,IAAVnL,IAAqBA,EAAQF,IAAEmB,IAAIuI,EAAE/D,KAAMY,IACxCrG,GAIX4L,YAAa,SAAUlB,EAAKlB,GAExB,IAiBQ2C,IAjBJA,EAAW3C,EAAE2C,SAASzB,EAAIrE,SAIrBvG,IAAE4J,QAAQyC,KAAWA,EAAW,CAACA,IAEtCA,EAAS3I,QAAQ,SAAAlD,GACTR,IAAEG,WAAWK,GACbA,EAAKoK,EAAIrE,KAAMqE,EAAI1K,MAAO0K,EAAI0B,UAAW5C,GACpClJ,EAAK8E,KACV9E,EAAK8E,IAAIsF,EAAIrE,KAAMqE,EAAI1K,MAAO0K,EAAI0B,UAAW5C,MAMrDA,EAAE6C,WACEF,EAAW3C,EAAE6C,OAAO3B,EAAIrE,SAInBvG,IAAE4J,QAAQyC,KAAWA,EAAW,CAACA,IAEtCA,EAAS3I,QAAQ,SAAAlD,GACTR,IAAEG,WAAWK,GACbA,EAAKoK,EAAIrE,KAAMqE,EAAI1K,MAAO0K,EAAI0B,UAAW5C,GACpClJ,EAAK8E,KACV9E,EAAK8E,IAAIsF,EAAIrE,KAAMqE,EAAI1K,MAAO0K,EAAI0B,UAAW5C,QASjEU,SAAU,SAAUQ,EAAKlB,GACrB,IAAInD,EAAOqE,EAAIrE,KAEXmD,EAAEwC,OACFlM,IAAE8E,IAAK4E,EAAEwC,OAAQ3F,EAAMqE,EAAI1K,QAIvBwJ,EAAEzH,SAAQsE,EAAOmD,EAAEzH,OAAS,IAAM2I,EAAIrE,MAE1CvG,IAAE8E,IAAI4E,EAAE/D,KAAMY,EAAMqE,EAAI1K,QAG5Ba,KAAK+K,YAAYlB,EAAKlB,GAElBkB,EAAI0B,WAER5C,EAAEQ,QAAQS,aAAa,GAAIjB,IAM/BS,WAAY,SAAUS,EAAKlB,GACvB,IAAI8C,EAASxM,IAAEmB,IAAIuI,EAAE/D,KAAMiF,EAAIrE,MAC1BiG,IACDA,EAAS,GACTxM,IAAE8E,IAAI4E,EAAE/D,KAAMiF,EAAIrE,KAAMiG,IAG5B,IAAItM,EAAQ0K,EAAI1K,MAChB,IAAK,IAAIuB,KAAKvB,EACV,GAAMA,EAAMuB,GAAZ,CAGA,IAAIgL,EAAOvM,EAAMuB,GAAGZ,GACd2L,EAAOC,KACbD,EAAOC,GAAQvM,EAAMuB,IAIrBmJ,EAAI0B,WAER5C,EAAEQ,QAAQS,aAAa,GAAIjB,KAInCF,EAAckD,QAAU,CACpBjC,IAAK,SAAUG,EAAKlB,GAChB,IAAI3J,EAAM,GACV,IAAK,IAAI0B,KAAKmJ,EAAIY,GAAGL,MACjBpL,EAAI0B,GAAKmJ,EAAInJ,GAEjBmF,QAAQ6D,IAAI,MAAO1K,EAAK2J,IAG5BjJ,GAAI,SAAU4F,EAAIqD,GACd,GAAKrD,EAAG5F,GAAR,CACA,IAAIwE,EAOJ,GAAe,iBAJXA,EADAoB,EAAG5F,GAAG6E,IACGe,EAAG5F,GAAG6E,IAAIe,EAAIqD,GAEdrD,EAAG5F,GAAG4F,EAAIqD,IAEO,OAAOzE,EAEjCoB,EAAGgB,KACHqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAMF,EAAGgB,IAAKnH,MAAO+E,GAAUyE,KAI5DiD,YAAa,SAAU1B,EAAMvB,GACzB,IAAI3J,EAAM,GAEV,IAAK,IAAI0B,KAAKwJ,EAAKO,GAAGL,MAClBpL,EAAI0B,GAAKwJ,EAAKxJ,GAGlB,GAAIwJ,EAAKK,SAAWL,EAAK5D,KAAO4D,EAAKM,QAAS,CAO1C,GALK7B,EAAEkD,QAAQ3B,EAAKjK,OAAM0I,EAAEkD,QAAQ3B,EAAKjK,KAAO,CAAEuK,QAAS,KAG3DxL,EAAIuL,SAAU,EAEVtL,IAAE6M,QAAQ5B,EAAKM,QAAS7B,EAAEkD,QAAQ3B,EAAKjK,KAAKuK,SAC5C,MAAO,cAGP7B,EAAEkD,QAAQ3B,EAAKjK,KAAKuK,QAAUN,EAAKM,QAEvC7B,EAAEQ,QAAQE,SAAS,CAAE7D,KAAM0E,EAAK5D,IAAKnH,MAAOH,EAAKuM,YAAWrB,EAAKM,SAAU,aAAuB7B,QAG7FuB,EAAK5D,MAAQ4D,EAAKM,SACvB7B,EAAEQ,QAAQE,SAAS,CAAE7D,KAAM0E,EAAK5D,IAAKnH,MAAOH,GAAO2J,GAEvD,GAAIuB,EAAKM,QAAS,MAAO,gBAMjC/B,EAAcsD,KAAO,CACjBC,aAAc,SAAU9B,EAAMvB,GAC1B,IAAIsD,EAAO,GAEX,IAAK,IAAIvL,KAAKwJ,EAAK+B,KAAM,CACrB,IAAIxM,EAAOd,EAAG6H,cAAcjC,IAAI2F,EAAKlF,IAAKkF,EAAK+B,KAAKvL,IACpDuL,EAAK1E,KAAK9H,GAQd,OAJIyK,EAAK5D,KACLqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAM0E,EAAK5D,IAAKnH,MAAO8M,GAAQtD,GAGjDsD,GAGXC,OAAQ,SAAUhC,EAAMvB,GACpB,IACI4C,GAAY,EAEZ9L,EAAOd,EAAG6H,cAAcjC,IAAI2F,EAAKlF,IAAKkF,EAAM,SAAUtF,EAAMY,GAC5D,IAAIrG,EAAQF,IAAEmB,IAAIwE,EAAMY,GAQxB,YAPc8E,IAAVnL,IAAqBA,EAAQF,IAAEmB,IAAIuI,EAAE/D,KAAMY,SAEjC8E,IAAVnL,IACAA,EAAQ,GACRoM,GAAY,GAGTpM,IAOX,OAJI+K,EAAK5D,KACLqC,EAAEQ,QAAQE,SAAS,CAAE7D,KAAM0E,EAAK5D,IAAKnH,MAAOM,EAAM8L,UAAWA,GAAa5C,GAGvElJ,IAIf,IAAI0M,EAAa,CAEbC,aAAc,SAAUZ,GAEpB,IAAIF,EAAW,GAEf,IAAK,IAAI5K,KAAK8K,EACVF,EAAS5K,GAAKV,KAAKqM,YAAY3L,EAAG8K,EAAO9K,IAC7C,OAAO4K,GAGXe,YAAa,SAAUpI,EAAOqI,GAC1B,IAAI5H,EAAK4H,EAAM5H,GACXtD,EAAOkL,EAAMlL,KAMjB,OALc,SAAUoE,EAAMtB,EAAQqG,EAAS5B,GAE3C9C,QAAQ6D,IAAI,iBAAkB,CAAEhF,KAAItD,OAAM8C,SAAQqG,YAClD5B,EAAEiC,OAAOlG,GAAGA,GAAI6H,QAAQnL,EAAM8C,EAAQqG,MAK9C1L,EAAK,CAELgI,MAAO,SAAU2F,GACb,IAAI/M,EAAOiC,OAAOC,OAAO3B,MAiCzB,OA/BAP,EAAKX,IAAM,CACPqK,QAAS,GACTsD,cAAeD,EAAIC,eAAiB,GACpC7H,KAAM4H,EAAI5H,MAAQ,GAClB0G,SAAU,GACVoB,YAAa,IAGjBjN,EAAKuB,MAAQ,CACTC,OAAQ,EACR0L,KAAM,IAGVlN,EAAKiF,GAAK8H,EAAI9H,IAAM,GAEpBjF,EAAKmN,YAAYJ,EAAIlB,UAErB7L,EAAKoN,qBAAqBpE,GAEtB+D,EAAIrD,SACJ1J,EAAKoN,qBAAqBL,EAAIrD,SAG9BqD,EAAItH,KACJzF,EAAKqN,WAAWN,EAAItH,KAEpBsH,EAAIhB,QACJ/L,EAAKmN,YAAYT,EAAWC,aAAaI,EAAIhB,SAE7CgB,EAAIE,aACJjN,EAAKsN,gBAAgBP,EAAIE,aACtBjN,GAGXsN,gBAAiB,SAAUC,GACvB,IAAK,IAAItM,KAAKsM,EAAQ,CAClB,IAAIC,EAAQD,EAAOtM,GACfzB,IAAEoL,SAAS4C,EAAMrH,SAAQqH,EAAMrH,MAAQqH,EAAMrH,MAAMpD,MAAM,MAE7DxC,KAAKlB,IAAI4N,YAAYhM,GAAKuM,IAGlCJ,qBAAsB,SAAUK,EAAYC,GAExC,IAAK,IAAIzM,KAAKwM,EACNjO,IAAEoL,SAAS6C,EAAWxM,KACtBV,KAAKoN,gBAAgBF,EAAYxM,EAAGwM,EAAWxM,IAGvD,IAAK,IAAIA,KAAKwM,EACVlN,KAAKqN,WAAWH,EAAWxM,GAAIgB,OAAO4L,OAAO,GAAIH,EAAM,CAAEzB,KAAMhL,MAGvE0M,gBAAiB,SAAU3B,EAAQrK,EAAMoE,GACrC,IAAIwF,EAAS/L,IAAE6F,UAAUnG,EAAGgI,YAAYU,SAAS7B,IAEjD,GAAIwF,EAAOuC,aAAc,CAIrB,IAAK,IAAI7M,KAHTzB,IAAE2G,MAAM6F,EAAQrK,UACT4J,EAAOuC,aAEAvC,EACN/L,IAAEoL,SAASW,EAAOtK,KAClBV,KAAKoN,gBAAgBpC,EAAQtK,EAAGsK,EAAOtK,IAE/CzB,IAAEuO,MAAM/B,EAAQT,QAGhBS,EAAO/K,GAAKsK,GAIpBqC,WAAY,SAAUlE,EAASgE,GAC3B,IAAMM,EAAY,SAAUlI,GACxB,OAAO,SAAU2E,EAAMvB,GACnB,OAAOpD,EAAOhB,IAAI2F,EAAMvB,KAGhC,IAAK,IAAIjI,KAAKyI,EAAS,CACnB,IAAI5D,EAAS4D,EAAQzI,GACjB6E,EAAOhB,MAAKgB,EAASkI,EAAUlI,IACnCvF,KAAKlB,IAAIqK,QAAQzI,GAAK6E,IAI9BmI,OAAQ,SAAUtM,EAAM8D,GACpBlF,KAAKlB,IAAI2N,cAAcrL,GAAQ8D,GAGnC4H,WAAY,SAAU5H,GAClBlF,KAAK0N,OAAO,OAAQxI,IAGxB0H,YAAa,SAAUe,GACnB,IAAK,IAAIjN,KAAKiN,EAAmB,CAC7B,IAAIrC,EAAWqC,EAAkBjN,GAC5BzB,IAAE4J,QAAQyC,KAAWA,EAAW,CAACA,IAElCtL,KAAKlB,IAAIwM,SAAS5K,KAAI4K,EAAWtL,KAAKlB,IAAIwM,SAAS5K,GAAGkN,OAAOtC,IAEjEtL,KAAKlB,IAAIwM,SAAS5K,GAAK4K,IAK/B/G,IAAK,SAAUsJ,EAAQ7C,EAAQQ,EAAQsC,GAEnCD,EAASA,GAAU,OAEf7C,GACAhL,KAAK+N,WAAW/C,GAEpB,IAAI9F,EAAMlF,KAAKlB,IAAI2N,cAAcoB,GAEjC,GAAK3I,EAAL,CAEA,IAAIyD,EAAI3I,KAAKgO,QAAQH,GACrBlF,EAAEzD,IAAMA,SAEDyD,EAAE6C,OACLA,IAAQ7C,EAAE6C,OAASA,GAGvBvM,IAAEuO,MAAO7E,EAAGmF,GAEPA,GAAUA,EAAM3C,OACjBxC,EAAEwC,OAAS2C,EAAM3C,cAEVxC,EAAEwC,OAEbnL,KAAKlB,IAAIqK,QAAQa,UAAU,GAAIrB,KAGnCqF,QAAS,SAAU5M,GACf,GAAIpB,KAAKgB,MAAM2L,KAAKvL,GAAO,OAAOpB,KAAKgB,MAAM2L,KAAKvL,GAElD,IAAIuH,EAAI,CACJiC,OAAQ5K,KACR4E,KAAM5E,KAAKlB,IAAI8F,KACfuE,QAASnJ,KAAKlB,IAAIqK,QAClBzE,GAAI1E,KAAK0E,GACT4G,SAAUtL,KAAKlB,IAAIwM,UAKvB,OAFAtL,KAAKgB,MAAM2L,KAAKvL,GAAQuH,EAEjBA,GAGXL,OAAQ,SAAUlH,GACHpB,KAAKgB,MAAM2L,KAAKvL,GAEtBkH,QAAS,SAEPtI,KAAKgB,MAAM2L,KAAKvL,IAG3B2M,WAAY,SAAUnJ,GAElB,IAAK,IAAIlE,KAAKkE,EACN5E,KAAKlB,IAAI4N,YAAYhM,IACrBV,KAAKiO,iBAAiBvN,EAAGkE,EAAKlE,GAAIV,KAAKlB,IAAI4N,YAAYhM,IAG/D,IAAK,IAAIA,KAAKkE,EAAM,CAChB,IAAIY,EAAO9E,EACPvB,EAAQyF,EAAKlE,GACH,OAAVvB,EACAF,IAAE2G,MAAM5F,KAAKlB,IAAI8F,KAAMY,GAEvBvG,IAAE8E,IAAI/D,KAAKlB,IAAI8F,KAAMY,EAAMrG,KAKvC8O,iBAAkB,SAAUzI,EAAMrG,EAAO8N,GAAO,IAAAnM,EAAAd,KACxC4F,EAAQqH,EAAMrH,MAIlB,GAHIA,GACAA,EAAMjD,QAAQ,SAAA+I,GAAI,OAAIzM,IAAE2G,MAAM9E,EAAKhC,IAAI8F,KAAM8G,KAE5CuB,EAAMiB,MACP,IAAM,IAAIxN,KAAKuM,EAAMiB,MACrBlO,KAAKlB,IAAI8F,KAAKlE,GAAKuM,EAAMiB,MAAOxN,GAAIvB,QAuChDR,EAAGwP,WAAa,CAGZtH,MAAO,SAAUuH,GACb,OAAOvP,EAAGgI,MAAMuH,IAGpBC,UAAW,SAAUC,GAAM,IAAAC,EAAAvO,KACvBf,IAAEuO,MAAMxN,KAAMsO,GAEdtO,KAAKwO,YAAc7P,EAAGwP,WAAWtH,MAAM7G,MAEvCA,KAAKuE,IAAM,SAACnD,EAAMjC,EAAOqM,EAAOiD,GAAkBF,EAAKC,YAAYjK,IAAInD,EAAMjC,EAAOqM,EAAOiD,IAE3FzO,KAAKwO,YAAYjK,IAAI,SACrBsB,QAAQ6D,IAAI,aAAc1J,OAE9BuE,IAAK,aAILC,IAAG,SAGHC,MAAO,CACH5F,GAAIA,0BC9rBRF,EAAKC,OAAOD,GAIZE,EAAK,CAEP6P,YAAa,SAAUC,GACrB,IAAIC,EAAO,EACX,IAAK,IAAIlO,KAAKiO,EACZC,GAAQD,EAAIE,WAAWnO,GAAKA,EAO9B,OALA,WACE,IAAI0D,EAAuB,IAAnB5C,KAAKsN,IAAIF,KACjB,OAAOxK,EAAI5C,KAAKuN,MAAM3K,KAO1B4K,SAAU,SAAU/O,GAClB,IAAIgP,EAAWjP,KAAK0O,YAAYzO,GAE5BiP,EACS,UAITC,EAAQ,CACVC,cAAepP,KAAKqP,SAASJ,IAAYC,GACzCI,oBAAqBtP,KAAKqP,SAASJ,IAAYC,IAQjD,OALAC,EAAMI,UAAY,QAAUJ,EAAMC,cAAc,GAAK,IAAMD,EAAMC,cAAc,GAAK,MAASD,EAAMC,cAAc,GAAM,OACvHD,EAAMK,gBAAkB,QAAUL,EAAMG,oBAAoB,GAAK,IAAMH,EAAMG,oBAAoB,GAAK,MAASH,EAAMG,oBAAoB,GAAM,OAE/IH,EAAMM,WAAa,SAAWN,EAAMC,cAAc,GAAK,SAAoBD,EAAMC,cAAc,GAAM,SAE9FD,GAGTE,SAAU,SAAUT,EAAMc,GAExBA,EAAYA,GAAa,UACzB,IAAIC,EAAa,IAAPf,EACNgB,EAAQC,IAAO,WAAW9L,IAAI,QAAS4L,GAAKG,MAKhD,OAHAF,EAAM,GAAgB,IAAXA,EAAM,GACjBA,EAAM,GAAgB,IAAXA,EAAM,GAEVA,GAETxP,IAAK,SAAUwO,EAAM5M,GAEnB,IAAI2M,EAAMC,EACNA,EAAO,EACX,IAAK,IAAIlO,KAAKiO,EACZC,GAAQD,EAAIE,WAAWnO,GAAKA,EAE9B,SAASqP,IACP,IAAI3L,EAAuB,IAAnB5C,KAAKsN,IAAIF,KACjB,OAAOxK,EAAI5C,KAAKuN,MAAM3K,GAOxB,IAAI4L,EAAQ,IAJZhO,EAAQR,KAAKyO,IAAI,EAAGzO,KAAKuN,MAAqB,EAAdgB,OAM5BH,EAAQ5P,KAAKqP,SAASU,KAEtBG,EAAa,CACf,CAAC,EAAG,EAAG,GAAK,GAAK,EAAG,GACpB,CAAC,EAAG,EAAG,GAAK,GAAK,EAAG,GACpB,CAAC,EAAG,EAAG,GAAK,GAAK,EAAG,GACpB,CAAC,EAAG,EAAG,GAAK,GAAK,EAAG,IAKlBC,EAAS,GACb,IAASzP,EAAI,EAAGA,EAAIsB,EAAOtB,IACzB,IAD8B,IAAA0P,EAAA,WAE5B,IACIhM,EAAI1D,EAAIsP,EACR3L,EAAIgM,EAAIL,EACDE,EAAWpN,IAAI,SAACwN,GACzB,IAAIC,EAAM,QAAUX,EAAM,GAAK,IAAMA,EAAM,GAAK,MAASA,EAAM,GAAM,OACjEY,EAAYhP,KAAKiP,MAAoB,EAAdV,KACvBW,EAASJ,EAAcxN,IAAI,SAAC3D,EAAOuB,GACrC,OAAOvB,EAAQ6Q,GAAStP,EAAI,EAAI0D,EAAIC,KAEtC8L,EAAO5I,KAAK,sDAAAqG,OACqB4C,EADrB,kCAEQE,EAAOjL,KAAK,KAFpB,sFAGsB,EAAIuK,EAH1B,8BAIKO,EAJL,kCAKSR,IALT,iCAVPM,EAAI,EAAGA,EAAIrO,EAAOqO,IAAKD,IAsBlC,MAAO,qEAAuED,EAAO1K,KAAK,IAAM,WAUpG9G,EAAGwQ,MAAQ,CAGTwB,QAAS,SAAU/B,EAAMoB,EAAOhO,GAE9B,OADWnD,EAAGuB,IAAIwO,EAAM5M,IAI1BgN,SAAU,SAAU/O,GAClB,OAAOpB,EAAGmQ,SAAS/O,IAGrBuE,IAAG,SAGHC,MAAO,CACL5F,GAAIA,UCnICD,OAAOD,GAUbiS,YAAc,CAGbzP,KAAM,aAENqD,IAAG,SAGHC,MAAO,CACH5F,GAjBC,KCHT,IAAIF,EAAKC,OAAOD,GAIZE,EAAK,CAELC,IAAK,GAIL+R,QAAU,SAAW7R,GACjB,IAAIc,EAAKE,KAAK8Q,QAGd,OAFA9R,EAAIc,GAAKA,EACTE,KAAK+Q,UAAWjR,EAAId,GACbc,GAGXgR,MAAQ,WAKJ,OAJA9Q,KAAKlB,IAAI8F,KAAK5D,MAAMC,SAEX,UAAYjB,KAAKlB,IAAI8F,KAAK5D,MAAMC,QAI7C8P,UAAW,SAAUjR,EAAIX,GACrB,IAQI6R,EARAlS,EAAMkB,KAAKlB,IACFA,EAAI8F,KAAKV,OAAOpE,GAG7BhB,EAAImS,QAAU,GAEdjR,KAAKkR,SAASpR,EAAIX,GAGlB,IAAIgS,EAAUrS,EAAI8F,KAAKV,OACnB+M,EAAUnS,EAAImS,QAElBpL,QAAQ6D,IAAK5K,EAAI8F,MACjB,IAAIwM,EAAWtS,EAAI8F,KAAKwM,SAExB,IAAM,IAAI1Q,KAAKuQ,EAAU,CACfG,EAAS1Q,KAAK0Q,EAAS1Q,GAAK,GAClC0Q,EAAS1Q,KACT,IAAIwD,EAASiN,EAASzQ,GAChBwD,IACAA,EAAOmN,eACG/G,GAAX0G,IAAuBA,EAAU9M,EAAOoN,aACxCN,EAAU9M,EAAOoN,cAAcN,EAAU9M,EAAOoN,eAWzD,YARgBhH,IAAZ0G,GACAhR,KAAKuR,SAASP,GAIbhR,KAAKlB,IAAI4F,GAAG8M,WACbxR,KAAKlB,IAAI4F,GAAG8M,UAAWP,GAEpBD,GAGXO,SAAU,SAAUE,GAChB,IAAI3S,EAAMkB,KAAKlB,IACf,IAAK,IAAIgB,KAAMhB,EAAI8F,KAAKV,OAAQ,CAC5B,IAAIA,EAASpF,EAAI8F,KAAKV,OAAOpE,GACzBoE,EAAOmN,UAAYnN,EAAOoN,aAAeG,GAAQvN,EAAOwN,UAAYD,KACpEvN,EAAOmN,SAAU,EACjBnN,EAAOoN,YAAc,GAI7BxS,EAAI8F,KAAK6M,KAAOA,GAGpBP,SAAU,SAAUpR,EAAIkL,GACpB,IAAIlM,EAAMkB,KAAKlB,IACXW,EAAOX,EAAI8F,KAAKgE,MAAM9I,GACtB6R,GAAa,EASjB,IAAK,IAAIjG,KAPJjM,IACDX,EAAI8F,KAAK6M,OACT3S,EAAI8F,KAAKgE,MAAM9I,GAAML,EAAO,GAC5BX,EAAI8F,KAAKV,OAAOpE,GAAM,CAAE4R,UAAW5S,EAAI8F,KAAK6M,MAC5CE,GAAa,GAGA3G,EAAQ,CACrB,IAAI7L,EAAQ6L,EAAOU,GACnB,GAAc,UAATvM,QAAoCmL,IAAf7K,EAAKiM,GAK/B,GAAe,OAAVvM,QAAiCmL,IAAf7K,EAAKiM,IAO5B,GAAMvM,EAAN,CAEA,IAAIyS,EAAWnS,EAAKiM,GAAQjM,EAAKiM,GAAM5L,GAAK,KACxCb,IAAEoL,SAASlL,IAA6B,KAAnBA,EAAM0S,OAAO,KAClC1S,EAAQ,CAACW,GAAKX,EAAM2S,UAAU,UAGhBxH,IAAbnL,EAAMW,KACU,KAAZX,EAAMW,IAAwB,IAAVX,EAAMW,KAASX,EAAMW,GAAK,MACnDX,EAAMW,GAAKX,EAAMW,IAAM8R,GAAY5R,KAAK8Q,QACxCrR,EAAKiM,GAAQ,CAAE5L,GAAIX,EAAMW,KAIzBX,EAAMW,IAAMb,IAAE8S,SAAS5S,IAClBA,EAAMW,IAAM8R,IAAWD,GAAa,GACzC3R,KAAKkR,SAAS/R,EAAMW,GAAIX,IAGlBF,IAAE8S,SAAU5S,KAAYF,IAAE+S,QAAQvS,EAAKiM,GAAOvM,IACpDwS,GAAa,EACblS,EAAKiM,GAAQvM,GAEPM,EAAKiM,IAAOvM,IAClBwS,GAAa,EACblS,EAAKiM,GAAQvM,gBA/BNM,EAAKiM,GACZiG,GAAa,cANNlS,EAAKiM,GACZiG,GAAa,EAwCjBA,IACKlS,EAAKwS,UACNxS,EAAKwS,QAAUxS,EAAKwS,QAAUxS,EAAKwS,QAAQ,EAAI,GAEnDjS,KAAKlB,IAAImS,QAASnR,IAAM,IAIhCoS,UAAW,SAAUlQ,GACjBhC,KAAKlB,IAAIqT,SAAW,GACpBnS,KAAKoS,WAAYpQ,GAEZhC,KAAKlB,IAAI4F,GAAG8M,WACbxR,KAAKlB,IAAI4F,GAAG8M,UAAWxR,KAAKlB,IAAIqT,WAIxCC,WAAa,SAAWpQ,GAEpB,KAAIA,GAAO,GAAX,CAEA,IAAIlD,EAAMkB,KAAKlB,IAEX6S,GAAa,EAEjB,IAAK,IAAI7R,KAAMhB,EAAI8F,KAAKgE,MAAO,CAC3B,IAAInJ,EAAOX,EAAI8F,KAAKgE,MAAM9I,GACtBoE,EAASpF,EAAI8F,KAAKV,OAAOpE,GAE7B,IAAIoE,IAAUA,EAAOmN,QAArB,CACA,IAAIrG,EAAShL,KAAKqS,iBAAiB5S,EAAMK,GACrCkL,IACKlM,EAAI8F,KAAKV,OAAOpE,KAAKhB,EAAI8F,KAAKV,OAAOpE,GAAM,IAEhDE,KAAKsS,SAAS7S,EAAMK,EAAIkL,EAAQlM,EAAI8F,KAAKV,OAAOpE,IAC3ChB,EAAI8F,KAAKV,OAAOpE,GAAIuR,UACrBM,GAAa,KAKrBA,GAAY3R,KAAKoS,WAAWpQ,EAAQ,KAG5CsQ,SAAU,SAAU7S,EAAMK,EAAIkL,EAAQ9G,GAClC,IAAIpF,EAAMkB,KAAKlB,IAEfoF,EAAOmN,SAAU,EACjBnN,EAAO8G,OAASA,EAEhB,IAAIuH,EAAOvS,KAAKlB,IAAI4F,GAAG8N,QAAQ/S,EAAMuL,EAAQ9G,EAAQpF,GAChDyT,IACDrO,EAAOqO,KAAOA,GAEbrO,EAAOmN,UACRvS,EAAI8F,KAAK6M,OACTvN,EAAOoN,YAAcxS,EAAI8F,KAAK6M,KAC9BzR,KAAKlB,IAAIqT,SAAUrS,IAAO,IAKlCuS,iBA5LK,SA4LY5S,GAGb,IAAIX,EAAMkB,KAAKlB,IAEXkM,EAAS,GAIb,IAAK,IAAIU,KAAQjM,EAAM,CACnB,IAAIN,EAAQM,EAAKiM,GACjB,GAAIvM,EAAMW,GAAI,CACV,IAAI2S,EAAS3T,EAAI8F,KAAKV,OAAO/E,EAAMW,IAEnC,IAAK2S,IAAWA,EAAOpB,QAAS,OAAO,EAEvC,IAAIkB,EAAOE,EAAOF,KAEb9S,EAAKiM,EAAK,WACX6G,EAAOtT,IAAEmB,IAAKmS,EAAM9S,EAAKiM,EAAK,WAGlCV,EAAOU,GAAQ6G,OAEdvH,EAAOU,GAAQvM,EAGxB,OAAO6L,GAGX7J,KAAM,SAAUrC,GACZ,IAAIW,EAAOiC,OAAOC,OAAO3B,MA2BzB,OA1BAP,EAAKX,IAAMA,EAEXG,IAAEyT,aAAa5T,EAAK,CAChB8F,KAAO,CACHgE,MAAQ,GACR1E,OAAS,GACTuN,KAAO,EACPL,SAAW,GACXuB,OAAS,GACTC,KAAO,CACHC,OAAS,GACTC,MAAS,GACTC,KAAS,IAGb/R,MAAQ,CACJC,OAAS,IAGjByD,GAAI,CACAsO,gBAAiB,SAACvT,GAAD,OAAUA,EAAKoD,MAAQpD,EAAKuF,KAAOvF,EAAK8S,MACzDC,QAAS,SAAC/S,EAAMuL,EAAQ9G,GAAa,MAAO,CAAE2F,IAAKmB,EAAQ5G,EAAG3E,EAAKuF,SAI3ElG,EAAI8L,OAASnL,EACNA,GAGXwT,aAAe,WACXjT,KAAKkS,UAAU,IAGnBgB,WAAa,SAAWpT,GACpB,IAAIL,EAAOO,KAAKlB,IAAI8F,KAAKgE,MAAO9I,GAEhC,OAAML,EACCA,EAAKwS,QADQ,OA6C5BtT,EAAGwU,WAAa,CAIZ5O,IAAK,SAAUzF,GACX,OAAOD,EAAGsC,KAAMrC,IAEpBqC,KAAM,aAINqD,IAAG,SAGHC,MAAO,CACH5F,GAAIA,IChUZ,IAAIF,EAAKC,OAAOD,GAEZyU,EAAM,GAENvU,EAAK,CAELC,IAAK,GAGLuU,YAAa,SAAUvT,GACnB,IAAI4E,EAAK0O,EAAIE,SAASzM,MAAM,CAAEjC,KAAM5E,KAAKlB,IAAI8F,KAAM5D,MAAOhB,KAAKlB,IAAIkC,QAASyK,OAAO3L,GAEnF,IAAK,IAAIY,KAAK6S,EACV7O,EAAGH,IAAIgP,EAAO7S,KAGtB8S,MAAO,SAAU1T,GACb,IAAIL,EAAOO,KAAKlB,IAAI8F,KAAKgE,MAAM9I,GAC3BoE,EAASlE,KAAKlB,IAAI8F,KAAKV,OAAOpE,GAC9B2T,EAAUzT,KAAKlB,IAAI8F,KAAK6O,QAAQ3T,GAE/B2T,IACDA,EAAUzT,KAAKlB,IAAI8F,KAAK6O,QAAQ3T,GAAM,IAE1C,IAAIqR,EAAUnR,KAAKlB,IAAI8F,KAAKV,OAExBwP,EAAQD,EAAQC,MAAQ,CACxBC,KAAM,CACFC,MAAO,EACPC,SAAU,GACVC,WAAY,KAIpB,IAAK,IAAIpI,KAAQjM,EACTA,EAAKiM,GAAM5L,KACX4T,EAAMC,KAAKC,QAEPzC,EAAQ1R,EAAKiM,GAAM5L,KAAOqR,EAAQ1R,EAAKiM,GAAM5L,IAAIuR,QACjDqC,EAAMC,KAAKE,SAAStM,KAAK,CAAEmE,KAAMA,EAAM5L,GAAIL,EAAKiM,GAAM5L,KAEtD4T,EAAMC,KAAKG,WAAWvM,KAAK,CAAEmE,KAAMA,EAAM5L,GAAIL,EAAKiM,GAAM5L,MAKpE,GAAIoE,GAAUA,EAAO8G,QAAU9G,EAAO8G,OAAOhG,IAAK,CAC9C,IAAIA,EAAMd,EAAO8G,OAAOhG,IACxB0O,EAAMK,UAAY,CAAEH,MAAO,EAAGI,QAAS,EAAGH,SAAU,EAAGC,WAAY,IACnE,IAAIG,EAAajP,EAAID,KAAKkP,WAE1B,IAAK,IAAIC,KAASD,EACdP,EAAMK,UAAUH,QACZ1P,EAAO8G,OAAOkJ,IAAUzU,EAAKyU,GAC7BR,EAAMK,UAAUC,UAGhBN,EAAMK,UAAUD,WAAWvM,KAAK2M,KAOhDrN,MAAO,SAAU/H,GACb,IAAIW,EAAOiC,OAAOC,OAAO3B,MAazB,OAXAP,EAAKX,IAAMA,EAEXG,IAAEyT,aAAa5T,EAAK,CAChB8F,KAAM,CACFgE,MAAO,GACP1E,OAAQ,GACRuP,QAAS,GACTd,OAAQ,MAITlT,IAMf2T,EAAIE,SAAW,CACX7H,OAAQ,SAAU3L,GAEd,IAAI6E,EAAQ3E,KAAK2E,OAAS3E,KAEtBP,EAAOiC,OAAOC,OAAOgD,GAQzB,OANAlF,EAAKkF,MAAQA,EAEblF,EAAKoH,QAELpH,EAAKkJ,EAAEwL,SAAWrU,EAEXL,GAEXoH,MAAO,SAAU2F,GAEb,OADAxM,KAAKoU,OAAO5H,GACLxM,MAEXoU,OAAQ,SAAU5H,GACVA,GAAK9K,OAAO4L,OAAOtN,KAAMwM,GAEzBxM,KAAK2E,OAAS3E,KAAK2E,MAAM0P,QACzBrU,KAAKqU,MAAQ,IAGjBrU,KAAK2I,EAAI,CAAEzE,OAAQ,KAEvB9D,IAAK,SAAUuH,GACX,IAAK1I,IAAEoL,SAAS1C,GAAM,OAAOA,EAC7B,IAEI2M,EAFKtU,KAAK2I,EAAEwL,SAShB,MANW,UAAPxM,IACA2M,EAAW,CAAC,SAAUtU,KAAK2I,EAAEwL,SAAU,WAEvCG,EADO,QAAP3M,EACW,CAAC,QAAS3H,KAAK2I,EAAEwL,UAEjB,CAACxM,EAAK,MACd1I,IAAEmB,IAAIJ,KAAK4E,KAAM0P,IAG5BC,QAAS,SAAUC,GACf,IAAIC,EAAOD,EAAM,GACb1U,EAAK0U,EAAM,GACXE,EAAUF,EAAM,GAEfC,IAAMA,EAAO,SACN,QAARA,IAAgBA,EAAO,SAEtB3U,IAAIA,EAAKE,KAAK2I,EAAEwL,UAErB,IAAIG,EAAW,CAACG,EAAM3U,GAGtB,OAFI4U,GAASJ,EAAS/M,KAAKmN,GAEpBzV,IAAEmB,IAAIJ,KAAK4E,KAAM0P,EAAS7O,KAAK,OAE1CkP,MAAO,SAAU7R,GACb,IAAK,IAAIpC,KAAKoC,EACV9C,KAAK2I,EAAEjI,GAAKV,KAAKuU,QAAQzR,EAAIpC,IAEjC,OAAOV,MAGX4U,GAAI,SAAU1H,EAAY2H,GACtB3H,EAAalN,KAAKI,IAAI8M,GAMtB,IACI4H,EAAY,CACZpJ,KAFQ1L,KAEI2I,EAAE+C,KACdvM,MAHQa,KAGK2I,EAAExJ,MACfgO,KAJQnN,KAII2I,EAAEwE,KACd4H,IALQ/U,KAKG2I,EAAEoM,KAMjB,IAAK,IAAIrU,KAXGV,KAON2I,EAAE+C,KAAO,KAPH1L,KAQN2I,EAAExJ,MAAQ,KARJa,KASN2I,EAAEwE,KAAO,KATHnN,KAUN2I,EAAEoM,IAAM,KACA7H,EAXFlN,KAYF2I,EAAE+C,KAAOhL,EAZPV,KAaF2I,EAAExJ,MAAQ+N,EAAWxM,GAbnBV,KAcF2I,EAAEwE,KAAOzM,EAdPV,KAeF2I,EAAEoM,IAAM,GACdF,EAhBQ7U,UAgBQ2I,GAIpB,IAAK,IAAIjI,KAAKoU,EApBF9U,KAqBFU,GAAKoU,EAAUpU,IAI7B6D,IAAK,SAAUsQ,GACX,IACiBA,EAAG7U,KAAMA,KAAK2I,GAC7B,MAAO/I,GACL,GAAIA,GAAe,iBAAVA,EAAEiD,KACP,OAEJgD,QAAQ6D,IAAI9J,GAGZI,KAAK2I,EAAEzE,SAEFlE,KAAK4E,KAAK+N,OAAO3S,KAAK2I,EAAEwL,YACzBnU,KAAK4E,KAAK+N,OAAO3S,KAAK2I,EAAEwL,UAAY,IAExCzS,OAAO4L,OAAOtN,KAAK4E,KAAK+N,OAAO3S,KAAK2I,EAAEwL,UAAWnU,KAAK2I,EAAEzE,UAIhEA,OAAQ,SAAU9C,EAAMjC,GACpBa,KAAK2I,EAAEzE,OAAO9C,GAAQjC,GAG1BqU,MAAO,SAAUwB,GACb,IAAK,IAAItU,KAAKsU,EAAO,CAGjB,GAAY,iBAFDA,EAAMtU,GAEY,CACzB,IAAIuU,EAAiBjV,KAAKgB,MAAMkU,YAAYC,SAC5C,IAAKF,GAAkBjV,KAAK2I,EAAEwL,UAAYc,EACtC,KAAM,CAAEpS,KAAM,gBAAiB2C,KAAMwP,EAAMtU,QAE9C,CAED,QAAc4J,IADFrL,IAAEmB,IAAIJ,KAAK2I,EAAGqM,EAAMtU,IACP,KAAM,CAAEmC,KAAM,gBAAiB2C,KAAMwP,EAAMtU,QAMpF0S,EAAIgC,QAAU1T,OAAO4L,OAAO,GAAI8F,EAAIE,SAAU,CAC1CzM,MAAO,SAAU2F,GASb,OARAxM,KAAKoU,OAAO5H,GAEZxM,KAAKqV,MAAQ,CACTC,OAAQ,GACRC,SAAU,GACVC,YAAa,IAGVxV,MAEX2U,MAAO,SAAU7R,GACb,IAAK,IAAIpC,KAAKoC,EACV9C,KAAKqV,MAAMC,OAAO5U,GAAK,CAAEiH,IAAK7E,EAAIpC,IAClCV,KAAK2I,EAAEjI,GAAK,CAAEwC,KAAM,QAExB,OAAOlD,MAIXwT,MAAO,SAAUA,KAIjBtP,OAAQ,SAAU9C,EAAMjC,GACpBa,KAAKqV,MAAME,SAASnU,GAAQjC,GAGhCyV,GAAI,SAAU1H,EAAY2H,GACtB7U,KAAKqV,MAAMG,YAAYjO,KAAK2F,IAGhC3I,IAAK,SAAUsQ,GACEA,EAAG7U,KAAMA,KAAK2I,MAKnC,IAAI4K,EAAS,CAET,SAAC7O,EAAIiE,GAyBD,OAvBAjE,EAAGiQ,MAAM,CACLlV,KAAM,CAAC,UAGXkJ,EAAE+K,MAAQ,CACNE,MAAO,EACPC,SAAU,GACVC,WAAY,IAGhBpP,EAAGkQ,GAAGjM,EAAElJ,KAAM,SAACiF,EAAIiE,GACf,IAAIoM,EAAMpM,EAAExJ,MACZ,GAAK4V,EAAIjV,GAAT,CAEA6I,EAAE+K,MAAME,QAER,IAAI1P,EAASQ,EAAG6P,QAAQ,CAAC,SAAUQ,EAAIjV,KAElCoE,GAAWA,EAAOmN,QAClB1I,EAAE+K,MAAMG,SAAStM,KAAKwN,EAAIjV,IADC6I,EAAE+K,MAAMI,WAAWvM,KAAKwN,EAAIjV,OAIhE4E,EAAGR,OAAO,WAAYyE,EAAE+K,OACjB,CAAE+B,SAAU9M,EAAE+K,QAKzB,SAAChP,EAAIiE,GAEDjE,EAAGiQ,MAAM,CACL3J,OAAQ,CAAC,SAAU,GAAI,UACvBvL,KAAM,CAAC,QACPwU,WAAY,CAAC,SAAU,GAAI,gCAG/BvP,EAAG8O,MAAM,CACL,eAGJ7K,EAAE+K,MAAQ,CAAEE,MAAO,EAAGI,QAAS,EAAG1J,UAAW,IAC7C3B,EAAE+M,OAAS,GACXhR,EAAGkQ,GAAGjM,EAAEsL,WAAY,SAACvP,EAAIiE,GACrB,IAAIuL,EAAQvL,EAAE+C,KACd/C,EAAE+M,OAAOxB,IAAS,EAClBvL,EAAE+K,MAAME,QACHjL,EAAElJ,KAAKyU,IAAWvL,EAAEqC,OAAOkJ,IAC5BvL,EAAE+K,MAAMpJ,UAAU/C,KAAK2M,KAG/BxP,EAAGkQ,GAAGjM,EAAEsL,WAAY,SAACvP,EAAIiE,GACrB,IAAIuL,EAAQvL,EAAE+C,KACd/C,EAAE+M,OAAOxB,IAAS,IAItBvL,EAAE+K,MAAMiC,eAAiBhN,EAAE+K,MAAMpJ,UAAU5H,OAC3CiG,EAAE+K,MAAMkC,aAAejN,EAAE+K,MAAME,MAAQjL,EAAE+K,MAAMiC,eAE/CjR,EAAGR,OAAO,iBAAkByE,EAAE+K,OAC9BhP,EAAGR,OAAO,YAAayE,EAAE+M,SAK7B,SAAChR,EAAIiE,GAEDjE,EAAGiQ,MAAQ,CACPhC,OAAS,CAAC,YAGdjO,EAAG8O,MAAM,CACL,kBAGJ3N,QAAQ6D,IAAI,wBAAyBf,EAAEgK,UA8B/ChU,EAAGkX,WAAa,CAGZhP,MAAO,SAAU/H,GACb,OAAOD,EAAGgI,MAAM/H,IAEpBqC,KAAM,aAGNqD,IAAG,SAGHC,MAAO,CACH5F,GAAIA,IC5XZ,IAAIF,EAAKC,OAAOD,GAEZE,EAAK,CACLC,IAAK,CACD4F,GAAI,CAEA8M,UAAW,SAAUP,KACrBuB,QAAS,SAAU/S,EAAMuL,EAAQ9G,EAAQpF,GACrC,OAAOH,EAAGmX,YAAYC,SAASvD,QAAQ/S,EAAMuL,EAAQ9G,EAAQpF,KAIrE8F,KAAM,CACF5D,MAAO,CACHC,OAAQ,MAyExBtC,EAAGqX,WAAa,CAGZ7U,KAAM,aAENqD,IAAG,SAGHC,MAAO,CACH5F,GAAIA,IChGZ,IAAIF,EAAKC,OAAOD,GAEZkE,EAAO,GAGXA,EAAKkT,SAAW,CACZvD,QAAS,SAAU/S,EAAMuL,EAAQ9G,EAAQpF,GACrC,IAAImX,EAAWjL,EAAOnI,KAOtB,GANKoT,IACGjL,EAAOhG,IAAKiR,EAAW,YAElBjL,EAAOuH,OAAM0D,EAAW,aAGjCA,GAAYpT,EAAKoT,GACjB,OAAOpT,EAAKoT,GAAUzD,QAAQ/S,EAAMuL,EAAQ9G,EAAQpF,GAEnDoF,EAAOmN,SAAU,IAI9BxO,EAAKmC,IAAM,CACPwN,QAAS,SAAU/S,EAAMuL,EAAQ9G,EAAQpF,UAC9BkM,EAAOnI,KACd,IAAImC,EAAMrG,EAAGuX,YAAY3R,IAAIyG,GAE7B,OADA9G,EAAOiS,OAAS,SACTnR,IAIfnC,EAAKuT,SAAW,CACZ5D,QAAS,SAAU/S,EAAMuL,EAAQ9G,EAAQpF,GACrC,OAAOW,EAAK8S,OAIpB1P,EAAKwT,UAAY,CACb7D,QAAS,SAAU/S,EAAMuL,EAAQ9G,EAAQpF,GAErC,IAAIkG,EAAMgG,EAAOhG,IACjB,GAAKA,GAAQA,EAAID,KAAjB,CAKA,IAAIuR,EAAe,GACf/D,EAAO5T,EAAG4H,eAAehC,IAAIS,EAAKgG,EAAQ,SAACpG,EAAMY,EAAMF,GACvD,IAAInG,EAAQF,IAAEmB,IAAIwE,EAAMY,GACxB,YAAc8E,IAAVnL,EAA4BA,GAChCmX,EAAa/O,KAAK/B,GACX,gBAUX,OAPI8Q,EAAa5T,SACb6P,EAAO,CAAC+D,EAAc/D,IAE1BrO,EAAOiS,OAAS,iBAEhBjS,EAAOqS,KAAO,CAAEC,KAAMxR,EAAID,KAAKyR,MAExBjE,EAnBHrO,EAAOmN,SAAU,IAyB7BxO,EAAK4T,OAAS,CAEVC,YAAa,GAGblE,QAAS,SAAU/S,EAAMuL,EAAQ9G,EAAQpF,GAGrC,IAAI6F,EAAQ7F,EAAI8F,KAAKgE,MAAMnJ,EAAKkF,OAC5BC,EAAOoG,EAAOpG,KAEd+R,EAAU1X,IAAE6F,UAAUH,GAK1B,GAHKT,EAAO0S,UAAS1S,EAAO0S,QAAU,IACjC1S,EAAO2S,QAAO3S,EAAO2S,MAAQ,CAAEjS,KAAM,MAErC3F,IAAE+S,QAAQ9N,EAAO2S,MAAMjS,KAAMA,GAG9B,IAAK,IAAIlE,KAFTwD,EAAO2S,MAAMjS,KAAOA,EAEN+R,EACD,OAALjW,GAAciW,EAAQjW,GAAGZ,IAAM8E,EAAKlE,IAChCwD,EAAO0S,QAAQlW,IACf5B,EAAI8L,OAAOmG,UAAU7M,EAAO0S,QAAQlW,GAAGZ,GAAI,CAAE8E,KAAMA,EAAKlE,KAMxE,IAAK,IAAIA,KAAKiW,EACV,GAAS,OAALjW,GAAciW,EAAQjW,GAAGZ,IAAM8E,EAAKlE,GAAI,CAExC,GAAIwD,EAAO0S,QAAQlW,GACfiW,EAAQjW,GAAK,CAAEZ,GAAIoE,EAAO0S,QAAQlW,GAAGZ,QAEpC,CACD,IAAIgX,EAAQhY,EAAI8L,OAAOiG,QAAQ,CAAEhO,KAAM,SAAU+B,KAAMA,EAAKlE,GAAIiE,MAAOgS,EAAQjW,GAAGZ,KAClFoE,EAAO0S,QAAQlW,GAAK,CAAEZ,GAAIgX,EAAOnS,MAAOgS,EAAQjW,GAAGZ,IAGvD6W,EAAQjW,GAAK,CAAEZ,GAAIoE,EAAO0S,QAAQlW,GAAGZ,SAEhC8E,EAAKlE,KACViW,EAAQjW,GAAKkE,EAAKlE,IAI1BiW,EAAQ7W,GAAKL,EAAKK,GAElB,IAAIiX,EAAYjY,EAAI8L,OAAOyH,iBAAiBsE,GAE5C,GAAKI,EAQL,OAHA7S,EAAOuS,OAAS,GAChB3X,EAAI8L,OAAO0H,SAAS7S,EAAMA,EAAKK,GAAIiX,EAAW7S,EAAOuS,QACjDvS,EAAOuS,OAAON,SAAQjS,EAAOiS,OAASjS,EAAOuS,OAAON,QACjDjS,EAAOuS,OAAOlE,KAPjBrO,EAAOmN,SAAU,IAmB7B1S,EAAGmX,YAAc,CAGbW,OAAQ5T,EAAKmU,aAEbC,MAAOpU,EACPkT,SAAUlT,EAAKkT,SACfvR,IAAG,SAGHC,MAAO,CACH5F,GAnBC,yBCjILF,EAAKC,OAAOD,GAGZE,EAAK,CAELC,IAAK,CACDoY,QAAS,GAGTxS,GAAI,IAIRH,IAAK,SAAUvF,GACX,IAAImY,EAAanX,KAAKlB,IAAIoY,QAEtBnS,EAAO,CACPG,IAAK,GACL+O,WAAY,GACZuC,KAAM,GACNxR,IAAK,GACLoS,SAAW,IAMf,OAHArS,EAAKC,IAAMhF,KAAKqX,OAAOrY,EAAK,GAAI+F,GAChC/E,KAAKlB,IAAIoY,QAAUC,EAEZpS,GAGXsS,OAAQ,SAAUrY,EAAKwG,EAAMT,GACzB,GAAI9F,IAAEG,WAAWJ,GAAM,CACnB,IAAI2P,EAAM3P,EAAIO,WACV2E,EAASlE,KAAKsX,SAAStY,EAAIO,WAAYiG,EAAMT,EAAM,gBACvD,OAAI4J,GAAOzK,EAAelF,EACnBkF,EAEN,GAAIjF,IAAE8S,SAAS/S,GAAM,CACtB,IAAIuY,EAAW,GACf,IAAK,IAAI7W,KAAK1B,EAAK,CACf,IAAI0M,EAAOhL,EACPvB,OAAK,EACT,IAA4B,GAAvBuM,EAAK8L,QAAS,OAAqC,GAAvB9L,EAAK8L,QAAS,KAAa,CACxD,IAAIpT,EAAI,CACJuB,MAAQ3G,EAAK0B,GACbgF,KAAQhF,GAGZgL,EAAOA,EAAK+L,QAAQ,UAAW,KAC/BtY,EAAQa,KAAKqX,OAAOjT,EAAGoB,EAAKoI,OAAOlC,GAAO3G,GAE1C/E,KAAK0X,MAAO3S,EAAMS,EAAKoI,OAAOlC,GAAO,CAAE7I,KAAO,UAAW8U,MAAQ,GAAInS,KAAOA,EAAKoI,OAAOlC,UAGxFvM,EAAQa,KAAKqX,OAAOrY,EAAI0B,GAAI8E,EAAKoI,OAAOlN,GAAIqE,GAEhDwS,EAAS7L,GAAQvM,EAErB,OAAOoY,EAEN,GAAItY,IAAE4J,QAAQ7J,GAAM,CACrB,IAAIuY,EAAW,GACf,IAAK,IAAI7W,KAAK1B,EACVuY,EAAShQ,KAAKvH,KAAKqX,OAAOrY,EAAI0B,GAAI8E,EAAKoI,OAAOlN,GAAIqE,IACtD,OAAOwS,EAEN,OAAItY,IAAEoL,SAASrL,GACTgB,KAAKsX,SAAStY,EAAKwG,EAAMT,EAAM,UAE9B/F,GAGhB0Y,MAAO,SAAUR,EAAS1R,EAAMF,GACvBA,EAAGqS,QAAOrS,EAAGqS,MAAQ,GACtBrS,EAAGC,SACH2R,EAAQjD,WAAW3O,EAAGC,QAAUD,EAAGE,MACvC0R,EAAQhS,IAAIqC,KAAKjC,IAErBsS,WAAY,SAAUV,EAAS1R,EAAMjD,GACjC,IAAIsV,EAAU,CAAEtV,KAAOA,EAAMiD,KAAOA,GACpC0R,EAAQE,SAAS7P,KAAKsQ,IAG1BP,SAAU,SAAUnY,EAAOqG,EAAMT,EAAM+S,GAAS,IAAAhX,EAAAd,KAC5C,IAAKf,IAAEoL,SAASlL,GAAQ,OAAOA,EAQ/B,IAA2B,GAAvBA,EAAMqY,QAAQ,KAAY,OAAOrY,EAG3B4F,EAAKG,IAAf,IACI8F,EAAS7L,EAAMqD,MAAM,gCAoBzB,OAAqB,IAnBrBwI,EAASA,EAAOlI,IAAI,SAACrD,EAAMiB,GACvB,IAAMjB,EAAO,OAAO,KAEpB,IAAIsY,EAAYtY,EAAKoS,OAAO,GAE5B,GAAkB,KAAbkG,EACDtY,EAAOA,EAAKqS,UAAU,OAErB,IAAkB,KAAbiG,EAGL,OAAOtY,EAFRA,EAAOA,EAAKqS,UAAW,GAK3B,MAAO,CAAEjP,KAAM,QAAS0C,OADX9F,EACoBsY,eAEhCtV,OAAO,SAAAhD,GAAI,OAAIA,KAGTiD,OAAoB,KACL,GAAjBsI,EAAOtI,SACZsI,EAASA,EAAO,IACLnI,OACPmI,EAAOxF,KAAOA,GAEdvG,IAAE8S,SAAS/G,IACXhL,KAAK0X,MAAM3S,EAAMiG,EAAOxF,KAAMwF,GAC3BA,GAED8M,GAeN9M,EAASA,EAAOlI,IAAI,SAACrD,EAAMiB,GACvB,OAAIjB,EAAKoD,MACLpD,EAAK+F,KAAOA,EAAKoI,OAAOlN,GACxBjB,EAAKwE,MAAQvD,EACbjB,EAAKuY,cAAe,EACpBvY,EAAKkY,MAAQ,EAEb7W,EAAK4W,MAAM3S,EAAMS,EAAM/F,GAChBA,GAECA,IAEhBO,KAAK0X,MAAM3S,EAAMS,EAAM,CAAEA,KAAMA,EAAM3C,KAAMiV,EAAS5S,IAAK8F,EAAQ2M,MAAO,IACjE3M,GA3BPA,EAASA,EAAOlI,IAAI,SAACrD,EAAMiB,GACvB,OAAIjB,EAAKoD,MACLpD,EAAK+F,KAAOA,EAAKoI,OAAOlN,GACxBjB,EAAKwE,MAAQvD,EACbjB,EAAKkY,MAAQ,EACb7W,EAAK4W,MAAM3S,EAAMS,EAAM/F,GAEhBA,GAECA,MA+C5Bd,EAAGsZ,iBAAmB,CAGlB1T,IAAK,SAAUvF,GACX,OAAOH,EAAG0F,IAAIvF,IAGlBmC,KAAM,aAGNqD,IAAG,gGAKHC,MAAO,CACH5F,GAAIA,ICxMZ,IAAIF,EAAKC,OAAOD,GAGZuZ,EAAS,CAET3T,IAAK,SAAU4T,GACXA,EAAOA,EAAKC,OAEZ,IAAIC,EAAOC,SAASC,cAAc,OAClCF,EAAKG,UAAYL,EAIjB,IAFA,IAAI/J,EAAQ,GAEH1N,EAAI,EAAGA,EAAI2X,EAAKI,WAAW/V,OAAQhC,IAAK,CAC7C,IAAIgY,EAAKL,EAAKI,WAAW/X,GAErBiY,EAAO3Y,KAAK4Y,MAAMF,GAEtBtK,EAAM7G,KAAKoR,GAGf,OAAuB,GAAhBvK,EAAM1L,OAAc0L,EAAM,GAAKA,GAI1CwK,MAAO,SAAUF,GAAI,IAAA5X,EAAAd,KAEjB,GAAmB,GAAf0Y,EAAGzC,SACH,OAAOyC,EAAGG,UAId,IADA,IAAI1T,EAAQ,GACHzE,EAAI,EAAGA,EAAIgY,EAAGI,WAAWpW,OAAQhC,IAAK,CAC3C,IAAIqY,EAAOL,EAAGI,WAAWpY,GACrBU,EAAO2X,EAAK3X,MACU,GAAtBA,EAAKoW,QAAQ,OACbpW,EAAOA,EAAKqW,QAAQ,SAAU,SAACuB,EAAKC,GAAW,OAAOA,EAAKC,iBAE/D/T,EAAM/D,GAAQ2X,EAAK5Z,MAGnBgG,EAAMgU,QACNhU,EAAMiU,UAAYjU,EAAMgU,aACjBhU,EAAMgU,OAGbhU,EAAMkU,QACNlU,EAAMkU,MAAQrZ,KAAKsZ,OAAOnU,EAAMkU,QAIpC,IAAIV,EAAO,CACT9V,KAAM,OACN0W,cAAeb,EAAGc,SAAS5R,cAC3BzC,MAAOA,EACPsU,SAAU,MAGZ,GAAKtU,EAAMuU,SAET,OADAvU,EAAOA,EAAMuU,UAAahB,EAAGF,UACtBG,EAGiB,GAAtBjX,OAAO6H,KAAKpE,KAAaA,EAAQ,MAErC,IAAIsU,EAAW,GAOf,OANAf,EAAGD,WAAW9V,QAAQ,SAAAgX,GAClBF,EAASlS,KAAKzG,EAAK8X,MAAMe,MAEN,GAAnBF,EAAS/W,SAAa+W,EAAW,MACrCd,EAAKc,SAAWA,EAETd,GAGXW,OAAQ,SAAU3K,GACdA,GAAY,IAIZ,IAHA,IAEIiL,EAFAC,EAAM,qCACNC,EAAM,GAEHF,EAAQC,EAAIE,KAAKpL,IACpBmL,EAAIF,EAAM,IAAMA,EAAM,GAG1B,OAAOE,IAKXE,EAAS,CACTzV,IAAK,SAAUvF,EAAMib,GAAQ,IAAA1L,EAAAvO,KACvBkX,EAAU,CACZhS,IAAK,GACLsR,KAAM,GACNvC,WAAa,GACbgG,MAAQ,GACRC,WAAaD,GAAS,IAUxB,OAPKhb,IAAE4J,QAAS7J,GACdkY,EAAQlS,IAAMhG,EAAI8D,IAAI,SAAE9D,EAAK0B,GAAP,OAAc6N,EAAK4L,QAAQnb,EAAK,CAAC0B,GAAIwW,KAE3DA,EAAQlS,IAAMhF,KAAKma,QAAQnb,EAAK,GAAIkY,GAEtCA,EAAQhS,IAAIjD,KAAO,SAACmY,EAAEC,GAAH,OAASD,EAAEzC,MAAQ0C,EAAE1C,QAEjC,CAAEzS,IAAKgS,EAAQhS,IAAKF,IAAKkS,EAAQlS,IAAKwR,KAAOU,EAAQV,KAAOvC,WAAaiD,EAAQjD,WAAYgG,MAAQ/C,EAAQ+C,QAEtHE,QAAS,SAAUnb,EAAKwG,EAAM0R,GAC5B,GAAKlY,EAAL,CAEA,GAAIC,IAAEoL,SAASrL,GACb,OAAOgB,KAAKsX,SAAStY,EAAKwG,EAAM0R,GAAS,GAG3ClY,EAAMgB,KAAKsa,UAAUtb,EAAKwG,EAAM0R,GAEhC,IAAIqD,EAAe/U,EAAKoI,OAAO,CAAC,aAChC,IAAK,IAAIlN,KAAK1B,EAAIya,SAChBza,EAAIya,SAAS/Y,GAAKV,KAAKma,QAAQnb,EAAIya,SAAS/Y,GAAI6Z,EAAa3M,OAAOlN,GAAIwW,GAG1E,IAAIsD,EAAUhV,EAAKoI,OAAO,CAAC,UAC3B,IAAK,IAAIlN,KAAK1B,EAAImG,MACP,SAALzE,IACJ1B,EAAImG,MAAMzE,GAAKV,KAAKya,WAAWzb,EAAImG,MAAMzE,GAAI8Z,EAAQ5M,OAAOlN,GAAI1B,EAAKkY,IAGvE,GAAIlY,EAAImG,OAASnG,EAAImG,MAAMkU,MAAO,CAChC,IAAImB,EAAUhV,EAAKoI,OAAO,CAAC,QAAS,UACpC,IAAK,IAAIlN,KAAK1B,EAAImG,MAAMkU,MACtBra,EAAImG,MAAMkU,MAAM3Y,GAAKV,KAAKya,WAAWzb,EAAImG,MAAMkU,MAAM3Y,GAAI8Z,EAAQ5M,OAAOlN,GAAI1B,EAAKkY,GAmBrF,OAfIlY,EAAImG,OAASnG,EAAImG,MAAMmB,MACzB4Q,EAAQV,KAAMxX,EAAImG,MAAMmB,KAAQd,GAG9BxG,EAAImG,OAASnG,EAAImG,MAAMrF,KACzBoX,EAAQV,KAAMxX,EAAImG,MAAMrF,IAAO0F,GAG5BxG,EAAImG,OACP+R,EAAQgD,WAAWvX,QAAS,SAAAoW,GAClB/Z,EAAImG,MAAM4T,KACV7B,EAAQ+C,MAAMlB,KAAQ7B,EAAQ+C,MAAOlB,GAAS,IACpD7B,EAAQ+C,MAAOlB,GAAOxR,KAAK,CAAG/B,OAAMrG,MAAQH,EAAImG,MAAM4T,QAGrD/Z,IAGTsb,UAAW,SAAUtb,EAAKwG,GACxB,OAAOxG,GAGTyb,WAAY,SAAUzb,EAAKwG,EAAMxC,EAAQkU,GACvC,OAAKjY,IAAEoL,SAASrL,GAETgB,KAAKsX,SAAStY,EAAKwG,EAAM0R,GAAS,GAFZlY,GAI/B0Y,MAAO,SAAUR,EAAS1R,EAAMF,GAEtBA,EAAGqS,QAAQrS,EAAGqS,MAAQ,GAC9BT,EAAQjD,WAAY3O,EAAGC,QAAWD,EAAGE,KACrC0R,EAAQhS,IAAIqC,KAAKjC,IAGnBoV,cAAe,SAAUjb,GACvB,OAAOA,GAET6X,SAAU,SAAUnY,EAAOqG,EAAM0R,EAASyD,GAAU,IAAAC,EAAA5a,KAClD,IAAKf,IAAEoL,SAASlL,GAAQ,OAAOA,EAC/B,IAA2B,GAAvBA,EAAMqY,QAAQ,KAAY,OAAOrY,EAE3B+X,EAAQhS,IAAlB,IACI8F,EAAS7L,EAAMqD,MAAM,sBAYzB,OAAqB,IAXrBwI,EAASA,EAAOlI,IAAI,SAACrD,EAAMiB,GACzB,MAAY,IAARjB,EAAmB,KACA,MAAnBA,EAAKoS,OAAO,GAAmBpS,GAEnCA,EAAOA,EAAKqS,UAAU,GAEf,CAAEjP,KAAM,QAAS0C,OADXqV,EAAKF,cAAcjb,OAG/BgD,OAAO,SAAAhD,GAAI,OAAIA,KAGPiD,OAAoB,KACL,GAAjBsI,EAAOtI,SACdsI,EAASA,EAAO,IACLnI,OACTmI,EAAOxF,KAAOA,GAEXvG,IAAE8S,SAAU/G,IACfhL,KAAK0X,MAAMR,EAASlM,EAAOxF,KAAMwF,GAC5BA,GAEC2P,GAeR3P,EAASA,EAAOlI,IAAI,SAACrD,EAAMiB,GACzB,OAAIjB,EAAKoD,MACPpD,EAAK+F,KAAOA,EAAKoI,OAAOlN,GACxBjB,EAAKwE,MAAQvD,EACbjB,EAAKuY,cAAe,EACpBvY,EAAKkY,MAAQ,EAEbiD,EAAKlD,MAAMR,EAAS1R,EAAM/F,GACnBA,GAEGA,IAEdO,KAAK0X,MAAMR,EAAS1R,EAAM,CAAEA,KAAMA,EAAM3C,KAAM,SAAUqC,IAAK8F,EAAQ2M,MAAQ,IACtE3M,GA3BPA,EAASA,EAAOlI,IAAI,SAACrD,EAAMiB,GACzB,OAAIjB,EAAKoD,MACPpD,EAAK+F,KAAOA,EAAKoI,OAAOlN,GACxBjB,EAAKwE,MAAQvD,EACbjB,EAAKkY,MAAQ,EACbiD,EAAKlD,MAAMR,EAAS1R,EAAM/F,GAEnBA,GAEGA,MA0BlBZ,EACM,SAAWsZ,EAAO8B,GACpB,IAAI/V,EAASgU,EAAO3T,IAAK4T,GAGzB,OAFAjU,EAAS8V,EAAOzV,IAAKL,EAAQ+V,IAUrCtb,EAAGkc,oBAAsB,CAGrBtW,IAAK,SAAUvF,EAAKib,GAChB,OAAOpb,EAAOG,EAAKib,IAEvBzV,IAAG,6EC5PP,IAAI7F,EAAKC,OAAOD,GAIZE,EAAK,CAELC,IAAK,CACDgc,QAAU,GAGdvW,IAAM,SAAUnD,GACZ,OAAQA,GAAQ,OAAS,IAAKpB,KAAKlB,IAAIgc,WAI3CC,QAAU,SAAW/b,EAAKgc,GACtB,GAAK/b,IAAEG,WAAYJ,GAAQ,OAAOA,EAAIO,WACtC,GAAKN,IAAEoL,SAAUrL,GAAQ,CAErB,IAAIic,EAAY,IAehB,OAd4B,GAAvBjc,EAAIwY,QAAS,QAAcyD,EAAY,MAClB,GAArBjc,EAAIwY,QAAQ,OAAayD,EAAY,KAEzB,KAAbA,IASAjc,GARAA,EAAMkc,IAAY/C,KAAMnZ,EAAK,CACzBmc,YAAc,EACdC,aAAeJ,EAAS,EACxBK,mBAAoB,EACpBC,sBAAwB,EACxBC,mBAAmB,KAGbC,aAEPP,EAAYjc,EAAMic,EAE7B,GAAKhc,IAAE4J,QAAQ7J,GAAM,CACjB,IAAIyc,EAAQ,GACZ,IAAM,IAAI/a,KAAK1B,EAAM,CACjB,IAAIG,EAAQa,KAAK+a,QAAS/b,EAAI0B,GAAKsa,EAAS,GAE5CS,EAAMlU,KAAMpI,GAGhB,MAAO,IAAMsc,EAAMhW,KAAK,OAAS,IAGrC,GAAKxG,IAAEyc,aAAa1c,GAAM,CACtB,IAAIyc,EAAQ,GAEZ,IAAM,IAAI/a,KAAK1B,EAAM,CACjB,IAAI0M,EAAOhL,EACPvB,EAAQa,KAAK+a,QAAS/b,EAAI0B,GAAIsa,EAAS,GAErCtP,EAAKkO,MAAO,mBAAmBlO,EAAO,IAAMA,EAAO,MAE5B,GAAxBvM,EAAMqY,QAAQ,QAA0B,EAC7CiE,EAAMlU,KAAMmE,EAAO,IAAMvM,GAG7B,MAAO,IAAMsc,EAAMhW,KAAK,KAAO,IAGnC,OAAKxG,IAAE0c,MAAO3c,GAAc,OAErBA,EAAIO,YAGfqc,SAAW,SAAWjN,GAClB,OAAOuM,IAAYA,YAAavM,EAAK,CACjCwM,YAAa,EACbC,cAAgB,EAChBE,sBAAwB,EACxBD,mBAAoB,MA8BhC1c,EAAGkd,YAAc,CAGbtX,IAAK,SAAUnD,GACX,IAAIuN,EAAO9P,EAAGkc,QAAQ3Z,EAAM,GAC5B,OAAOvC,EAAG+c,SAAUjN,IAGxBnK,IAAG,SAGHC,MAAQ,CACJ5F,GAAKA,gBCpFIid,cA7Bb,SAAAA,EAAY3W,GAAO,IAAArE,EAAA,OAAAY,OAAAqa,EAAA,EAAAra,CAAA1B,KAAA8b,IACjBhb,EAAAY,OAAAsa,EAAA,EAAAta,CAAA1B,KAAA0B,OAAAua,EAAA,EAAAva,CAAAoa,GAAAI,KAAAlc,KAAMmF,KAEDnE,MAAQ,CACX7B,MAAQ,IAGV2B,EAAKqb,SAAWrb,EAAKqb,SAASC,KAAd1a,OAAA2a,EAAA,EAAA3a,QAAA2a,EAAA,EAAA3a,CAAAZ,KAPCA,wEAURmG,GACTjH,KAAKsc,SAAU,CAACnd,MAAQ8H,EAAIwE,OAAOtM,QAE9Ba,KAAKmF,MAAMgX,UAAWnc,KAAKmF,MAAMgX,SAAUlV,qDAIxBsV,QACDjS,IAAlBiS,EAAUpd,YAA4CmL,IAAvBiS,EAAUpd,MAAMoD,MAAkBvC,KAAKsc,SAAS,CAACnd,MAAQod,EAAUpd,MAAMoD,wCAK7G,IAAI4C,EAAQzD,OAAO4L,OAAO,GAAItN,KAAKmF,MAAO,CAAChG,MAAQa,KAAKgB,MAAM7B,MAAOgd,SAAWnc,KAAKmc,WAErF,OAAOK,IAAMjE,cAAc,QAASpT,EAAO,aA3B3BuB,+BCGD+V,eACnB,SAAAA,EAActX,GAAQ,IAAArE,EAAA,OAAAY,OAAAqa,EAAA,EAAAra,CAAA1B,KAAAyc,IACpB3b,EAAAY,OAAAsa,EAAA,EAAAta,CAAA1B,KAAA0B,OAAAua,EAAA,EAAAva,CAAA+a,GAAAP,KAAAlc,KAAOmF,KACFuX,IAAMF,IAAMG,YAEjB7b,EAAKE,MAAQ,CACXlB,GAAK,SALagB,mFAUpBd,KAAK4c,WAEL5c,KAAK6c,SAAU7c,KAAKmF,MAAM2X,0CAK1B9c,KAAK+c,IAAMC,UAAUhd,KAAK0c,IAAIO,SAC3BhU,OAAO,OAERjJ,KAAKkd,OAASC,aAAkBH,IAC/BI,eAAc,GAGfpd,KAAK+c,IAAI9T,OAAO,YAAYA,OAAO,cAClC8P,KAAK,KAAM,aACXA,KAAK,UAAW,cAChBA,KAAK,OAAQ,GACbA,KAAK,cAAe,GACpBA,KAAK,eAAgB,GACrBA,KAAK,SAAU,QACf9P,OAAO,YACP8P,KAAK,IAAK,kBACVA,KAAK,OAAQ,yCAIT+D,GAIPjX,QAAQ6D,IAAK,WAAYoT,GACzB,IAAIO,EAAItW,IAAE/G,KAAK0c,IAAIO,SAASK,SACxBC,EAAIxW,IAAE/G,KAAK0c,IAAIO,SAASO,QAK5B,IAAM,IAAI9c,KAAKoc,EAAMW,MACbX,EAAMW,MAAM/c,GAAGgd,SAASZ,EAAMW,MAAM/c,GAAGgd,OAAyB,GAAhBlc,KAAKC,SAAgB,GAI7E,IAAIkc,EACC,EADDA,EAEC,EAFDA,EAGKJ,EAHLI,EAIMN,EAMVP,EAAMW,MAAM9a,QAAQ,SAAUgG,GAAKA,EAAE2U,OAAS3U,EAAE6U,MAAQ,EAAI7U,EAAE+U,SAG9D,IAAIE,EAAiBd,EAAMW,MAAMI,MAAM,GACtCC,EAAU,CAAE1Z,EAAGuZ,EAActZ,EAAGsZ,EAAcI,OAAO,GACrDC,EAAUlB,EAAMW,MAAMlW,KAAKuW,GAAW,EACtCG,EAAc,CAAE7Z,EAAGuZ,EAAeA,EAAkBtZ,EAAGsZ,EAAeA,EAAmBI,OAAO,GAChGG,EAAUpB,EAAMW,MAAMlW,KAAK0W,GAAe,EAC1CE,EAAc,GACf,IAASzd,EAAI,EAAGA,EAAIkd,EAAelb,OAAQhC,IAAK,CAC5C,IAAI0d,EAAaR,EAAeld,GAAGgd,OACnCS,EAAY5W,KAAK,CAAE8W,KAAM,IAAKxb,KAAM,aAAcyb,KAAMN,EAASO,MAAO7d,EAAG8d,IAAMJ,IACjFD,EAAY5W,KAAK,CAAE8W,KAAM,IAAKxb,KAAM,aAAcyb,KAAMN,EAASO,MAAO7d,EAAI8d,IAAMJ,IAClFD,EAAY5W,KAAK,CAAE8W,KAAM,IAAKxb,KAAM,aAAcyb,KAAM5d,EAAG6d,MAAOL,EAAUM,IAAMJ,IAClFD,EAAY5W,KAAK,CAAE8W,KAAM,IAAKxb,KAAM,aAAcyb,KAAM5d,EAAG6d,MAAOL,EAASM,IAAMJ,IAKrFpe,KAAK+c,IACFhE,KAAK,QAASwE,GACdxE,KAAK,SAAUsE,GACfhE,MAAM,cAAe,GAKxBrZ,KAAKkd,OAAOuB,KAAK,CAAClB,EAAEF,IAGpBrd,KAAKkd,OACFO,MAAMX,EAAMW,OACZiB,MAAM5B,EAAM4B,OACZP,YAAaA,GACbf,eAAc,GACduB,aAAa,GAAG,IAChBF,KAAK,CAAClB,EAAEF,IACRuB,WAAW,IAAK,IAChBC,yBAAyB,GACzB5W,MAAM,GAAG,GAAG,IAGf,IAAIzC,EAAOxF,KAAK+c,IAAI+B,UAAU,SAC7Bla,KAAKkY,EAAM4B,OACXK,QAAQ9V,OAAO,YACf8P,KAAK,QAAS,QAEXxG,EAAOvS,KAAK+c,IAAI+B,UAAU,SAC3Bla,KAAKkY,EAAMW,OACXsB,QAAQ9V,OAAO,UACf8P,KAAK,QAAS,QACdA,KAAK,IAAK,SAAUiG,GAAK,OAAOA,EAAEtB,SAClCrE,MAAM,OAAQ,SAAU2F,GAAK,MAAO,YACpC9C,KAAKlc,KAAKkd,OAAO+B,MAEhBC,EAASlf,KAAK+c,IAAI+B,UAAU,QAC/Bla,KAAKkY,EAAMW,OACXsB,QAAQ9V,OAAO,QACT1G,KAAK,SAAUyc,GAAK,OAAOA,EAAE5d,OAC7B2X,KAAK,cAAe,UAE3B/Y,KAAKkd,OAAOlW,GAAG,OAAQ,WACrBuL,EAAKwG,KAAK,KAAM,SAAUiG,GAAK,OAAOA,EAAE5a,IACrC2U,KAAK,KAAM,SAAUiG,GAAK,OAAOA,EAAE3a,IAEpC6a,EAAOnG,KAAK,KAAM,SAAUiG,GAAK,OAAOA,EAAE5a,IACzC2U,KAAK,KAAM,SAAUiG,GAAK,OAAOA,EAAE3a,IAGpCmB,EAAKuT,KAAK,IAAK,SAAUiG,GACvB,MAAO,IAAMA,EAAEvT,OAAOrH,EAAI,IAAM4a,EAAEvT,OAAOpH,EAAI,IAAM2a,EAAEG,OAAO/a,EAAI,IAAM4a,EAAEG,OAAO9a,wDAS3D+a,GAC1BvZ,QAAQ6D,IAAK,iCAAkC0V,GAC/Cpf,KAAK6c,SAAUuC,EAAStC,wCAIxB,OAAOuC,EAAAjF,EAAA7B,cAAA,OAAKmE,IAAK1c,KAAK0c,IAAK5c,GAAI,IAAME,KAAKmF,MAAMrF,GAAIuZ,MAAO,CAACiE,OAAO,OAAOE,MAAM,iBArJ5C9W,iBAyJdA,8BCxJL4Y,eACnB,SAAAA,EAAYna,GAAO,IAAArE,EAAA,OAAAY,OAAAqa,EAAA,EAAAra,CAAA1B,KAAAsf,IACjBxe,EAAAY,OAAAsa,EAAA,EAAAta,CAAA1B,KAAA0B,OAAAua,EAAA,EAAAva,CAAA4d,GAAApD,KAAAlc,KAAMmF,KACDuX,IAAMF,IAAMG,YAEjB7b,EAAKE,MAAQ,CACXlB,GAAI,SALWgB,mFAUjBd,KAAK4c,WAEL5c,KAAK6c,SAAS7c,KAAKmF,MAAM2X,0CAGhB,IAAAvO,EAAAvO,KACLuS,EAAOvS,KAAK0c,IAAIO,QAEpBjd,KAAKyd,MAAQ,IAAI8B,KAAIC,QACrBxf,KAAKyf,MAAQ,IAAIF,KAAIC,QAMrBxf,KAAK0f,QAAU,IAAIH,KAAII,QAAQpN,EAAM,CAAEkL,MAAOzd,KAAKyd,MAAOgC,MAAOzf,KAAKyf,OALxD,CACZrY,OAAQ,CAAEwY,WAAY,GAAKC,YAAY,EACvCvC,OAAQ,OACRE,MAAO,SAITxd,KAAK0f,QAAQ1Y,GAAG,QAAS,SAAC0O,GAExB,IAAI5V,EAAKyO,EAAKmR,QAAQI,UAAUpK,EAAOqK,QAAQC,KAE/Cna,QAAQ6D,IAAI5J,EAAIyO,EAAKpJ,OACjBrF,GAAMyO,EAAKpJ,MAAM8a,SAAS1R,EAAKpJ,MAAM8a,QAAQngB,sCAO5Cgd,GAIPjX,QAAQ6D,IAAI,WAAYoT,GAChB/V,IAAE/G,KAAK0c,IAAIO,SAASK,SACpBvW,IAAE/G,KAAK0c,IAAIO,SAASO,QAE5Bxd,KAAKyd,MAAMyC,OAAOpD,EAAMW,OACxBzd,KAAKyf,MAAMU,QACXngB,KAAKyf,MAAMW,IAAItD,EAAM2C,yDAKGL,GACxBvZ,QAAQ6D,IAAI,iCAAkC0V,GAC9Cpf,KAAK6c,SAASuC,EAAStC,wCAIvB,OAAOuC,EAAAjF,EAAA7B,cAAA,OAAKmE,IAAK1c,KAAK0c,IAAK5c,GAAI,IAAME,KAAKmF,MAAMrF,GAAIuZ,MAAO,CAAEiE,OAAQ,OAAQE,MAAO,iBA7DnD9W,aCAjC/H,GAAKC,OAAOD,GAGZ0hB,GAAmB,CACrBC,QAAUxE,EACVyE,WAAY9D,GACZ+D,QAAUlB,IAIRzgB,GAAK,CAEL4hB,cAAgB,SAAUzhB,EAAK0B,GAAI,IAAAI,EAAAd,KAC/B,IAAKhB,EAAK,OAAO,KACjB,GAAIC,IAAEoL,SAASrL,GAAM,OAAOA,EAC5B,GAAIC,IAAE4J,QAAQ7J,GAAM,OAAOA,EAAI8D,IAAI,SAAC9D,EAAK0B,GAAN,OAAYI,EAAK2f,cAAczhB,EAAK0B,KACvE,IAAM1B,EAAIua,cAAe,OAAO,KAEhC,IAAIE,EAAW,KACXza,EAAIya,WAAUA,EAAWza,EAAIya,SAAS3W,IAAI,SAAC9D,EAAK0B,GAAN,OAAYI,EAAK2f,cAAczhB,EAAK0B,MAElF,IAAIyE,EAAQ,KACRnG,EAAImG,QAAOA,EAAQlG,IAAE6F,UAAU9F,EAAImG,QAEnCA,IAAUA,EAAMwC,MAAKxC,EAAMwC,IAAMjH,GAChCyE,IAAOA,EAAQ,CAAEwC,IAAKjH,IAEF,SAArB1B,EAAIua,gBACNE,EAAW,CAACxa,IAAEyhB,YAAYjH,GAAUhU,KAAK,MAG3C,IAGI8M,EAHAoO,EAAY3hB,EAAIua,cAChB8G,GAAiBM,KAAYA,EAAYN,GAAiBM,IAG9D,IACEpO,EAAOiK,IAAMjE,cAAcoI,EAAWxb,EAAOsU,GAC7C,MAAO7Z,GACPiG,QAAQC,MAAMlG,GACd2S,EAAO,QAET,OAAOA,IAQf5T,GAAGiiB,WAAa,CAGZH,cAAe,SAAUI,GACrB,OAAOhiB,GAAG4hB,cAAcI,EAAc,IAG1Crc,IAAG,SAGHC,MAAQ,CACJ5F,GAAKA,KChEb,IAAIF,GAAKC,OAAOD,GAIZE,GAAK,CAELC,IAAK,CACDgc,QAAU,GAGdgG,YAAc,SAAWpc,EAAIqc,EAAM3N,GAC/B,GAAI1O,GAAMA,EAAGmS,MAAMmK,MAAQ,OAAOtc,EAAGmS,MAAMmK,MAE3C,IAAIjV,EACe,SAAEvG,GACjB,OAAO,SAAWyB,GAChB,IAAI9H,EAAQ8H,EAAIwE,OAAOtM,MACvB4hB,EAAKhd,IAAKyB,EAAMrG,KAJlB4M,EAOa,SAAExG,GACf,OAAO,SAAW0B,GAChB,GAAK8Z,EAAKxb,GAAU,OAAOwb,EAAKxb,GAAS0B,KAT3C8E,EAYiB,SAAExG,GACnB,OAAO,SAAW0B,GACd,IAAIwE,EAASxE,EAAIwE,OACbsN,EAAOhS,IAAE0E,GAAQsN,KAAMxT,EAAO,IAQpC,QAPgB+E,IAATyO,IACDtN,EAAS1E,IAAE0E,GAAQwV,QAAQ,IAAM1b,EAAO,GAAK,KAC7CwT,EAAOhS,IAAE0E,EAAO,IAAIsN,KAAMxT,EAAO,KAIvC0B,EAAIia,kBACCH,EAAKxb,EAAO,IAAM,OAAOwb,EAAKxb,EAAO,IAAKwT,EAAM9R,KAvBvD8E,EA2Ba,SAAExG,GACf,OAAO,SAAW2O,GAClB,GAAK6M,EAAKxb,GAAU,OAAOwb,EAAKxb,GAAS2O,KAMzC8M,EAAQ,GAEZ,IAAM,IAAItgB,KAAK0S,EAAI+N,OACjBH,EAAMtgB,GAAMqL,EAAqBqH,EAAI+N,OAAQzgB,IAI/C,IAAM,IAAIA,KAAK0S,EAAI7O,IACfyc,EAAMtgB,GAAMqL,EAAmBqH,EAAI7O,IAAK7D,IAK5C,IAAM,IAAIA,KAAK0S,EAAIgO,QACjBJ,EAAMtgB,GAAMqL,EAAuBqH,EAAIgO,QAAS1gB,IAKlD,IAAM,IAAIA,KAAK0S,EAAIiO,aACjBL,EAAMtgB,GAAMqL,EAAmBqH,EAAIiO,aAAc3gB,IAKnD,OAFKgE,IACHA,EAAGmS,MAAMmK,MAAQA,GACZA,IAQfriB,GAAGqiB,MAAQ,CAGPzc,IAAK,SAAUnD,GACX,OAAOvC,GAAG0F,IAAInD,IAElBhB,IAAM,SAAWsE,EAAIqc,EAAO3N,GACxB,OAAOvU,GAAGiiB,YAAapc,EAAIqc,EAAM3N,IAGrC5O,IAAG,SAGHC,MAAQ,CACJ5F,GAAKA,KChGb,IAAIF,GAAKC,OAAOD,GAIZE,GAAK,CAELC,IAAK,CACDoY,QAAS,CACLtS,KAAM,CAEFgE,MAAO,GACP+K,KAAM,IAGVxJ,IAAK,CACDmX,QAAS,SAAUxhB,KAInByhB,QAAS,SAAUzhB,MAKvBiM,KAAM,GACNyV,YAAa,SAAUtX,EAAMU,GACzB5K,KAAK+L,KAAKxE,KAAK2C,EAAK1E,OAGxBic,MAAO,CACH,SAAAvd,GAGI,IAFoBA,EAAOlF,IAAIS,KAE/B,CAEA,IAAIK,EAAKoE,EAAOlF,IAAIc,GAChBL,EAAOZ,GAAGC,IAAIoY,QAAQtS,KAAKgE,MAAM9I,GAcrC,OAZKL,IACDA,EAAO,CACH8C,KAAMmf,IAAMC,QAAQC,cACpB9hB,GAAIA,GAGJjB,GAAGC,IAAIoY,QAAQ2K,QACfhjB,GAAGC,IAAIoY,QAAQ2K,OAAO,CAAC,QAAS/hB,GAAKb,IAAE6F,UAAUrF,KAIzDyE,EAAOlF,IAAIS,KAAOA,EACX,YAGX,SAAAyE,GAEI,IADoBA,EAAOlF,IAAI2U,MAAQzP,EAAOlF,IAAIS,MAAQyE,EAAOlF,IAAI8iB,MAAQ,EAC7E,CAEA,IAAI9iB,EAAMkF,EAAOlF,IAEbc,EAAKoE,EAAOlF,IAAIc,GAEhB6T,EAAO9U,GAAGC,IAAIoY,QAAQtS,KAAK+O,KAAK7T,GAEpC,IAAK6T,IAAS9U,GAAGC,IAAIoY,QAAQ6K,UAAW,CACpCpO,EAAO,GAGP,IADA,IACSjT,EAAI,EAAGA,EADJ,EACeA,IAAK,CAC5B,IAAIZ,EAAK4hB,IAAMjgB,OAAOugB,OAClBhd,EAAM,KACO,GAAbhG,EAAI8iB,QAAY9c,EAAM0c,IAAMjgB,OAAOwgB,aAAa,CAAC,KAAM,aAC3D,IAAIlN,EAAM,CACNjV,GAAIA,EACJgiB,MAAO5d,EAAOlF,IAAI8iB,MAAQ,EAC1B9c,IAAKA,GAGT2O,EAAK7T,GAAMiV,EAGXlW,GAAGC,IAAIoY,QAAQ2K,QACfhjB,GAAGC,IAAIoY,QAAQ2K,OAAO,CAAC,OAAQ/hB,GAAKb,IAAE6F,UAAW6O,IASzD,OALMA,IAAOA,EAAO,IAEpBzP,EAAOlF,IAAI2U,KAAOA,EAClBzP,EAAOyP,KAAOA,EAEP,cAKnBjP,GAAI,IAKRH,IAAK,SAAUvF,EAAKib,GAChB,IAAI9C,EAAanX,KAAKlB,IAAIoY,QAE1BlX,KAAKlB,IAAIoY,QAAQ+C,MAAQA,GAAS,GAElC,IAAIlV,EAAO/E,KAAK4U,GAAG5V,EAAK,IAIxB,OAFAgB,KAAKlB,IAAIoY,QAAUC,EAEZpS,GAIX6P,GAAI,SAAU5V,EAAKwG,GACf,IACItB,EAAS,CACTiT,WAAY,KAEZnY,IAAKA,EACL+V,IAAK/V,EAEL4L,OAAQ5K,KACRwF,KAAMA,EACNwF,OAAQ,GACR9F,IAAK,IAKT,IAAK,IAAIxE,KAFTV,KAAKkiB,QAAQhe,GAECA,EAAOyP,KAAM,CACvB,IAAIwO,EAAMniB,KAAK4U,GAAG1Q,EAAOyP,KAAKjT,GAAI8E,EAAKoI,OAAO,CAAClN,KAC/CwD,EAAO8G,OAAOtK,GAAKyhB,EAGvB,OAAOniB,KAAKoiB,UAAUle,IAG1Bme,WAAY,SAAUne,EAAQlF,GACrBkF,EAAOiT,aACRjT,EAAOiT,WAAanX,KAAKlB,IAAIoY,QAC7BlX,KAAKlB,IAAIoY,QAAUxV,OAAOC,OAAO3B,KAAKlB,IAAIoY,UAE9CxV,OAAO4L,OAAOtN,KAAKlB,IAAIoY,QAASlY,IAGpCkjB,QAAS,SAAUhe,GAOf,IALA,IAAIud,EAAQzhB,KAAKlB,IAAIoY,QAAQuK,MAEzB9P,GAAa,EAEb3P,EAAQ,EACL2P,GAAc3P,EAAQ,GAGzB,IAAK,IAAItB,KAFTiR,GAAa,EACb3P,IACcyf,EAAO,CAGjB,GAAW,YADDa,EADEb,EAAM/gB,IACFwD,GACM,CAClByN,GAAa,GACH,EACV,SAMhByQ,UAAW,SAAUle,GACjB,GAAIA,EAAOgB,IAAIxC,OACX,IAAK,IAAIhC,KAAKwD,EAAOgB,IAAK,CACtB,IAAII,EAAKpB,EAAOgB,IAAIxE,GACpBV,KAAKlB,IAAIoY,QAAQ5R,EAAGlE,MAAMkE,EAAG4E,KAAMlK,MAM3C,OAFIkE,EAAOiT,aAAYnX,KAAKlB,IAAIoY,QAAUhT,EAAOiT,YAE1CjT,EAAOlF,MAkBtBL,GAAG4jB,kBAAoB,CAGnBhe,IAAK,SAAUzE,EAAI8E,EAAMmd,EAAYF,GAMjC,OAJAhjB,GAAGC,IAAIoY,QAAQtS,KAAOA,EACtB/F,GAAGC,IAAIoY,QAAQ2K,OAASA,EACxBhjB,GAAGC,IAAIoY,QAAQ6K,UAAYA,EAEpBljB,GAAG0F,IAAI,CAAEzE,GAAIA,GAAM,OAAQgiB,MAAO,GAAK,KAGlD3gB,KAAM,WACFtC,GAAGC,IAAI4F,GAAG8d,OAAS7jB,GAAGuX,YACtBrX,GAAGC,IAAI4F,GAAG6B,eAAiB5H,GAAG4H,gBAGlC/B,IAAG,SAGHC,MAAO,CACH5F,GAAIA,KCzNZ,IAAIF,GAAKC,OAAOD,GAGZE,GAAK,CAELC,IAAK,CACD4F,GAAK,IAGTH,IAAM,SAAWoK,GACb,IAAI5J,EAAO4J,EAGX,OAFA5J,EAAO/E,KAAKlB,IAAI4F,GAAG8d,OAAOje,IAAKQ,EAAO,CAAC,WA8B/CpG,GAAG8jB,UAAY,CAGXle,IAAK,SAAUvF,GACX,OAAOH,GAAG0F,IAAIvF,EAAK,KAGvBmC,KAAO,WACHtC,GAAGC,IAAI4F,GAAG8d,OAAS7jB,GAAGuX,YACtBrX,GAAGC,IAAI4F,GAAG6B,eAAiB5H,GAAG4H,gBAGlC/B,IAAG,SAGHC,MAAQ,CACJ5F,GAAKA,KCvDb,IAAIF,GAAKC,OAAOD,GAGZE,GAAK,CAELC,IAAK,CACD4F,GAAI,GAEJqD,OAAQ,IAGZxD,IAAK,SAAUoK,GACX,IAAI5J,EAAO4J,EAGX,OAFA5J,EAAO/E,KAAKlB,IAAI4F,GAAG8d,OAAOje,IAAIQ,EAAM,CAAC,UAKzC2d,SAAU,SAAU1jB,GAEhB,OADWgB,KAAKlB,IAAI4F,GAAG8d,OAAOje,IAAIvF,EAAK,CAAC,UAI5C2jB,UAAW,SAAU5d,EAAMH,EAAMC,GAC7B,OAAO7E,KAAKlB,IAAI4F,GAAG6B,eAAehC,IAAIQ,EAAMH,EAAMC,IAGtD+d,YAAa,SAAU7d,EAAMH,GAEzB,OADI3F,IAAEoL,SAAStF,KAAOA,EAAO9F,IAAEmB,IAAIJ,KAAKlB,IAAIoY,QAAQ2L,MAAO9d,IACpD/E,KAAKlB,IAAI4F,GAAG6B,eAAehC,IAAIQ,EAAMH,EAAM,SAACA,EAAMY,GACrD,IAAIrG,EAAQF,IAAEmB,IAAKwE,EAAMY,GACzB,OAAKrG,EAAMoT,KAAcpT,EAAMoT,KACxBpT,KAKf2jB,eAAgB,SAAUlM,EAAS5U,GAG/B,QAFcsI,GAATtI,IAAqBA,EAAQ,KAE7BA,GAASA,EAAQ,GAAtB,CAEA4U,EAAUA,GAAW5W,KAAKlB,IAAIoY,QAAQN,QAGtC,IADA,IAAI3F,GAAU,EACLvQ,EAAI,EAAGA,EAAGkW,EAAQlU,OAAQhC,IAAM,CACrC,IAAI+R,EAASmE,EAAQlW,GAErB,IAAK+R,EAAOpB,QAAZ,CAGA,IAAI0R,GAAiB,EAErB,IAAK,IAAI1S,KAAKoC,GACNA,EAAOpC,GAAGrL,MACJyN,EAAOpC,GAAG2S,eACZvQ,EAAOpC,GAAG2S,cAAe,EACzBhjB,KAAKijB,UAAWxQ,EAAOpC,KAEtBoC,EAAOpC,GAAGgB,WACX0R,GAAiB,GAM7B,GAAIA,EAAgB,CAChB,IAAIxQ,EAAO1T,GAAG+jB,YAAYnQ,EAAOzN,IAAKyN,GACtCA,EAAOF,KAAOA,EACdE,EAAOpB,SAAU,EACjBoB,EAAOyQ,eAAiBljB,KAAKlB,IAAIoY,QAAQzF,OACzCR,GAAU,IAGbA,GACDjR,KAAK8iB,eAAgBlM,EAAS5U,EAAM,KAI5CihB,UAAW,SAAUxQ,GACjBA,EAAOxS,IAAMtB,GAAGmK,KAAKvE,IAAI,UACzBkO,EAAO0Q,YAAcnjB,KAAKlB,IAAIoY,QAAQzF,KACtCzR,KAAKlB,IAAIoY,QAAQN,QAAQrP,KAAKkL,IAIlCxK,MAAO,SAAU4a,GACb7iB,KAAKlB,IAAIoY,QAAU,CACfN,QAAS,GACTiM,MAAOA,EACPpR,KAAO,KAOf1L,GACS,CACL3B,EAAC,sOAQDC,EAAG,4CAyBAzF,OAAOwkB,MAAQ,CAAEjkB,MAAO,WACnCR,GAAG0kB,iBAAmB,CAGlB9e,IAAK,WAgBD,OAfA1F,GAAGoJ,MAAMpJ,GAAG6jB,SAASzjB,IAAE6F,UAAUiB,MAEjClH,GAAGokB,UAAU,CACTje,IAAK,IACL7F,MAAQ,WACRmkB,aAAe,WAAQzd,QAAQ6D,IAAK,YACpC6Z,QAAU,CACNve,IAAM,IACNwe,QAAU,QAIlB3kB,GAAGikB,iBAGIjkB,GAAGC,IAAIoY,QAAQN,QAAQ,GAAGrE,MAGrCpR,KAAM,WACFtC,GAAGC,IAAI4F,GAAG8d,OAAS7jB,GAAGuX,YACtBrX,GAAGC,IAAI4F,GAAG6B,eAAiB5H,GAAG4H,gBAGlC/B,IAAG,SAGHC,MAAO,CACH5F,GAAIA,KCtKZ,IAAIF,GAAKC,OAAOD,GAGZE,GAAK,CAELC,IAAK,CACDoY,QAAS,CACLnL,KAAM,GACNyV,YAAa,SAAUtX,EAAMhG,EAAS0G,GAElC1G,EAAOlF,IAAIiB,IAAMtB,GAAGmK,KAAKvE,MAEpBL,EAAOlF,IAAI+F,KAAKI,QAAQjB,EAAOlF,IAAI+F,KAAKI,MAAMse,MAAQvf,EAAOlF,IAAIiB,KAGtED,KAAK+L,KAAM7B,EAAK1E,KAAKC,KAAK,MAASvB,EAAOlF,IAAIiB,MAItDyE,GAAI,IAKRH,IAAM,SAAWvF,EAAKib,GAClB,IAAI9C,EAAanX,KAAKlB,IAAIoY,QAE1BlX,KAAKlB,IAAIoY,QAAQ+C,MAAQA,EAEzB,IAAIlV,EAAO/E,KAAK4U,GAAI5V,EAAK,IAIzB,OAFAgB,KAAKlB,IAAIoY,QAAUC,EAEZpS,GAIX6P,GAAI,SAAU5V,EAAKwG,GACf,IACItB,EAAS,CACTiT,WAAY,KAEZnY,IAAKA,EACL+V,IAAK/V,EAEL4L,OAAQ5K,KACRwF,KAAMA,EACNwF,OAAQhM,EACRkG,IAAK,IAKT,IAAK,IAAIxE,KAFTV,KAAKkiB,QAAQhe,GAECA,EAAO6Q,IAAK,CACtB,IAAIoN,EAAMniB,KAAK4U,GAAG1Q,EAAO6Q,IAAIrU,GAAI8E,EAAKoI,OAAOlN,IAC7CwD,EAAO8G,OAAOtK,GAAKyhB,EAGvB,OAAOniB,KAAKoiB,UAAUle,IAG1Bme,WAAY,SAAUne,EAAQlF,GACrBkF,EAAOiT,aACRjT,EAAOiT,WAAanX,KAAKlB,IAAIoY,QAC7BlX,KAAKlB,IAAIoY,QAAUxV,OAAOC,OAAO3B,KAAKlB,IAAIoY,UAE9CxV,OAAO4L,OAAOtN,KAAKlB,IAAIoY,QAASlY,IAGpCkjB,QAAS,SAAUhe,GAmDf,IAnDuB,IAAApD,EAAAd,KACnBuT,EAAS,CACTlJ,SAAU,SAAAnG,GAAM,OAAIA,EAAOlF,KAAOkF,EAAOlF,IAAIoZ,MAC7CsL,cAAe,SAAAxf,GAAM,OAAIA,EAAOlF,KAAOkF,EAAOlF,IAAImZ,OAASjU,EAAOlF,IAAI+F,MACtEwI,aAAe,SAAArJ,GAAM,OAAIA,EAAOlF,KAAOkF,EAAOlF,IAAIuO,cAClDoW,SAAe,SAAAzf,GAAM,OAAIA,EAAOlF,KAAOkF,EAAOlF,IAAI2G,QAGlD8b,EAAQ,CACRpX,SAAY,SAACnG,GAGT,OAFAA,EAAO8G,OAAS9G,EAAOlF,IAAM,CAAEmZ,KAAMjU,EAAOlF,KAC5CkF,EAAO6Q,IAAM,GACN,WAEX2O,cAAiB,SAACxf,GACdA,EAAO6Q,IAAM,GACb,IAAI/V,EAAM0C,OAAO4L,OAAO,GAAIpJ,EAAOlF,IAAK,CACpC+F,KAAMjE,EAAKhC,IAAI4F,GAAGkf,UAAUrf,IAAKL,EAAOlF,IAAImZ,KAAMrX,EAAKhC,IAAIoY,QAAQ+C,SAMvE,OAHA/V,EAAO8G,OAAS9G,EAAOlF,IAAMA,EAE7BkF,EAAOgB,IAAIqC,KAAK,CAAEnG,KAAM,cAAeoE,KAAMtB,EAAOsB,OAC7C,WAEX+H,aAAgB,SAACrJ,GACb,IAAI6Q,EAAM,GACV,IAAM,IAAIrU,KAAKwD,EAAOlF,IACR,gBAAL0B,IACLqU,EAAKrU,GAAM,CAAEiF,MAAQzB,EAAOlF,IAAI0B,KAIpC,OAFAwD,EAAO8G,OAAS,GAChB9G,EAAO6Q,IAAMA,EACN,WAEX4O,SAAY,SAACzf,GACTA,EAAO6Q,IAAM,GACb,IAAI/V,EAAM0C,OAAO4L,OAAO,GAAIpJ,EAAOlF,IAAK,CACpC+F,KAAMjE,EAAKhC,IAAI4F,GAAGmf,SAAStf,IAAKL,EAAOlF,IAAI2G,MAAO7E,EAAKhC,IAAIoY,QAAQ+C,SAMvE,OAHA/V,EAAO8G,OAAS9G,EAAOlF,IAAMA,EAE7BkF,EAAOgB,IAAIqC,KAAK,CAAEnG,KAAM,cAAeoE,KAAMtB,EAAOsB,OAC7C,YAIXmM,GAAa,EAEb3P,EAAQ,EACL2P,GAAc3P,EAAQ,GAGzB,IAAK,IAAItB,KAFTiR,GAAa,EACb3P,IACcyf,EAAO,CAEjB,IAAKqC,EADQvQ,EAAO7S,IACRwD,GAIZ,GAAW,YADDoe,EADEb,EAAM/gB,IACFwD,GACM,CAClByN,GAAa,GACH,EACV,SAMhByQ,UAAW,SAAUle,GACjB,GAAIA,EAAOgB,IAAIxC,OACX,IAAK,IAAIhC,KAAKwD,EAAOgB,IAAK,CACtB,IAAII,EAAKpB,EAAOgB,IAAIxE,GACpBV,KAAKlB,IAAIoY,QAAQ5R,EAAGlE,MAAMkE,EAAIpB,EAAQlE,MAM9C,OAFIkE,EAAOiT,aAAYnX,KAAKlB,IAAIoY,QAAUhT,EAAOiT,YAE1CjT,EAAO8G,SA+BtBrM,GAAGuX,YAAc,CAGb3R,IAAK,SAAUvF,EAAKib,GAChB,OAAOpb,GAAG0F,IAAIvF,EAAKib,IAGvB9Y,KAAO,WACHtC,GAAGC,IAAI4F,GAAGkf,UAAYjlB,GAAGkc,oBACzBhc,GAAGC,IAAI4F,GAAGmf,SAAWllB,GAAGsZ,kBAG5BzT,IAAG,gGAKHC,MAAQ,CACJ5F,GAAKA,KCpMb,IAAIF,GAAKC,OAAOD,GAIZE,GAAK,CAELC,IAAK,CACD4F,GAAI,GACJqf,SAAU,CACNC,YAAa,CACT,MACA,QACA,OACA,SAEJC,WAAY,OACZC,iBAAkB,GAGlBC,QAAS,SAAUja,EAAMhG,EAAQ0G,GAC7B1G,EAAOlF,IAAI2U,KAAOzP,EAAO8G,OAGzB,IAAIhM,EAAMkF,EAAOlF,IACbukB,EAAU,GACd,IAAK,IAAI7iB,KAAKwD,EAAO8G,OAAQ,CACzB,IAAIvL,EAAOyE,EAAO8G,OAAOtK,GACrBjB,EAAKge,OAAShe,EAAKge,MAAM2G,MACzBb,EAAQhc,KAAK9H,EAAKge,MAAM2G,MAG5Bb,IACArf,EAAOlF,IAAIye,MAAM8F,QAAU3Y,EAAO9L,IAAIoY,QAAQmN,YAAYrlB,EAAIgG,IAAM,WAAY,CAAE2O,KAAM4P,KAG5F,IAAI3e,EAAOV,EAAOlF,IAAIye,MACtBvZ,EAAOlF,IAAIye,MAAM2G,KAAOxZ,EAAO9L,IAAIoY,QAAQmN,YAAYrlB,EAAIgG,IAAM,QAASJ,IAI9Eyf,YAAa,SAAUrf,EAAKJ,EAAM0f,GAE9B,IAAKA,EAID,IAHA,IAAI9P,EAAQxP,EAAIxC,MAAM,KAClB+hB,EAAO1lB,GAAGC,IAAIiJ,OAAO8a,MAEhBniB,EAAI,EAAGA,EAAI8T,EAAM9R,OAAQhC,IAAK,CACnC,IAAI+Q,EAAO+C,EAAM9T,GACjB,GAAI6jB,EAAK9S,GAAM+S,YAAa,CACxB,IAAI1kB,EAAKykB,EAAK9S,GAAM+S,YAAYvkB,IAChCD,KAAKkkB,iBAAiBpkB,GAAM,CAAEkD,OAAQuhB,EAAK9S,IAE/C,IAAI8S,EAAK9S,GAEJ,MADD8S,EAAOA,EAAK9S,GAKxB,IAAI1M,EAAO9F,IAAEmB,IAAIvB,GAAGC,IAAIiJ,OAAO8a,MAAO7d,GACtC,OAAOnG,GAAGC,IAAI4F,GAAG6B,eAAehC,IAAIQ,EAAMH,IAE9C6c,MAAO,CACH,SAACvd,EAAQ0G,GAGL,IADoB1G,EAAOlF,IAAI4F,KAC/B,CAEA,IAEIqf,EAFOrZ,EAAO9L,IAAIoY,QAAQ8M,YAER9f,EAAOlF,IAAI8iB,QAAUlX,EAAO9L,IAAIoY,QAAQ+M,WAG1DjlB,EAAM,CACNgG,IAAKd,EAAOlF,IAAIgG,KAAOif,EACvBrf,KAAMV,EAAOlF,IAAIS,KACjBqiB,MAAO5d,EAAOlF,IAAI8iB,MAClBrE,MAAO,IAOX,OAJAvZ,EAAOyP,KAAOzP,EAAOlF,IAAI2U,KACzBzP,EAAOlF,IAAMA,EACbkF,EAAOgB,IAAIqC,KAAK,CAAEnG,KAAM,UAAW8I,KAAM,SAElC,YAGX,SAAChG,EAAQ0G,GAEL,IADoB1G,EAAOlF,IAAIye,MAAMgH,MACrC,CAEA,IAAIzlB,EAAMkF,EAAOlF,IAGbgM,GADOnM,GAAGC,IAAIiJ,OAAO8a,MAAMpjB,KAAKglB,MACvB,CACTA,MAAOvgB,EAAOlF,IAAI4F,KAAKrC,KACvBuf,MAAO5d,EAAOlF,IAAI8iB,QAKtB,OAFA5d,EAAOlF,IAAIye,MAAMgH,MAAQ7Z,EAAO9L,IAAIoY,QAAQmN,YAAYrlB,EAAIgG,IAAM,SAAUgG,GAErE,eAUvB0Z,SAAU,SAAU3Y,GAEhB,OADY/L,KAAKlB,IAAI4F,GAAG8d,OAAOje,IAAIwH,IAKvC4Y,UAAW,SAAU/f,GAEjB,OADW5E,KAAKlB,IAAI4F,GAAGkgB,SAASrgB,IAAIK,EAAM,CAAEsS,QAASlX,KAAKlB,IAAIilB,YAIlEc,gBAAiB,SAAUpH,EAAOqH,GAC9B,IAII9hB,EAJA+hB,EAAS,GACbD,EAAMA,GAAO9kB,KAAKlB,IAAIilB,SAASG,iBAK/B,IAAIc,EAAe,SAACxf,GAAD,MAAU,WAAaxC,EAAOwC,GAAMvF,IAAM,MAEzD4E,EAAS,SAACD,EAAMY,GAChB,OAAIxC,EAAOwC,GACAwf,EAAaxf,GAEP,KAARA,EAEE9D,OAAO6H,KAAKvG,GAAQP,OAAO,SAAAhD,GAAI,MAAY,eAARA,IAAuBqD,IAAI,SAAArD,GAAI,OAAIulB,EAAavlB,KAAOgG,KAAK,KAEnGxG,IAAEmB,IAAIwE,EAAMY,IAGnBZ,EAAO,CAAEgL,MAAO,OACpB,IAAK,IAAIlP,KAAKokB,EAAK,CACf9hB,EAAS8hB,EAAIpkB,GAAGsC,OAChB,IAAIqW,EAAQxa,GAAGC,IAAI4F,GAAG6B,eAAehC,IAAIvB,EAAOwhB,YAAa5f,EAAMC,GACnEkgB,EAAOxd,KAAK8R,GAMhB,OAHI0L,EAAOriB,SACP+a,EAAQ,CAACA,EAAOsH,IAEbtH,IAuEf9e,GAAGsmB,iBAAmB,CAGlB1gB,IAAK,SAAUvF,GAEX,IAAI+I,EAASlJ,GAAGC,IAAIiJ,OAAS,CACzB8a,MAAQ7jB,EAAI6jB,MACZqC,KAAQlmB,EAAI4F,MAGhBlD,OAAO4L,OAAOzO,GAAGC,IAAIilB,SAAU,CAC3BC,YAAahlB,EAAImmB,SAASnB,YAC1BC,WAAYjlB,EAAImmB,SAASlB,WACzBC,iBAAkB,KAGtBnc,EAAOgE,KAAOlN,GAAG8lB,UAAU5c,EAAOmd,MAElC,IAAId,EAAOrc,EAAOgE,KAAK0R,MAAM2G,KAG7B,OAFAA,EAAOvlB,GAAGgmB,gBAAgBT,IAK9BjjB,KAAM,WACFtC,GAAGC,IAAI4F,GAAG8d,OAAS7jB,GAAGuX,YACtBrX,GAAGC,IAAI4F,GAAG6B,eAAiB5H,GAAG4H,eAC9B1H,GAAGC,IAAI4F,GAAGkgB,SAAWjmB,GAAGymB,cAG5B5gB,IAAG,SAGHC,MAAO,CACH5F,GAAIA,KChQZ,IAAIF,GAAKC,OAAOD,GAIZE,GAAK,CAELC,IAAK,GAGLyF,IAAM,SAAWvF,EAAKib,GAClB,IAAI9C,EAAanX,KAAKlB,IAAIoY,QAE1BlX,KAAKlB,IAAIoY,QAAQ+C,MAAQA,EAEzB,IAAIlV,EAAO/E,KAAK4U,GAAI5V,EAAK,IAIzB,OAFAgB,KAAKlB,IAAIoY,QAAUC,EAEZpS,GAIX6P,GAAI,SAAU5V,EAAKwG,GACf,IACItB,EAAS,CACTiT,WAAY,KAEZnY,IAAKA,EACL+V,IAAK/V,EAEL4L,OAAQ5K,KACRwF,KAAMA,EACNwF,OAAQ,GACR9F,IAAK,IAKT,IAAK,IAAIxE,KAFTV,KAAKkiB,QAAQhe,GAECA,EAAOyP,KAAM,CACvB,IAAIwO,EAAMniB,KAAK4U,GAAG1Q,EAAOyP,KAAKjT,GAAI8E,EAAKoI,OAAO,CAAClN,KAC/CwD,EAAO8G,OAAOtK,GAAKyhB,EAGvB,OAAOniB,KAAKoiB,UAAUle,IAG1Bme,WAAY,SAAUne,EAAQlF,GACrBkF,EAAOiT,aACRjT,EAAOiT,WAAanX,KAAKlB,IAAIoY,QAC7BlX,KAAKlB,IAAIoY,QAAUxV,OAAOC,OAAO3B,KAAKlB,IAAIoY,UAE9CxV,OAAO4L,OAAOtN,KAAKlB,IAAIoY,QAASlY,IAGpCkjB,QAAS,SAAUhe,GAOf,IALA,IAAIud,EAAQzhB,KAAKlB,IAAIoY,QAAQuK,MAEzB9P,GAAa,EAEb3P,EAAQ,EACL2P,GAAc3P,EAAQ,GAGzB,IAAK,IAAItB,KAFTiR,GAAa,EACb3P,IACcyf,EAAO,CAGjB,GAAW,YADDa,EADEb,EAAM/gB,IACFwD,EAAQlE,MACF,CAClB2R,GAAa,GACH,EACV,SAMhByQ,UAAW,SAAUle,GACjB,GAAIA,EAAOgB,IAAIxC,OACX,IAAK,IAAIhC,KAAKwD,EAAOgB,IAAK,CACtB,IAAII,EAAKpB,EAAOgB,IAAIxE,GACpBV,KAAKlB,IAAIoY,QAAQ5R,EAAGlE,MAAMkE,EAAG4E,KAAMhG,EAASlE,MAMpD,OAFIkE,EAAOiT,aAAYnX,KAAKlB,IAAIoY,QAAUhT,EAAOiT,YAE1CjT,EAAOlF,MAOtBL,GAAGymB,aAAe,CAGd7gB,IAAK,SAAUvF,EAAKF,GAChB,IAAIumB,EAAM3jB,OAAOC,OAAQ9C,IAGzB,OAFAwmB,EAAIvmB,IAAMA,EACJA,EAAIoY,UAAUpY,EAAIoY,QAAU,CAAEuK,MAAQ,KACrC4D,EAAI9gB,IAAIvF,EAAK,KAGxBmC,KAAO,aAKPqD,IAAG,SAGHC,MAAQ,CACJ5F,GAAKA,KChHb,IAAIF,GAAKC,OAAOD,GAIZE,GAAK,CAELC,IAAK,CACDgc,QAAU,GAGdvW,IAAM,SAAUnD,GACZ,OAAQA,GAAQ,OAAS,IAAKpB,KAAKlB,IAAIgc,YAQ/Cnc,GAAGmK,KAAO,CAGNvE,IAAK,SAAUnD,GACX,OAAOvC,GAAG0F,IAAInD,IAGlBoD,IAAG,SAGHC,MAAQ,CACJ5F,GAAKA,KC7Bb,IAAIF,GAAKC,OAAOD,GAIhB,IAAK,IAAI+B,MAFT/B,GAAGgI,YAAc/H,OAAO+H,YAEVhI,GACNA,GAAG+B,IAAGS,MAAMxC,GAAG+B,IAAGS,OAsB1B,IAAK,IAAIT,MAjBT/B,GAAG0H,MAAQ,CACP0B,OAAQ,CACJ7E,KAAM,GACNsT,KAAM,GACN8O,QAAS,IAEbhf,IAAK,SAAUlF,EAAMjC,GACjBa,KAAK+H,OAAOyO,KAAKpV,GAAQjC,GAE7BiB,IAAK,SAAUgB,GACX,IAAIjC,EAAQF,IAAEmB,IAAIJ,KAAK+H,OAAOyO,KAAMpV,GAEpC,OADKjC,IAAOA,EAAQF,IAAEmB,IAAIJ,KAAK+H,OAAO7E,KAAM9B,IACrCjC,IAKDR,GACNA,GAAG+B,IAAGwC,MACNvE,GAAG0H,MAAM0B,OAAOud,QAAQ/d,KAAK7G,IAOrC,IADA,IAAI6kB,GAAS,EACNA,GAAS,GAAK5mB,GAAG0H,MAAM0B,OAAOud,QAAQ5iB,QAAQ,CACjD,IAAIhC,GAAI/B,GAAG0H,MAAM0B,OAAOud,QAAQE,QAChCD,KACA,IAAIrhB,GAAS,GACTie,QAAG,EACP,IACIA,GAAMxjB,GAAG+B,IAAGwC,KAAKgB,IACnB,MAAOtE,IACLiG,QAAQ6D,IAAI,sBAAuBhJ,GAAGd,IAG1C,GAAW,WAAPuiB,GAAJ,CASA,GALAtc,QAAQ4f,MAAM,YAAa/kB,IAE3B/B,GAAG0H,MAAM0B,OAAO7E,KAAKxC,IAAKwD,GAEtBie,IAAKtc,QAAQ6D,IAAIyY,IACjBzgB,OAAO6H,KAAKrF,IACZ,IAAK,IAAIxD,MAAKwD,GAAQ2B,QAAQ6D,IAAIhJ,GAAGwD,GAAOxD,KAEhDmF,QAAQ6f,gBAXJ/mB,GAAG0H,MAAM0B,OAAOud,QAAQ/d,KAAK7G,IAcjC/B,GAAG0H,MAAM0B,OAAOud,QAAQ5iB,QACxBmD,QAAQC,MAAM,uBC1CHnH,qCCJLC,OAAOwU,IAAM,GAEvBxU,OAAOmI,EAAIA,IAEGnI,OAAO+mB,QAAU,GAA/B,IAOIhf,GAAc/H,OAAO+H,YACzBA,GAAYif,QAAS,EAEFC,EAAoB1kB,KAAKwF,IAG5C/H,OAAOmI,EAAIA,IAEX,IAII+e,GAAOlnB,OAAOknB,KAAO,GAEzBnf,GAAYof,YAAY,QAAS,CAC/BC,OAAQ,CACN5lB,IAAK,WAIH,IAAIgT,EAAM0S,GAEL1S,EAAI6S,OAAU7S,EAAI6S,MAAM5U,UAC3BrR,KAAKkmB,KAAK9S,EAAK,QAAS,WAAY,CAClC+S,IAAK/S,EAAI6S,QAGXjmB,KAAKomB,SAAShT,IAGhBA,EAAI6S,MAAMI,OAAO,UAAW,aAAc,CACxCC,QAAS,KACTtlB,MAAS,gBAGXoS,EAAI6S,MAAMI,OAAO,cAAe,iBAAkB,CAChDC,QAAS,OAIXlT,EAAI6S,MAAMI,OAAO,eAAgB,oBAAqB,CACpDC,QAAS,OAGXlT,EAAI6S,MAAMI,OAAO,eAAgB,oBAAqB,CACpDC,QAAS,OAIXlT,EAAI6S,MAAMI,OAAO,UAAW,iBAAkB,CAC5CC,QAAS,OAKXlT,EAAI6S,MAAMI,OAAO,KAAM,QAAS,IAEhCjT,EAAI6S,MAAMI,OAAO,qBAAsB,wBAAyB,IAGhEjT,EAAI6S,MAAMI,OAAO,OAAQ,iBAAkB,CACzCC,QAAS,OAGXlT,EAAI6S,MAAMG,YAIZA,SAAU,SAAUhT,GAClB,IAAK,IAAI1S,KAAK0S,EACRA,EAAI1S,GAAG6lB,SACTvmB,KAAK6G,MAAMuM,EAAKA,EAAI1S,IAGxB,OAAO,GAGTwlB,KAAM,SAAU9S,EAAKhS,EAAMoE,EAAMsI,GAC/B,IAAI9O,EAAM0C,OAAOC,OAAOgF,GAAYU,SAAS7B,IAC7CxG,EAAIunB,SAAU,EACdvnB,EAAI8O,MAAQA,EACZ9O,EAAIiB,IAAMtB,GAAGmK,KAAKvE,MAEd6O,EAAIhS,GAAOnC,IAAEuO,MAAM4F,EAAIhS,GAAOpC,GAEhCoU,EAAIhS,GAAQpC,GAGhB6H,MAAO,SAAUuM,EAAKpU,UACbA,EAAIunB,QAEX,IAAIvb,EAAS,GACb,IAAK,IAAItK,KAAK1B,EAAI8O,MAAO,CACvB,IAAIrC,EAASxM,IAAEoL,SAASrL,EAAI8O,MAAMpN,IAAMzB,IAAEmB,IAAIgT,EAAKpU,EAAI8O,MAAMpN,IAAM1B,EAAI8O,MAAMpN,GACxE+K,IACHA,EAAS,GACTxM,IAAE8E,IAAIqP,EAAKpU,EAAI8O,MAAMpN,GAAI+K,IAE3BxM,IAAE8E,IAAIiH,EAAQtK,EAAG+K,GAGfzM,EAAI6H,OACN7H,EAAI6H,MAAMmE,GAEZhM,EAAIqS,SAAU,GAGhBmV,WAAW,KAOf7f,GAAYof,YAAY,wBAAyB,CAC/Clf,MAAO,SAAUyH,GACfrP,IAAEuO,MAAMxN,KAAMsO,GAEdtO,KAAK+H,OAAS,CACZoB,QAAS,KAIbiX,IAAK,SAAUhf,GACbpB,KAAK+H,OAAOoB,QAAQ5B,KAAKnG,IAG3BqlB,OAAQ,WACN,IAAItd,EAAUnJ,KAAK+H,OAAOoB,QAG1B,IAAK,IAAIzI,KAFTV,KAAK+H,OAAOoB,QAAU,GAERA,EACRnJ,KAAKmJ,EAAQzI,KACfV,KAAKmJ,EAAQzI,OAGnBgmB,uBAAwB,WACtB,IAAIjb,EAAS1E,IAAE,qBAAqB3G,IAAI,GACpCqL,GAAQA,EAAOkb,wBAAuB,IAG5CC,eAAgB,WACV7f,IAAE,cAAcrE,SAEpBqE,IAAE,QAAQ8f,SAAS,SAEnBjoB,OAAOyJ,WAAW,WAChBtB,IAAE,QAAQ+f,YAAY,UACrB,SAGPngB,GAAYof,YAAY,iBAAkB,CACxClf,MAAO,SAAUyH,GAAM,IAAAxN,EAAAd,KACrBf,IAAEuO,MAAMxN,KAAMsO,GAEdtO,KAAK+H,OAAS,CACZ/G,MAAO,CACLE,OAAQ,OACRpB,GAAI,cACJmB,OAAQ,IAIZ6kB,GAAKG,MAAMc,QAAQ/mB,KAAK0E,GAAG3E,IACxBM,KAAK,WACJ,OAAOS,EAAK4D,GAAG3E,GAAGmJ,UAAU,CAAC,kBAE9BvI,MAAM,cAENN,KAAK,SAACW,GACAA,EAAM,IAITF,EAAKiH,OAAO/G,MAAQA,EAAM,GAC1BF,EAAKuQ,SAAU,GAJfvQ,EAAK4D,GAAG3E,GAAG2I,UAAU5H,EAAKb,IAAK,CAACa,EAAKiH,OAAO/G,WASpD8P,MAAO,WAGL,OAFA9Q,KAAK+H,OAAO/G,MAAMC,SAClBjB,KAAK0E,GAAG3E,GAAGinB,aAAahnB,KAAKC,IAAK,CAACD,KAAK+H,OAAO/G,OAAQ,KAChD,OAAShB,KAAK+H,OAAO/G,MAAMC,QAGpCM,QAAS,WACP,OAAO,IAAID,MAAOC,aAMtBukB,GAAKG,MAAQ,CACXtS,KAAM,GACNsT,QAAS,GACTZ,OAAQ,SAAUjM,EAAGC,EAAG6M,GACtBlnB,KAAK2T,KAAKpM,KAAK,CAAC6S,EAAGC,EAAG6M,KAExBH,QAAS,SAAUhS,GACjB,IAAImC,EAAU,GACViQ,EAAU,IAAIC,QAAQ,SAACC,GACzBnQ,EAAQmQ,QAAUA,IAOpB,OAJKrnB,KAAKinB,QAAQlS,EAAI9U,OAAMD,KAAKinB,QAAQlS,EAAI9U,KAAO,IAEpDD,KAAKinB,QAAQlS,EAAI9U,KAAKsH,KAAK2P,GAEpBiQ,IAKXxgB,GAAYof,YAAY,iBAAkB,CACxClf,MAAO,SAAUyH,GAAM,IAAAC,EAAAvO,KACrBf,IAAEuO,MAAMxN,KAAMsO,GAEdtO,KAAK+H,OAAS,CACZ/G,MAAO,CACLE,OAAQ,OACRpB,GAAI,cACJmB,OAAQ,IAIZ6kB,GAAKG,MAAMc,QAAQ/mB,KAAK0E,GAAG3E,IACxBM,KAAK,WACJ,OAAOkO,EAAK7J,GAAG3E,GAAGmJ,UAAU,CAAC,kBAE9BvI,MAAM,cAENN,KAAK,SAACW,GACAA,EAAM,IAITuN,EAAKxG,OAAO/G,MAAQA,EAAM,GAC1BuN,EAAK8C,SAAU,GAJf9C,EAAK7J,GAAG3E,GAAG2I,UAAU6F,EAAKtO,IAAK,CAACsO,EAAKxG,OAAO/G,WASpD8P,MAAO,WAGL,OAFA9Q,KAAK+H,OAAO/G,MAAMC,SAClBjB,KAAK0E,GAAG3E,GAAGinB,aAAahnB,KAAKC,IAAK,CAACD,KAAK+H,OAAO/G,OAAQ,KAChD,OAAShB,KAAK+H,OAAO/G,MAAMC,QAGpCM,QAAS,WACP,OAAO,IAAID,MAAOC,aAItBoF,GAAYof,YAAY,WAAY,CAClClf,MAAO,SAAUyH,GAEfrP,IAAEuO,MAAMxN,KAAMsO,GAEdtO,KAAKoT,IAAM9E,EAAK8E,KAAO0S,GAEvB9lB,KAAKinB,QAAUjnB,KAAKinB,SAAW,GAE/B,IAAIK,GAAgB,EAEpB,GAAItnB,KAAKmmB,KAAOnmB,KAAKmmB,IAAIxS,KAAM,CAC7B,IAAK,IAAIjT,KAAKV,KAAKmmB,IAAIxS,KAAM,CAC3B,IAAIoB,EAAM/U,KAAKmmB,IAAIxS,KAAKjT,GACxBV,KAAKqmB,OAAOtR,EAAI,GAAIA,EAAI,GAAIA,EAAI,IAElCuS,GAAgB,SACTtnB,KAAK2T,KAGd,GAAIrF,EAAKiZ,IAAK,CACZ,IAAK,IAAI7mB,KAAK4N,EAAKiZ,IAAK,CACtB,IAAI1oB,EAAKyP,EAAKiZ,IAAI7mB,GAClBV,KAAKqmB,OAAOxnB,EAAGuC,KAAMvC,EAAG2G,KAAM3G,EAAGiP,OAEnCwZ,GAAgB,EAGdA,GACFtnB,KAAKomB,YAIToB,OAAQ,WACN,IAAI1nB,EAAKnB,GAAGmK,KAAKvE,MAEbnD,EAAO,YAActB,EAEzBE,KAAKqmB,OAAOjlB,EAAM,WAAY,CAC5BtB,GAAIA,EACJsT,IAAK,GACLpQ,OAAQhD,OAGVA,KAAKomB,WAGL,IAAI3mB,EAAOO,KAAKoT,IAAIhS,GAKpB,OAHApB,KAAKoT,IAAIhS,GAAMgS,IAAI6S,MAAQxmB,EAE3BA,EAAKgoB,cAAc,MACZhoB,EAAK2T,KAIdqU,cAAe,SAAUC,GAKvB,IAAK,IAAIhnB,KAJLzB,IAAEoL,SAASqd,KACbA,EAAQ,CAACA,IAGGA,EAAO,CACnB,IAAItmB,EAAOsmB,EAAMhnB,IAAMA,EACnB7B,EAAKmB,KAAKgD,OAAOoQ,IAAIhS,GAEzBpB,KAAKoT,IAAIhS,GAAQvC,IAGrB8oB,MAAO,SAAUhP,GAAM,IAAAiC,EAAA5a,KACrB,OAAIf,IAAE4J,QAAQ8P,IACZA,EAAKhW,QAAQ,SAAAgW,GACP1Z,IAAEoL,SAASsO,KAAUA,EAAKvX,KAAMwZ,EAAK6M,cAAc9O,GAClDiC,EAAKyL,OAAO1N,EAAKvX,KAAMuX,EAAKnT,KAAMmT,EAAK7K,cAE9C9N,KAAKomB,aAGPpmB,KAAKqmB,OAAO1N,EAAKvX,KAAMuX,EAAKnT,KAAMmT,EAAK7K,OACvC9N,KAAKomB,WAEEpmB,KAAKoT,IAAIuF,EAAKvX,QAEvBwmB,OAAQ,SAAUjP,GAChB3Y,KAAK2nB,MAAMjmB,OAAOsJ,OAAO2N,KAE3ByN,SAAU,WACR,IAAIhT,EAAMpT,KAAKoT,IACf,IAAK,IAAI1S,KAAK0S,EACRA,EAAI1S,GAAG6lB,SACTvmB,KAAK6nB,QAAQzU,EAAI1S,IAGrB,OAAO,GAGT2lB,OAAQ,SAAUjlB,EAAMoE,EAAMsI,EAAOsF,GAEnCA,EAAMA,GAAOpT,KAAKoT,IAClB,IAAIpU,EAAMC,IAAEoL,SAAS7E,GAAQ9D,OAAOC,OAAOgF,GAAYU,SAAS7B,IAASA,EACzExG,EAAIunB,SAAU,EACdvnB,EAAI8O,MAAQA,EACZ9O,EAAIiB,IAAMmT,EAAIhS,IAASgS,EAAIhS,GAAMtB,GAAKsT,EAAIhS,GAAMnB,IAAO6N,EAAMhO,IAAMnB,GAAGmK,KAAKvE,MAGvE6O,EAAIhS,GAAOnC,IAAEuO,MAAM4F,EAAIhS,GAAOpC,GAEhCoU,EAAIhS,GAAQpC,GAGhB6oB,QAAS,SAAU7oB,EAAKoU,GACtBA,EAAMA,GAAOpT,KAAKoT,WACXpU,EAAIunB,QAEX,IAAIvb,EAAS,GACb,IAAK,IAAItK,KAAK1B,EAAI8O,MAAO,CACvB,IAAIrC,EAASxM,IAAEoL,SAASrL,EAAI8O,MAAMpN,IAAMzB,IAAEmB,IAAIgT,EAAKpU,EAAI8O,MAAMpN,IAAM1B,EAAI8O,MAAMpN,GACxE+K,IACHA,EAAS,CAAExL,IAAKtB,GAAGmK,KAAKvE,OACxBtF,IAAE8E,IAAIqP,EAAKpU,EAAI8O,MAAMpN,GAAI+K,IAE3BxM,IAAE8E,IAAIiH,EAAQtK,EAAG+K,GAGfzM,EAAI6H,OACN7H,EAAI6H,MAAMmE,GAEZhM,EAAIqS,SAAU,EAEVrR,KAAKinB,QAAQjoB,EAAIiB,OACnBD,KAAKinB,QAAQjoB,EAAIiB,KAAK0C,QAAQ,SAAAuU,GAC5BA,EAAQmQ,YAGVrnB,KAAKinB,QAAQjoB,EAAIiB,KAAO,KAI5B8mB,QAAS,SAAUhS,GAEjB,GAAIA,EAAI1D,QAAS,OAAO+V,QAAQC,UAEhC,IAAInQ,EAAU,GACViQ,EAAU,IAAIC,QAAQ,SAACC,GACzBnQ,EAAQmQ,QAAUA,IAMpB,OAHKrnB,KAAKinB,QAAQlS,EAAI9U,OAAMD,KAAKinB,QAAQlS,EAAI9U,KAAO,IACpDD,KAAKinB,QAAQlS,EAAI9U,KAAKsH,KAAK2P,GAEpBiQ,KAMXxgB,GAAYof,YAAY,QAAS,CAC/Blf,MAAO,WACL7G,KAAKD,GAAKpB,GAAGoB,GAAGwE,IAAI,UACpBvE,KAAKgI,OAAS,IAGhBpG,QAAS,WACP5B,KAAKD,GAAG6B,WAEVolB,aAAc,SAAUlnB,EAAIqK,EAAKjC,GAAO,IAAA4f,EAAA9nB,KAClCA,KAAKgI,OAAOlI,IAAKlB,OAAOuJ,aAAanI,KAAKgI,OAAOlI,IAErDE,KAAKgI,OAAOlI,GAAMlB,OAAOyJ,WAAW,WAClCyf,EAAKpf,UAAU5I,EAAIqK,IAClBjC,GAAS,MAGdQ,UAAW,SAAU5I,EAAIqK,GACnBnK,KAAKgI,OAAOlI,IAAKlB,OAAOuJ,aAAanI,KAAKgI,OAAOlI,IAErD,IAAI8I,EAAS3J,IAAE4J,QAAQsB,GAAQA,EAAMA,EAAI4d,iBACrCC,EAAW,GACf,IAAK,IAAItnB,KAAKkI,EACZof,EAASzgB,KAAKvH,KAAKD,GAAGF,KAAK+I,EAAMlI,GAAIkI,EAAMlI,GAAGZ,KAGhD,OAAOsnB,QAAQpO,IAAIgP,IAGrB9e,UAAW,SAAUiB,EAAKnB,GACxB,IAAIJ,EAAS3J,IAAE4J,QAAQsB,GAAQA,EAAMA,EAAI4d,iBACrCC,EAAW,GAGf,IAAK,IAAItnB,KAFTsI,EAAcA,GAAe,GAEfJ,EACRI,EAAYtI,GACdsnB,EAASzgB,KAAK6f,QAAQC,QAAQre,EAAYtI,KAE1CsnB,EAASzgB,KAAKvH,KAAKD,GAAGc,KAAK+H,EAAMlI,KAIrC,OAAO0mB,QAAQpO,IAAIgP,IAIrB3kB,WAAY,SAAUd,GACpB,OAAOvC,KAAKD,GAAGsD,WAAWd,IAG5BkH,WAAY,SAAUhH,EAAQT,EAAOC,GACnC,OAAOjC,KAAKD,GAAG+B,WAAWW,EAAQT,EAAOC,IAG3CyB,cAAe,SAAUgS,GAAQ,IACzB3T,EAA+C2T,EAA/C3T,SAAU4B,EAAqC+R,EAArC/R,UAAWC,EAA0B8R,EAA1B9R,QAAS5B,EAAiB0T,EAAjB1T,MAAOiC,EAAUyR,EAAVzR,MAE3C,OAAOjE,KAAKD,GAAG2D,cAAc3B,EAAU4B,EAAWC,EAAS5B,EAAOiC,MAKtE0C,GAAYof,YAAY,qBAAsB,CAC5CkC,YAAa,CACXziB,KAAM,kCACNqI,OAAQ,OACRrC,OAAQ,GACRtB,KAAM,CAAEpK,GAAI,QAAS8I,MAAO,QAAS/I,KAAM,QAC3CqoB,UAAW,CAAEC,MAAO,MAGtBC,YAAa,CACX5iB,KAAM,0BACNqI,OAAQ,OACRrC,OAAQ,GACRtB,KAAM,CAAEpK,GAAI,QAAS8I,MAAO,YAIhCjC,GAAYof,YAAY,iBAAkB,CACxClf,MAAO,WACL7G,KAAKqoB,MAAQ,GACbroB,KAAKnB,GAAKinB,GAAKG,MAAMuB,UAIvBc,GAAI,SAAUC,EAAYre,EAAMsB,GAC9B,IACIjG,EADUoB,GAAY6hB,UAAU,sBACfD,GAEjB/iB,EAAOD,EAAOC,KACdpE,EAAOmE,EAAOsI,OAGd7C,EAAS,GACb,IAAK,IAAItK,KAAK6E,EAAO2E,KAAM,CACzB,IAAIwB,EAAOnG,EAAO2E,KAAKxJ,GACnBmJ,EAAM5K,IAAEmB,IAAI8J,EAAMxJ,QACV4J,IAART,GACF5K,IAAE8E,IAAIiH,EAAQU,EAAM7B,GAGxB,OAAO7J,KAAKuE,IAAIiB,EAAMpE,EAAM4J,EAAQQ,IAEtCjH,IAAK,SAAUiB,EAAMpE,EAAM4J,EAAQQ,GAGjC,OAFWxL,KAAKI,IAAIoF,GAERjB,IAAInD,EAAM4J,EAAQQ,IAEhCpL,IAAK,SAAUoF,GASb,OAPIxF,KAAKqoB,MAAM7iB,GACNxF,KAAKqoB,MAAM7iB,GAGXxF,KAAKyoB,WAAWjjB,IAM3BijB,WAAY,SAAUjjB,EAAMsI,GAC1B,IAAIM,EAAQzH,GAAYU,SAAS7B,IACjC4I,EAAQnP,IAAE6F,UAAUsJ,IAEdvH,MAAQlI,GAAGwP,WAAWE,UAG5B,IAAIqa,EAAO,CACTtnB,KAAMoE,EACNA,KAAM4I,EACNN,MAAO,CACLwY,QAAS,OAITxY,GACF7O,IAAEuO,MAAMkb,EAAK5a,MAAOA,GAGtB,IAAIrO,EAAOO,KAAKnB,GAAGonB,MAAM0B,MAAMe,GAI/B,OAFA1oB,KAAKqoB,MAAM7iB,GAAQ/F,EAEZA,KAOXkH,GAAYof,YAAY,YAAa,CACnClf,MAAO,SAAUyH,GACf5M,OAAO4L,OAAOtN,KAAMsO,IAGtBvK,IAAK,SAAUyB,EAAMrG,GACnBF,IAAE8E,IAAI/D,KAAK4E,KAAMY,EAAMrG,IAEzBiB,IAAK,SAAUoF,GACb,OAAOvG,IAAEmB,IAAIJ,KAAK4E,KAAMY,IAE1B+G,QAAS,SAAUnL,EAAMjC,EAAOoL,GAC9B1E,QAAQ6D,IAAI,YAAa,CAAEtI,OAAMjC,QAAOoL,YACxCvK,KAAK+D,IAAI3C,EAAMjC,GACf,IAAIwpB,EAAa3oB,KAAK4E,KAAKgkB,SAASD,WACpChiB,GAAYkiB,aAAaF,GAAY,GAAO,MAIhDhiB,GAAYof,YAAY,qBAAsB,CAC5C+C,KAAM,CACJC,aAAc,CACZxkB,IAAK,SAAU2F,EAAMvB,GACnB,IAAIC,EAAQ,GAEZ5I,KAAKgpB,YAAY9e,EAAKtF,KAAMsF,EAAKlF,IAAK4D,GAEtCD,EAAEQ,QAAQ8B,MAAMf,EAAMtB,EAAOD,IAE/BqgB,YAAa,SAAUpkB,EAAMI,EAAK2D,GAChC,IAAIlJ,EAAOd,GAAG6H,cAAcjC,IAAIS,EAAKJ,GAErC,IAAK,IAAIlE,KAAKkE,EAAK+O,KACjB3T,KAAKgpB,YAAYpkB,EAAK+O,KAAKjT,GAAIsE,EAAK2D,GAItC,OADAA,EAAEpB,KAAK9H,GACAA,IAGXmd,SAAU,CACRrY,IAAK,SAAU2F,EAAMvB,GACnB,IAAIzE,EAASlE,KAAKipB,SAAS/e,EAAMA,EAAKgf,QAAS,CAAEC,WAAW,GAAQ,GAEpE,OADAxgB,EAAEQ,QAAQ8B,MAAMf,EAAMhG,EAAQyE,GACvBzE,GAGT+kB,SAAU,SAAUtgB,EAAG7I,EAAIqN,EAAM2U,GAC/B,IAAInO,EAAOhL,EAAEiK,KAAK9S,GAGdoE,EAAS,CAAEyP,KAAM,GAAIlU,KAFdkJ,EAAEC,MAAM9I,GAEYqN,OAAMnL,MAAO,EAAG8f,SAE/C,IAAKnZ,EAAEygB,UAAYzgB,EAAEygB,SAAWtH,EAC9B,IAAK,IAAIphB,KAAKiT,EACZzP,EAAOyP,KAAKjT,GAAKV,KAAKipB,SAAStgB,EAAGjI,EAAGiT,EAAKjT,GAAIohB,EAAQ,GACtD5d,EAAOlC,QAGX,OAAOkC,OAMfyC,GAAYof,YAAY,yBAA0B,CAChDxY,cAAc,EACdhK,OAAQ,CACN8lB,MAAO,SAAUnf,EAAMvB,GACrB,IAAIxJ,EAAQ+K,EAAKof,cAAgB,GAC7Bpf,EAAKzK,MAAQyK,EAAKzK,KAAK8D,QAAU2G,EAAKzK,KAAK8D,OAAO2G,EAAKmf,SACzDlqB,EAAQ+K,EAAKzK,KAAK8D,OAAO2G,EAAKmf,QAEhC1gB,EAAEQ,QAAQ8B,MAAMf,EAAM/K,EAAOwJ,KAIjCzD,IAAK,CACHA,IAAK,SAAUgF,EAAMvB,GACnB9C,QAAQ6D,IAAI,QACZf,EAAEiC,OAAOrG,IAAI2F,EAAKhF,OAItB2d,MAAO,CACL0G,SAAU,SAAUrf,EAAMvB,GACxB,IAAIzE,EAASvF,GAAGuX,YAAY3R,IAAItF,IAAE6F,UAAUoF,EAAK6B,OACjDpD,EAAEQ,QAAQ8B,MAAMf,EAAMhG,EAAQyE,OAMpChC,GAAYof,YAAY,mBAAoB,CAC1CnhB,KAAM,CACJmH,KAAM,CACJqY,KAAM,8BACNK,MAAO,4BACPhlB,KAAM,6BAGR8jB,QAAS,QACT9jB,KAAM,CACJglB,MAAO,YAIXhY,cAAe,CACb+c,KAAM,CACJ,CAAEpoB,KAAM,QAASyB,KAAM,QAASyC,GAAI,WAAYpE,OAAQ,SAE1D2F,MAAO,CACLgc,MAAO,CAAEzhB,KAAM,QAASyB,KAAM,WAAYuH,MAAO,CAAE2B,KAAM,SACzD7G,IAAK,CAAE9D,KAAM,WAAYyB,KAAM,mBAAoB4mB,QAAS,OAAQrf,MAAO,CAAEyY,MAAO,SAAW5W,KAAM,qBAIzG9C,QAAS,CACPugB,OAAQ,yBACRC,GAAI,CAEFC,MAAO,SAAU1f,EAAMvB,GACrBA,EAAEiC,OAAOrG,IAAI2F,EAAK5E,GAAI4E,EAAK/K,OAAS,GAAI,CACtCsqB,QAAS,CACP,SAAUjkB,EAAMrG,EAAOoL,GACrB1E,QAAQ6D,IAAI,OAAQlE,EAAMrG,MAG7B,CACC+B,OAAQgJ,EAAKhJ,UAGnB2oB,iBAAkB,SAAU3f,EAAMvB,GAChC,IAAI+e,EAAQxd,EAAK+B,KAAKzJ,MAAM,KACxBuJ,EAAO,GACX2b,EAAM/kB,QAAQ,SAAAvB,GACZ2K,EAAK3K,GAAQnC,IAAEmB,IAAI8J,EAAK2Y,MAAOzhB,KAGjC,IAAI8D,EAAM,GAEN4kB,EAAS,GAEb,IAAK,IAAIppB,KAAKqL,EAAM,CAClB,IAAI/G,EAAM+G,EAAKrL,GACX4E,EAAK,CAAEzC,KAAM,SAAUzB,KAAM,KAAM4D,IAAK,KAAMoF,MAAO,IACrDsB,EAAOhL,GAAKwJ,EAAKuf,QAAU,UAAY/oB,EAC3C4E,EAAGlE,KAAOsK,EACVpG,EAAGN,IAAMA,EAET,IAAI0Q,EAAS1Q,EAAID,KAAKkP,WAEtB,IAAK,IAAIvT,KAAKgV,EACZpQ,EAAG8E,MAAM1J,GAAKA,EACdopB,EAAOppB,IAAK,EAGdwE,EAAIqC,KAAKjC,GAGX,IAAK,IAAI5E,KAAKwE,SACL4kB,EAAO5kB,EAAIxE,GAAGU,MAGvByE,QAAQ6D,IAAIogB,GAEZjkB,QAAQ6D,IAAI,MAAOxE,GAEnByD,EAAEiC,OAAO9L,IAAI2N,cAAcvC,EAAK9I,MAAQ8D,EAExCW,QAAQ6D,IAAI,SAAUf,EAAEiC,aAOhCjE,GAAYof,YAAY,6BAA8B,CACpD7gB,IAAK,CACH,CAAE9D,KAAM,UAAWyB,KAAM,cAAeJ,OAAQ,CAAEI,KAAM,QACxD,CAAEzB,KAAM,aAAcyB,KAAM,uBAAwBuH,MAAO,CAAE2f,KAAM,YACnE,CAAE3oB,KAAM,WAAYyB,KAAM,YAAauH,MAAO,CAAEd,IAAK,eACrD,CAAEzG,KAAM,MAAOuH,MAAO,CAAE2f,KAAM,UAAWC,WAAY,aAAcC,GAAI,eAEvE,CAAE7oB,KAAM,aAAcyB,KAAM,yBAA0BuH,MAAO,CAAE8f,SAAU,WAAY5gB,IAAK,YAE1F,CAAEzG,KAAM,cAAeuH,MAAO,CAAExB,MAAO,gBAGzCO,QAAS,CACPugB,OAAQ,yBACRS,IAAK,CACHC,YAAa,SAAUlgB,EAAMvB,GAC3B,IAAIC,EAAQsB,EAAKtB,MACb3E,EAAQ,GAgBH,SAALvE,IAEF,OADAuE,GACa2E,EAAMlG,QAEnB,OAlBO,SAAUvD,GAWjB,OAVW,IAAIioB,QAAQ,SAACC,GACtB1e,EAAEjE,GAAG2lB,gBAAgB9lB,IAAI,OAAQpF,EAAO,CACtCmrB,KAAM,CACJ,SAACnrB,GACC0G,QAAQ6D,IAAI,OAAQvK,GACpBkoB,EAAQloB,SAYT0V,CADKjM,EAAM3E,IACD5D,KAAK,SAAC6D,MACpB7D,KAAKX,GAGVA,IAIF6qB,qBAAsB,SAAUrgB,EAAMvB,GACpC,IAAIW,EAAMY,EAAK6f,KAAKjnB,IAAI,SAAAA,GAAS,MAAO,WAAaA,EAAIhD,KAGzD,OADA6I,EAAEQ,QAAQ8B,MAAMf,EAAMZ,EAAKX,GACpBW,GAGTkhB,uBAAwB,SAAUtgB,EAAMvB,GACtC,IAAIuhB,EAAWhgB,EAAKggB,SAChB5gB,EAAMY,EAAKZ,IAEXV,EAAQ,GAEZ,IAAK,IAAIlI,KAAKwpB,EACPA,EAASxpB,IAAIkI,EAAMrB,KAAK,CAAE4gB,MAAO7e,EAAI5I,GAAGZ,KAI/C6I,EAAEQ,QAAQ8B,MAAMf,EAAMtB,EAAOD,QAQrChC,GAAYof,YAAY,+BAAgC,CACtD7gB,IAAK,CACH,CACE9D,KAAM,cACNyB,KAAM,gBACNd,SAAU,CAAEc,KAAM,eAClBc,UAAW,YACXC,QAAS,OACT5B,MAAO,EACPiC,MAAO,CAAC,YAAa,QACrBgF,OAAQ,SAGV,CAAEpG,KAAM,MAAOuH,MAAO,CAAExB,MAAO,OAAQmhB,KAAM,cAAeU,SAAU,aAEtE,CAAErpB,KAAM,SAAUyB,KAAM,YAAauH,MAAO,CAAED,IAAK,eAAiB6K,MAAO,CAAC,GAAI,eAAgB,OAEhG,CAAE5T,KAAM,WAAY6H,OAAQ,QAASpG,KAAM,YAAauH,MAAO,CAAEd,IAAK,WAGtE,CAAElI,KAAM,OAAQyB,KAAM,cAAeuH,MAAO,CAAEqgB,SAAU,WAAYxe,KAAM,cAAeiZ,KAAM,SAAW5f,GAAI,MAAOpB,OAAQ,YAG/HuI,cAAe,CACbie,KAAM,CACJ,CAAEtpB,KAAM,UAAWyB,KAAM,SAAUuH,MAAO,CAAE3K,KAAM,OAAQkrB,KAAM,OAAQ3lB,IAAK,eAC7E,CAAE5D,KAAM,OAAQyB,KAAM,WAAYuH,MAAO,CAAEwgB,UAAW,mBAIxD9nB,IAAK,CACH,CAAED,KAAM,SACR,CAAEA,KAAM,MAAOuH,MAAO,CAAEqgB,SAAU,WAAYlH,QAAS,aACvD,CAAEniB,KAAM,UAAWyB,KAAM,SAAUuH,MAAO,CAAE3K,KAAM,OAAQuF,IAAK,YAAaue,QAAS,aACrF,CAAEniB,KAAM,WAAYyB,KAAM,cAAeuH,MAAO,CAAExB,MAAO,QAAS+K,KAAM,sBACxE,CAAEvS,KAAM,WAAYyB,KAAM,cAAeuH,MAAO,CAAE6B,KAAM,YAAc3G,GAAI,OAAQpB,OAAQ,YAG5F2C,MAAO,CACL,CAAEzF,KAAM,QAASgJ,MAAO,CAAE2B,KAAM,QAAUlJ,KAAM,cAIpD+B,KAAM,CACJmH,KAAM,CACJ2e,KAAM,4EACN5nB,IAAK,iFAITqG,QAAS,CACP0Z,MAAO,CACL0G,SAAU,SAAUrf,EAAMvB,GACxB,IAAIzE,EAASvF,GAAGuX,YAAY3R,IAAItF,IAAE6F,UAAUoF,EAAK6B,OACjDpD,EAAEQ,QAAQ8B,MAAMf,EAAMhG,EAAQyE,KAGlCwhB,IAAK,CAEH1lB,MAAO,SAAUa,EAAIZ,GACnBmB,QAAQ6D,IAAI,QAAShF,EAAGyG,OAAO0f,SAAUnmB,EAAGQ,MAE9C4lB,YAAa,SAAUxlB,EAAIqD,GACzB,IAAIC,EAAQ,GAEZ,IAAK,IAAIlI,KAAK4E,EAAGqO,KACf/K,EAAMrB,KAAKjC,EAAGsD,MAAMlI,IAGtBkI,EAAM3G,KAAK,SAACmY,EAAGC,GAAJ,OAAUA,EAAE0Q,SAAW3Q,EAAE2Q,WACpCllB,QAAQ6D,IAAI,cAAepE,EAAGqO,KAAM/K,GACpCD,EAAEQ,QAAQ8B,MAAM3F,EAAIsD,EAAOD,IAE7BqiB,SAAU,SAAU1lB,EAAIqD,GACtB,IAAIgiB,EAAOM,KAAO3lB,EAAGslB,WAAWM,UAChCviB,EAAEQ,QAAQ8B,MAAM3F,EAAIqlB,EAAMhiB,IAG5BihB,MAAO,SAAU1f,EAAMvB,GACrB,OAAO,IAAIye,QAAQ,SAACC,EAAS8D,GAE3BtlB,QAAQ6D,IAAI,QAASQ,EAAK2gB,UAE1BliB,EAAEiC,OAAOrG,IAAI2F,EAAK5E,GAAI,GACpB,CACEmkB,QAAS,CACP,SAAUjkB,EAAMrG,EAAOoL,GACrB8c,EAAQloB,MAId,CACEgM,OAAQlM,IAAE6F,UAAUoF,QAK5BkhB,YAAa,SAAUlhB,EAAMvB,GAC3B,IAAIqC,EAAS,GAETiB,EAAO/B,EAAK+B,KAGZvL,GADOwJ,EAAK5E,GAAK4E,EAAK9I,MACjB,IAEA,SAAL1B,IAEF,OADAgB,GACSuL,EAAKvJ,QAAd,CAEA,IAAI2oB,EAAS3pB,OAAO4L,OAAO,GAAIrO,IAAE6F,UAAUoF,GAAO,CAAEzK,KAAMwM,EAAKvL,GAAIuD,MAAOvD,IAE1E,OAAOiI,EAAEQ,QAAQygB,MAAMyB,EAAQ1iB,GAAGtI,KAAK,SAAAlB,GACrC6L,EAAOzD,KAAKpI,KACXkB,KAAKX,KAIVA,GAAKW,KAAK,WACRsI,EAAEQ,QAAQ8B,MAAMf,EAAMc,EAAQrC,MAOlC2iB,UAAW,SAAUhmB,EAAIqD,GAMvB,IALA,IACIqM,EAAQ1P,EAAG0P,MAEX7K,EAAM,CAAC7E,EAAG6E,KAELkG,EAAI,EAAGA,EAAI2E,EAAMtS,OAAQ2N,IAAK,CACrC,IAAI7K,EAAOwP,EAAM3E,GACbzH,EAAQ,GACZ,IAAK,IAAIlI,KAAKyJ,EAAK,CACjB,IAAIhL,OAAK,EAGT,GAFUA,EAANqG,EAAcvG,IAAEmB,IAAI+J,EAAIzJ,GAAI8E,GACnB2E,EAAIzJ,GACN,CACT,IAAImJ,EAAM5K,IAAE8S,SAAS5S,GAASF,IAAE+L,OAAO7L,GAASA,EAChDyJ,EAAQA,EAAMgF,OAAO/D,IAGzBM,EAAMvB,EAGRD,EAAEQ,QAAQ8B,MAAM3F,EAAI6E,EAAKxB,QAMjC/J,OAAOqsB,OAASA,KAEhBtkB,GAAYof,YAAY,oCAAqC,CAC3D7gB,IAAK,CACH,CAAE9D,KAAM,UAAWyB,KAAM,cAAeJ,OAAQ,CAAEI,KAAM,QACxD,CAAEzB,KAAM,aAAcyB,KAAM,uBAAwBuH,MAAO,CAAE2f,KAAM,YACnE,CAAE3oB,KAAM,aAAc0M,MAAO,CAAEyd,YAAa,eAAiB1oB,KAAM,yBAA0BuH,MAAO,CAAE8f,SAAU,WAAY5gB,IAAK,YACjI,CAAElI,KAAM,WAAYyB,KAAM,YAAauH,MAAO,CAAEd,IAAK,eACrD,CAAEzG,KAAM,MAAOuH,MAAO,CAAE8f,SAAU,cAIpC/gB,QAAS,CACPugB,OAAQ,yBACRS,IAAK,CACHI,qBAAsB,SAAUrgB,EAAMvB,GACpC,IAAIW,EAAMY,EAAK6f,KAAKjnB,IAAI,SAAAA,GAAS,MAAO,WAAaA,EAAIhD,KAGzD,OADA6I,EAAEQ,QAAQ8B,MAAMf,EAAMZ,EAAKX,GACpBW,GAGTkhB,uBAAwB,SAAUtgB,EAAMvB,GACtC,IAAIuhB,EAAWhgB,EAAKggB,SAChB5gB,EAAMY,EAAKZ,IAEXV,EAAQ,GACR2iB,EAAc,GAElB,IAAK,IAAI7qB,KAAKwpB,EACPA,EAASxpB,GACT6qB,EAAYhkB,KAAK2iB,EAASxpB,IADbkI,EAAMrB,KAAK,CAAE4gB,MAAO7e,EAAI5I,GAAGZ,KAG/C+F,QAAQ6D,IAAI,wBAAyB,CAAEugB,GAAIrhB,EAAO4iB,GAAID,IACtD5iB,EAAEQ,QAAQ8B,MAAMf,EAAMtB,EAAOD,QAOrChC,GAAYof,YAAY,kCAAmC,CACzDnhB,KAAM,CACJujB,MAAO,QAEPpc,KAAM,CACJ/M,IAAK,CACHuO,cAAc,EACdke,QAAS,CACPC,eAAgB,eAChBnpB,KAAM,SACNzC,GAAI,kBACJiD,MAAO,UACP4oB,QAAS,YACT9oB,KAAM,cACN+oB,UAAW,kBAMnBxnB,EAAG,CAAEkkB,GAAI,WAAYthB,GAAI,GAAI6kB,IAAK,CAAEpsB,KAAM,QAAU4pB,MAAO,UAAWC,aAAc,IAEpFpkB,IAAK,CACH,CAAErC,KAAM,MAAOuH,MAAO,CAAEqf,QAAS,eACjC,CAAEroB,KAAM,OAAQ6H,OAAQ,QAASmB,MAAO,CAAEtK,GAAI,SAAW+C,KAAM,YAC/D,CAAEzB,KAAM,OAAQ6H,OAAQ,QAASmB,MAAO,CAAEd,IAAK,qBAAuBzG,KAAM,aAC5E,CAAEzB,KAAM,SAAU0M,MAAO,CAAEvF,KAAM,aAAe1F,KAAM,gBAAiBuH,MAAO,CAAEma,KAAM,OAAQ3b,MAAO,QAAU5G,MAAO,GACtH,CAAEZ,KAAM,UAAWyB,KAAM,QAASuH,MAAO,CAAE3K,KAAM,QAAU4pB,MAAO,UAAWC,aAAc,IAC3F,CAAEloB,KAAM,aAAcyB,KAAM,SAAUuH,MAAO,CAAE7H,KAAM,YAAayC,IAAK,oBAAqB8mB,WAAY,SAAU/oB,MAAO,UAGzH,CAAEF,KAAM,KAAMuH,MAAO,CAAE1K,GAAI,OAAQD,KAAM,gBAG3CiN,YAAa,CACXyb,MAAS,CACPviB,MAAO,sCACPsI,MAAO,CACLrO,KAAM,CAAEV,MAAO,SAACA,SAKtBsN,cAAe,CACb5F,MAAO,CACL,CAAEzF,KAAM,QAASgJ,MAAO,CAAE2B,KAAM,QAAUlJ,KAAM,aAGlDK,KAAM,CACJ,CAAEL,KAAM,MAAOuH,MAAO,CAAEqf,QAAS,eAEjC,CAAEroB,KAAM,sBAAuByB,KAAM,cAAeuH,MAAO,CAAEma,KAAM,OAAQplB,MAAO,cAItFgK,QAAS,CACP4iB,OAAQ,yBACRnjB,MAAO,CACLojB,cAAe,SAAU9hB,EAAMvB,GAC7B,IAAIC,EAAQsB,EAAKtB,MACjBA,EAAM3G,KAAK,SAACmY,EAAGC,GAAJ,OAAUA,EAAE0Q,SAAW3Q,EAAE2Q,WACpC,IAEIxiB,EAFA0jB,EAASrjB,EAAMiV,MAAM,EAAG3T,EAAKlI,OAI/BuG,EADE0jB,EAAOvpB,OAAS,EACXupB,EAAO,GAAGlB,SAEP7gB,EAAKqa,KAAK2H,UAElBhiB,EAAK4D,MAAMvF,MACbI,EAAEQ,QAAQ8B,MAAM,CAAE3E,IAAK4D,EAAK4D,MAAMvF,MAAQA,EAAMI,GAElD,IAAImjB,EAAa,GACjB,IAAK,IAAIprB,KAAKurB,EACZH,EAAWG,EAAOvrB,GAAGZ,IAAM,CAAEA,GAAImsB,EAAOvrB,GAAGZ,GAAIqsB,SAAUzrB,GAE3DiI,EAAEQ,QAAQ8B,MAAMf,EAAM4hB,EAAYnjB,QAU1ChC,GAAYof,YAAY,0BAA2B,CACjDnhB,KAAM,CACJujB,MAAO,QAEPpc,KAAM,CACJyd,KAAM,wDAGVtkB,IAAK,CAEH,CAAE9D,KAAM,OAAQ6H,OAAQ,QAASmB,MAAO,CAAEtK,GAAI,SAAW+C,KAAM,YAC/D,CAAEzB,KAAM,OAAQ6H,OAAQ,QAASmB,MAAO,CAAEd,IAAK,qBAAuBzG,KAAM,aAC5E,CAAEA,KAAM,MAAOuH,MAAO,CAAExB,MAAO,QAASkU,MAAO,UAC/C,CAAEja,KAAM,SAAUzB,KAAM,QAASgJ,MAAO,CAAEpF,IAAK,aAAc8X,MAAO,UACpE,CAAEja,KAAM,cAAezB,KAAM,QAASgJ,MAAO,CAAEgiB,GAAI,OAAQlD,QAAS,UAAWtgB,MAAO,QAAS+K,KAAM,kBACrG,CAAE9Q,KAAM,aAAczB,KAAM,YAG9BsL,YAAa,CACXyb,MAAS,CACPviB,MAAO,wBACPsI,MAAO,CACLrO,KAAM,CAAEV,MAAO,SAACA,SAKtBsN,cAAe,CACb5F,MAAO,CACL,CAAEzF,KAAM,QAASgJ,MAAO,CAAE2B,KAAM,QAAUlJ,KAAM,cAGpDsG,QAAS,CACP4iB,OAAQ,yBACRnjB,MAAO,CAELyjB,WAAY,SAAU/mB,EAAIqD,GAExB,IAAIQ,EAAUxK,GAAGqiB,MAAM5gB,IAAI,KAAM2gB,GAAM,CACrCM,aAAc,CACZiL,OAAQ,YAKZ3jB,EAAEQ,QAAQ8B,MAAM3F,EAAI6D,EAASR,IAE/B4jB,SAAU,SAAUjnB,EAAIqD,GACtB,IAAImU,EAAQ,CACVW,MAAO,GACPiB,MAAO,KAEA,SAALhf,EAAeI,EAAI0sB,EAAa1K,GAClC,KAAIA,EAAQ,GAAZ,CACA,IAAI7d,EAAQ6Y,EAAMW,MAAMlW,KAAK,CAAEnG,KAAMkE,EAAGsD,MAAM9I,GAAIyC,KAAMmb,OAAQlc,KAAKyO,IAAI,EAAG,GAAa,GAAR6R,KAAiB,EAIlG,IAAK,IAAIphB,KAFW,OAAhB8rB,GACF1P,EAAM4B,MAAMnX,KAAK,CAAEkE,OAAQxH,EAAOkb,OAAQqN,EAAartB,MAAO,IAClDmG,EAAGqO,KAAK7T,GACpBJ,EAAGgB,EAAGuD,EAAO6d,EAAQ,IAIzBpiB,CAAG4F,EAAG4jB,QAAS,KAAM,GAErBrjB,QAAQ6D,IAAK,QAASoT,GACtBnU,EAAEQ,QAAQ8B,MAAM3F,EAAIwX,EAAOnU,IAE7B8jB,YAAa,SAAUnnB,EAAIqD,GACzB,IAAImU,EAAQ,CACVW,MAAO,GACPgC,MAAO,KAEA,SAAL/f,EAAeI,EAAI0sB,EAAa1K,EAAO7e,GAE5B6Z,EAAMW,MAAM/a,OAAzB,IACIuB,EAAQ6Y,EAAMW,MAAMlW,KAAK,CAAEzH,GAAIA,EAAI4sB,MAAOpnB,EAAGsD,MAAM9I,GAAIyC,OAI3D,IAAK,IAAI7B,KAFW,OAAhB8rB,GACF1P,EAAM2C,MAAMlY,KAAK,CAAEolB,GAAI7sB,EAAI8sB,KAAM3pB,IACrBqC,EAAGqO,KAAK7T,GACpBJ,EAAGgB,EAAGuD,EAAO6d,EAAQ,EAAGhiB,GAI5BJ,CAAG4F,EAAG4jB,QAAS,KAAM,GAErBpM,EAAMlO,KAAO,EACbjG,EAAEQ,QAAQ8B,MAAM3F,EAAIwX,EAAOnU,QAanC,IAAIoY,GAAO,CAET8L,YAAa,SAAU/sB,GACrB6G,GAAYmmB,YAAY,2BAA4B,SAAU,CAAEhtB,GAAIA,IACpE6G,GAAY5C,IAAI,4BAA6B,4BAC7C4C,GAAYkiB,aAAa,wBAAwB,GAAO,IAI1DkE,QAAS,WACP,IAAIC,EAAcrmB,GAAYU,SAAS,6BAEvC2lB,EAA8B,sBAAhBA,EAAsC,MAAQ,SAE5DhtB,KAAKitB,SAASD,IAIhBE,WAAY,SAAUjmB,GACF,KAAdA,EAAIkmB,QAERC,GAAKC,QACL1mB,GAAY5C,IAAI,wBAAyB,CAAExB,KAAM,KACjD6qB,GAAKE,YAEPvpB,IAAK,SAAUyB,EAAMrG,GACnBwH,GAAY5C,IAAIyB,EAAMrG,IAExBouB,WAAY,WACV,IAAIhrB,EAAOoE,GAAYU,SAAS,yBAC5BpI,IAAEoL,SAAS9H,IACb6qB,GAAKI,MAAMjrB,IAGf+pB,OAAQ,SAAUxsB,GAChB+F,QAAQ6D,IAAI,YAAa5J,GACzBstB,GAAKjM,OAAO,CAAEne,OAAQlD,IACtB6G,GAAY5C,IAAI,wBAAyBjE,GAEzCiH,IAAE,UAAU0mB,QAEZ3H,GAAK4H,mBAAmBtN,IAAI,2BAG9BuN,SAAU,SAAU7tB,GAIlB,OAHA6G,GAAY5C,IAAI,8BAA+BjE,GAE/CE,KAAKitB,SAAS,SACP,GAGTA,SAAU,SAAUntB,GAClB,IAMI0F,EANQ,CACVooB,OAAQ,uBACR9qB,IAAK,oBACLqK,KAAM,2BAGSrN,GAEP,UAANA,GACFgmB,GAAK+H,aAAaC,aAGpBnnB,GAAY5C,IAAI,4BAA6ByB,IAI/CuoB,UAAW,SAAUjuB,GACnB+F,QAAQ6D,IAAI,gBAAiB5J,GAC7BgmB,GAAKkI,QAAQC,QAAQnuB,GACrBE,KAAKitB,SAAS,SAIlBtmB,GAAYQ,WAAW,wBAAyB,MAAO,CACrD5C,IAAKwc,GAAKwM,aAIZ5mB,GAAYof,YAAY,UAAW,CACjClf,MAAO,aAIPqnB,OAAQ,WACN,OAAOvnB,GAAYU,SAAS,cAE9BtD,IAAK,SAAUyB,EAAMrG,GACnBwH,GAAY5C,IAAI,CAAC,YAAayB,GAAMC,KAAK,KAAMtG,IAEjDgvB,SAAU,WACRnuB,KAAK+D,IAAI,aAAa,IAExBqqB,SAAU,WACRpuB,KAAK+D,IAAI,aAAa,IAGxBsqB,WAAY,eAKd1nB,GAAYof,YAAY,UAAW,CACjC9d,MAAO,WACLjI,KAAK+H,OAAS,CACZ0J,KAAM,CAAEC,WAAW,IAAIpQ,MAAOC,aAIlCisB,MAAO,SAAUpjB,GACY,GAAvBA,EAAMoN,QAAQ,OAGhBxX,KAAK+H,OAAO0J,KAAK6c,YAAa,EAC9BtuB,KAAK+H,OAAO0J,KAAK8c,SAAU,IAG3BvuB,KAAK+H,OAAO0J,KAAK6c,YAAa,EAC9BtuB,KAAK+H,OAAO0J,KAAK8c,SAAU,GAG7B,IAAIrqB,EAASkG,EAAMwP,MAAM,mBACrBrX,EAAO6H,EAAMokB,OAAOtqB,EAAO,GAAGxB,QACvBwB,EAAO,GAAGkU,OAAO5V,MAAM,KAE7BxC,KAAK+H,OAAO0J,KAAKgd,gBAAezuB,KAAK+H,OAAO0J,KAAKid,aAAc,IAAIptB,MAAOC,WAE/EvB,KAAK+H,OAAO0J,KAAKlP,KAAOA,GAG1B8qB,MAAO,WAEGrtB,KAAK+H,OAAOxF,KACdujB,GAAK6I,YAAY7d,QAER9Q,KAAK+H,OAAO0J,KAAKC,UACf1R,KAAK+H,OAAO0J,KAAKid,aACrB,IAAIptB,MAAOC,UAIXvB,KAAK4uB,eAKtB,IAAIxB,GAAO,CAETnlB,MAAO,WACLjI,KAAK+H,OAAS,CACZ0J,KAAM,GACNtI,QAASnJ,KAAKwpB,KACdhH,OAAQxiB,KAAKwiB,SAIjB8K,QAAS,WACP,IAAIuB,EAAW7uB,KAAK+H,OAAO0J,KAC3BzR,KAAK+H,OAAS,CACZ0J,KAAM,CACJzO,OAAQ6rB,EAAS7rB,QAEnBkpB,WAAW,IAAI5qB,MAAOC,UACtB4H,QAASnJ,KAAKwpB,KACdhH,OAAQxiB,KAAKwiB,SAIjBgL,MAAO,SAAUjrB,GACfvC,KAAK+H,OAAOya,OAAOgL,MAAMxtB,KAAK+H,OAAQxF,IAGxC4e,OAAQ,SAAUnW,GAChBhL,KAAK+H,OAAOoB,QAAQgY,OAAOnhB,KAAK+H,OAAQiD,IAG1CqiB,MAAO,WACLrtB,KAAK+H,OAAOoB,QAAQkkB,MAAMrtB,KAAK+H,SAGjCya,OAAQ,CACNgL,MAAO,SAAUzlB,EAAQxF,GACvBwF,EAAOoB,QAAQgY,OAAOpZ,EAAQ,CAAExF,KAAMA,EAAM6B,EAAG7B,EAAKisB,OAAO,OAI/DhF,KAAM,CACJ6D,MAAO,SAAUtlB,GACf,GAAwB,WAApBA,EAAO0J,KAAKlP,KAIX,GAAsC,GAAlCwF,EAAO0J,KAAKlP,KAAKiV,QAAQ,MAK7B,GAAuC,GAAnCzP,EAAO0J,KAAKlP,KAAKiV,QAAQ,OAQ7B,GAAsC,GAAlCzP,EAAO0J,KAAKlP,KAAKiV,QAAQ,MAI7B,GAAsC,GAAlCzP,EAAO0J,KAAKlP,KAAKiV,QAAQ,MAA7B,CAIA,GAAsC,GAAlCzP,EAAO0J,KAAKlP,KAAKiV,QAAQ,MAAY,CAC5C,IAAIjV,EAAOwF,EAAO0J,KAAKlP,KAAKisB,OAAO,GAAGpW,OAElCpV,EADO2D,GAAY6hB,UAAU,aACf1oB,GAElBiI,EAAO0J,KAAKlP,KAAOA,EACnBwF,EAAO0J,KAAKzO,OAASA,EACrB+E,EAAO0J,KAAKqd,YAAa,EAG3B9uB,KAAKogB,IAAIrY,GAET+d,GAAK4H,mBAAmBtN,IAAI,uBAf1BpgB,KAAK+uB,QAAQ,CAAExsB,KAAMwF,EAAO0J,KAAKlP,KAAKisB,OAAO,GAAGpW,QAAUrQ,QAJjD/H,KAAKgvB,WAAW,CAAEzsB,KAAMwF,EAAO0J,KAAKlP,KAAKisB,OAAO,GAAGpW,QAAUrQ,OATnE,CACH,IAAIjI,EAAKiI,EAAO0J,KAAKzO,OACrB,IAAKlD,EAAI,OAGTihB,GAAK4M,SAAS7tB,OAVX,CACH,IAAIA,EAAKE,KAAKivB,UAAUlnB,EAAO0J,KAAKlP,KAAKisB,OAAO,GAAGpW,QACnD2I,GAAKgN,UAAUjuB,QALfgmB,GAAK/lB,GAAG6B,WAsCZuf,OAAQ,SAAUpZ,EAAQiD,GACxB/L,IAAEuO,MAAMzF,EAAO0J,KAAMzG,IAGvBikB,UAAW,SAAU7tB,GACnB,IAAItB,EAAKgmB,GAAK6I,YAAY7d,QACtBoe,EAAM,CACRpvB,GAAIA,EACJyC,KAAMnB,EACN8qB,UAAWpG,GAAK6I,YAAYptB,UAC5BsB,KAAM,MAEN+P,KAAM,CACJmC,IAAK,GACLoa,QAAS,IAEXpsB,MAAOjD,EACPmD,SAAUnD,GAMZ,OAHAgmB,GAAKkI,QAAQjd,UAAUme,EAAIpvB,GAAIovB,GAC/BvoB,GAAY5C,IAAI,cAAgBmrB,EAAIpvB,GAAIovB,GAEjCA,EAAIpvB,IAGbkvB,WAAY,SAAU7N,EAAQpZ,GAC5B,IAAIjI,EAAKiI,EAAO0J,KAAKzO,OACrB,GAAKlD,EAAL,CAEA,IAAIovB,EAAMvoB,GAAY6hB,UAAU,cAAgB1oB,GAEhDb,IAAEuO,MAAM0hB,EAAK/N,GAER+N,EAAIE,UAASF,EAAIE,QAAU,IAChCF,EAAIE,QAAQ7nB,KAAK,CAAE8nB,SAAU/tB,KAAKguB,QAElCxJ,GAAKkI,QAAQjd,UAAUjR,EAAIovB,GAC3BvoB,GAAY5C,IAAI,cAAgBjE,EAAIovB,KAItCH,QAAS,SAAUxsB,EAAMwF,GAEvB,IAAI/E,EAAS+E,EAAO0J,KAAKzO,OACrBuhB,EAAO5d,GAAY6hB,UAAU,aAEjC,GAAKxlB,EAAL,CAIA,IAAIlD,EAAKgmB,GAAK6I,YAAY7d,QAEtBoe,EAAM,CACR3sB,KAAMA,EACNzC,GAAIA,EACJosB,UAAWnkB,EAAOmkB,UAClBnB,UAAU,IAAIzpB,MAAOC,UACrBwB,MAAOwhB,EAAKzkB,GACZmD,SAAUD,EACVmR,SAAUrU,EACV+C,KAAM,QAGRgD,QAAQ6D,IAAI,iBAAkB1G,GAE9B8iB,GAAKkI,QAAQjd,UAAU/N,EAAQ,CAAEusB,SAAS,IAC1CzJ,GAAKkI,QAAQjd,UAAUjR,EAAIovB,GAC3BpJ,GAAKkI,QAAQwB,UAAUvwB,IAAE8E,IAAI,GAAI,aAAef,EAAS,IAAMlD,EAAI,CAAEA,GAAIA,EAAIkD,OAAQA,KAErF2D,GAAYkiB,aAAa,cAAc,GAAO,GAAM,GACpDliB,GAAYkiB,aAAa,aAAa,GAAO,KAQ/CzI,IAAK,SAAUrY,GAEb,IAAI/E,EAAS+E,EAAO0J,KAAKzO,OACrBuhB,EAAO5d,GAAY6hB,UAAU,aAE5BxlB,IACHA,EAASuhB,EAAKzkB,IAGJ6G,GAAY6hB,UAAU,cAC5BvnB,SAEN,IAAInB,EAAKgmB,GAAK6I,YAAY7d,QAEtBoe,EAAM,CACR3sB,KAAMwF,EAAO0J,KAAKlP,KAClBzC,GAAIA,EACJosB,UAAWnkB,EAAOmkB,UAClBnB,UAAU,IAAIzpB,MAAOC,UACrBwB,MAAOwhB,EAAKzkB,GACZmD,SAAUD,GAUZ8iB,GAAKkI,QAAQjd,UAAUjR,EAAIovB,GAC3BpJ,GAAKkI,QAAQwB,UAAUvwB,IAAE8E,IAAI,GAAI,YAAcf,EAAS,IAAMlD,EAAI,CAAEA,GAAIA,EAAIkD,OAAQA,KACpF8iB,GAAKkI,QAAQwB,UAAUvwB,IAAE8E,IAAI,GAAI,gBAAkBjE,EAAI,CAAEA,GAAIA,EAAIkD,OAAQA,KAEzE2D,GAAYkiB,aAAa,cAAc,GAAO,GAAM,GACpDliB,GAAYkiB,aAAa,aAAa,GAAO,GASzC9gB,EAAO0J,KAAKqd,WACd/N,GAAKuL,OAAOxsB,GAETihB,GAAKuL,OAAOtpB,MAIvBoqB,GAAKnlB,QAMLtB,GAAYof,YAAY,iBAAkB,CACxCllB,KAAM,SAAUf,GAAI,IAAA2vB,EAAAzvB,KACd0vB,EAAW,CAAC5vB,EAAI,QAAUA,GAC9BE,KAAK0E,GAAG3E,GAAGmJ,UAAUwmB,GAClBrvB,KAAK,SAAAuI,GACJ,IAAK,IAAIlI,KAAKkI,EAAO,CACRA,EAAMlI,KAEjB+uB,EAAK1nB,OAAOa,MAAMA,EAAMlI,GAAGZ,IAAM8I,EAAMlI,IAErCkI,EAAM,KACR6mB,EAAK1nB,OAAOwc,KAAO3b,EAAM,MAE5BvI,KAAK,WACJ,IAAIkkB,EAAOkL,EAAK1nB,OAAOwc,KACnBoL,EAAU1wB,IAAEmB,IAAImkB,EAAM,iBAAmB,GACzCjb,EAAM5H,OAAO6H,KAAKomB,GACtB,OAAOF,EAAK/qB,GAAG3E,GAAGmJ,UAAUI,KAE7BjJ,KAAK,SAAAuI,GACJ,IAAK,IAAIlI,KAAKkI,EAAO,CACnB,IAAInJ,EAAOmJ,EAAMlI,GACZjB,IACLgwB,EAAK1nB,OAAOa,MAAMnJ,EAAKK,IAAML,MAGhCY,KAAK,WACJsG,GAAY5C,IAAI,aAAc0rB,EAAK1nB,OAAOa,OAC1CjC,GAAY5C,IAAI,YAAa0rB,EAAK1nB,OAAOwc,WASjD5d,GAAYof,YAAY,oBAAqB,CAC3Clf,MAAO,SAAUyH,GACfrP,IAAEuO,MAAMxN,KAAMsO,IAGhBwf,WAAY,WACV,IAAIllB,EAAQ,CACVgnB,IAAK,CACHC,OAAO,EACPttB,KAAM,MACNzC,GAAI,OAENgwB,OAAQ,CACND,OAAO,EACPttB,KAAM,SACNzC,GAAI,UAENkZ,IAAK,CACH6W,OAAO,EACPttB,KAAM,MACNzC,GAAI,OAGNykB,KAAM,CACJsL,OAAO,EACPttB,KAAM,GACNzC,GAAI,SAGJ8S,EAAO,CACTmC,IAAK,CACHwP,KAAM,CAAEqL,KAAK,EAAME,QAAQ,EAAM9W,KAAK,GACtC4W,IAAK,GACLE,OAAQ,GACR9W,IAAK,KAITpQ,EAAM2b,KAAK3R,KAAOA,EAElB5S,KAAK0E,GAAG3E,GAAG0J,WAAW,CAAE5G,KAAM,OAAS,GAAI,eACxCxC,KAAK,SAAA6D,GACJ,IAAK,IAAIxD,KAAKwD,EAAOC,KAAM,CACzB,IAAI1E,EAAOyE,EAAOC,KAAKzD,GAClBjB,EAAK0P,QAAO1P,EAAK0P,MAAQxQ,GAAGwQ,MAAMH,SAASvP,EAAKK,GAAKL,EAAKysB,YAE/DtjB,EAAMnJ,EAAKK,IAAML,GAEe,GAA5BA,EAAK8C,KAAKiV,QAAQ,QACpB5E,EAAKmC,IAAI6a,IAAInwB,EAAKK,KAAM,GAGtBL,EAAKysB,YACPtZ,EAAKmC,IAAI+a,OAAOrwB,EAAKK,IAAM,CAAEyI,KAAM9I,EAAKysB,YAG1CtZ,EAAKmC,IAAIiE,IAAIvZ,EAAKK,KAAM,KAG3BO,KAAK,WAEJsG,GAAYof,YAAY,aAAc,CACpCnd,MAAOA,EACP2b,KAAM3b,EAAM2b,YAOtB5d,GAAYof,YAAY,oBAAqB,CAC3Clf,MAAO,SAAUyH,GACfrP,IAAEuO,MAAMxN,KAAMsO,IAGhBhL,OAAQ,WACN,IAAIsF,EAAQ,GAGRgK,EAAO,CACTmC,IAAK,CACHwP,KAAM,CAAEqL,KAAK,EAAME,QAAQ,EAAM9W,KAAK,GACtC4W,IAAK,GACLE,OAAQ,GACR9W,IAAK,KAITpQ,EAAM2b,KAAK3R,KAAOA,EAElB5S,KAAK0E,GAAG3E,GAAG0J,WAAW,CAAE5G,KAAM,OAAS,GAAI,eACxCxC,KAAK,SAAA6D,GACJ,IAAK,IAAIxD,KAAKwD,EAAOC,KAAM,CACzB,IAAI1E,EAAOyE,EAAOC,KAAKzD,GAClBjB,EAAK0P,QAAO1P,EAAK0P,MAAQxQ,GAAGwQ,MAAMH,SAASvP,EAAKK,GAAKL,EAAKysB,YAE/DtjB,EAAMnJ,EAAKK,IAAML,GAEe,GAA5BA,EAAK8C,KAAKiV,QAAQ,QACpB5E,EAAKmC,IAAI6a,IAAInwB,EAAKK,KAAM,GAGtBL,EAAKysB,YACPtZ,EAAKmC,IAAI+a,OAAOrwB,EAAKK,IAAM,CAAEyI,KAAM9I,EAAKysB,YAG1CtZ,EAAKmC,IAAIiE,IAAIvZ,EAAKK,KAAM,KAG3BO,KAAK,WAEJsG,GAAYof,YAAY,aAAc,CACpCnd,MAAOA,EACP2b,KAAM3b,EAAM2b,YAMtB5d,GAAYof,YAAY,aAAc,CACpClf,MAAO,SAAUqD,GAkBf,OAjBAlK,KAAK+H,OAAS,CACZa,MAAO,GACP2b,KAAM,CACJzkB,GAAI,OACJyC,KAAM,UACNqQ,KAAM,CAAEmC,IAAK,IACblS,KAAM,MACNgtB,OAAO,GAET5e,QAAS,GACTjQ,MAAO,CAAEC,OAAQ,IAGnBjB,KAAK+H,OAAOa,MAAMmnB,KAAO/vB,KAAK+H,OAAOwc,KAErCtlB,IAAEuO,MAAMxN,KAAMkK,GAEPlK,MAETiuB,QAAS,SAAUnuB,GAAI,IAAAkwB,EAAAhwB,KAEjB0vB,EAAW,CAAC5vB,EAAI,QAAUA,GAE1BykB,EAAO5d,GAAY6hB,UAAU,aAE7BvgB,EAAQmf,QAAQC,UAEhB9C,EAAKzkB,KAAOA,IACTykB,EAAKsL,QACR5nB,EAAQA,EAAM5H,KAAK,kBAAM2vB,EAAKtnB,eAGhCT,EAAQA,EAAM5H,KAAK,WACjB2vB,EAAKjoB,OAAOa,MAAQ,GACpBonB,EAAKjoB,OAAOwc,KAAO,CACjBzkB,GAAIA,EACJ+vB,OAAO,EACPjd,KAAM,CAAEmC,IAAK,KAEfib,EAAKjoB,OAAOa,MAAM9I,GAAMkwB,EAAKjoB,OAAOwc,KACpC5d,GAAY5C,IAAI,aAAcisB,EAAKjoB,OAAOa,OAC1CjC,GAAY5C,IAAI,YAAaisB,EAAKjoB,OAAOwc,SAI7Ctc,EAAM5H,KAAK,kBAAM2vB,EAAKtrB,GAAG3E,GAAGmJ,UAAUwmB,KACnCrvB,KAAK,SAAAuI,GACJ,IAAK,IAAIlI,KAAKkI,EAAO,CACRA,EAAMlI,KAEjBsvB,EAAKjoB,OAAOa,MAAMA,EAAMlI,GAAGZ,IAAM8I,EAAMlI,IAEzC,GAAIkI,EAAM,GAAI,CACZ,IAAInJ,EAAOmJ,EAAM,GACjBonB,EAAKjoB,OAAOwc,KAAO9kB,EACMA,EAAK0P,MAAQxQ,GAAGwQ,MAAMH,SAASvP,EAAKK,GAAKL,EAAKysB,WAEvE,IAAI+D,EAAY,CACdC,KAAMvxB,GAAGwQ,MAAMwB,QAAQlR,EAAKK,GAAKL,EAAKysB,UAAW,GAAI,IAErCvtB,GAAGuX,YAAY3R,IAAI0rB,GACrCtpB,GAAYof,YAAY,YAAakK,MAIxC5vB,KAAK,WACJ,IAAIkkB,EAAOyL,EAAKjoB,OAAOwc,KACnBoL,EAAU1wB,IAAEmB,IAAImkB,EAAM,iBAAmB,GACzCjb,EAAM5H,OAAO6H,KAAKomB,GACtB,OAAOK,EAAKtrB,GAAG3E,GAAGmJ,UAAUI,KAE7BjJ,KAAK,SAAAuI,GACJ,IAAK,IAAIlI,KAAKkI,EAAO,CACnB,IAAInJ,EAAOmJ,EAAMlI,GACZjB,IACLuwB,EAAKjoB,OAAOa,MAAMnJ,EAAKK,IAAML,MAGhCY,KAAK,WACJsG,GAAY5C,IAAI,aAAcisB,EAAKjoB,OAAOa,OAC1CjC,GAAY5C,IAAI,YAAaisB,EAAKjoB,OAAOwc,SAM/CwD,eAAgB,WACd,IAAI9W,EAAUjR,KAAK+H,OAAOkJ,QAC1BjR,KAAK+H,OAAOkJ,QAAU,GAEtB,IAAIrI,EAAQ,GACZ,IAAK,IAAIlI,KAAKuQ,EACRjR,KAAK+H,OAAOa,MAAMlI,GAAGmvB,OACzBjnB,EAAMrB,KAAKvH,KAAK+H,OAAOa,MAAMlI,IAE/B,OAAOkI,GAETF,UAAW,WACT,IAAIE,EAAQ5I,KAAK+nB,iBACjB,OAAO/nB,KAAK0E,GAAG3E,GAAG2I,UAAU1I,KAAKC,IAAK2I,IAExCunB,WAAY,WACV,OAAOnwB,KAAK0E,GAAG1D,MAAM8P,SAEvBC,UAAW,SAAUjR,EAAIX,EAAOixB,GAY9B,OAXKtwB,IAAIA,EAAKE,KAAKmwB,cACdnwB,KAAK+H,OAAOa,MAAM9I,KACrBE,KAAK+H,OAAOa,MAAM9I,GAAM,CAAEA,GAAIA,EAAI4R,WAAW,IAAIpQ,MAAOC,YAE1DtC,IAAEuO,MAAMxN,KAAK+H,OAAOa,MAAM9I,GAAKX,GAC/Ba,KAAK+H,OAAOa,MAAM9I,GAAIsjB,MAAQ,OAEzBgN,GACHpwB,KAAKioB,cAEPjoB,KAAKqwB,cAAcvwB,GACZA,GAET0vB,UAAW,SAAUrwB,GACnBa,KAAK+Q,UAAU/Q,KAAK+H,OAAOwc,KAAKzkB,GAAIX,IAUtC8oB,YAAa,WAAY,IAAAqI,EAAAtwB,KAEnBA,KAAKuwB,cAAc3xB,OAAOuJ,aAAanI,KAAKuwB,cAEhDvwB,KAAKuwB,aAAe3xB,OAAOyJ,WAAW,WAEpCyd,GAAK0K,KAAKlI,GAAG,cAAe,CAC1BxoB,GAAIwwB,EAAKvoB,OAAOwc,KAAKzkB,GACrB8I,MAAO0nB,EAAKvoB,OAAOa,MACnB/I,KAAM,SAACV,GACLmxB,EAAKvf,UAAU5R,EAAMM,KAAKK,GAAIX,EAAMM,MAAM,aAKvC6wB,EAAKC,cACX,IAGLF,cAAe,SAAUvwB,GACvBE,KAAK+H,OAAOkJ,QAAQnR,IAAM,EAC1BE,KAAK0E,GAAG3E,GAAGinB,aAAahnB,KAAKC,IAAKD,KAAM,MAG1CywB,OAAQ,SAAUC,EAAKtW,EAAGC,EAAGlb,GAC3BF,IAAE8E,IAAI/D,KAAK+H,OAAOwc,KAAM,CAAC,OAAQmM,EAAKtW,EAAGC,GAAIlb,GAC7Ca,KAAKqwB,cAAcrwB,KAAK+H,OAAOwc,KAAKzkB,OAIxC6G,GAAYof,YAAY,OAAQ,CAC9Bnd,MAAO,GACP2b,KAAM,CACJzkB,GAAI,OACJyC,KAAM,UACNqQ,KAAM,CAAEmC,IAAK,KAEf/T,MAAO,CACLC,OAAQ,KAKZ0F,GAAYof,YAAY,gBAAiB,CACvCC,OAAQ,CACN5lB,IAAK,SAAUsE,GAEb,OADY/F,GAAGuX,YAAY3R,IAAIvE,KAAK+L,OAGtCA,KAAM,CACJ0Y,MAAK,kCACLhlB,KAAI,qEACJkxB,QAAS,CACPT,KAAMvxB,GAAGwQ,MAAMwB,QAAQ+Q,IAAMC,QAAQC,cAAe,GAAI,GAExDgP,MAAK,+1GAkHLnM,MAAK,6PAQP3hB,IAAK,CACH+tB,MAAO,+IACPpxB,KAAM,mHACNqxB,MAAO,oHACPC,MAAK,8GACL3M,KAAI,mIAEJ4M,OAAQ,uDACR7jB,KAAM,2DAIR8jB,OAAQ,uCAERC,YAAW,0BACXN,MAAO,+BAEPO,SAAU,OAOhBxqB,GAAYof,YAAY,cAAe,CACrCtI,MAAO,CACLuI,OAAQ,CACN5lB,IAAK,SAAUsE,EAAIiE,GACjBjE,EAAGiQ,MAAM,CACPyc,QAAS,eACTxoB,MAAO,aACP2b,KAAM,YACNW,KAAM,OACNrC,MAAO,gBACPoN,UAAW,aACVtnB,GAEHA,EAAE0oB,KAAO3vB,OAAOsJ,OAAOrC,EAAEC,OAuBzB,OAnBAD,EAAE/D,KAAO,GACT+D,EAAEQ,QAAUxK,GAAGqiB,MAAM5gB,IAAIsE,EAAIqc,GAAM,CAAEK,QAAS,CAAEyL,YAAa,CAAC,cAAe,SAAUP,OAAQ,CAAC,SAAU,SAAUqB,SAAU,CAAC,WAAY,YAE3IhlB,EAAE2oB,SAAW3oB,EAAEyoB,QAAQE,SAEvB3oB,EAAEiH,MAAQ,UACVjH,EAAE4oB,SAAW,YACb5oB,EAAE6oB,SAAW,CAAC,YAAa,WAAY,aACvC7oB,EAAE8oB,SAAW,WACb9oB,EAAE+oB,WAAa,OAGf/oB,EAAEwE,KAAOxO,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAM/f,IAAIqK,KAAMxE,GAEjDA,EAAEgpB,OAAS,CACTD,WAAY,QAGd/oB,EAAErJ,KAAOU,KAAK4xB,QAAQjpB,EAAGA,EAAE4b,KAAKzkB,GAAI6I,EAAE4b,KAAK3R,KAAKmC,KACzCpM,EAAErJ,MAGXuyB,KAAM,SAAU1yB,EAAOwJ,EAAGmpB,GAExB,IAAK,IAAIpxB,KADToxB,EAAOA,GAAQ,GACD3yB,OACImL,IAAZwnB,EAAKpxB,KACPoxB,EAAKpxB,GAAKiI,EAAEjI,IACdiI,EAAEjI,GAAKvB,EAAMuB,GAGf,OAAOoxB,GAETC,OAAQ,SAAUppB,EAAGmpB,GACnB,IAAK,IAAIpxB,KAAKoxB,EACZnpB,EAAEjI,GAAKoxB,EAAKpxB,IAGhBkxB,QAAS,SAAUjpB,EAAG7I,EAAIiV,GACxB,IAAI9I,EAAOjM,KAAKgyB,YAAYrpB,EAAG7I,EAAIiV,GAE/Bmb,EAAOvnB,EAAEsnB,UAAUC,KAAOvxB,GAAG4H,eAAehC,IAAIoE,EAAEsnB,UAAUC,KAAMvnB,GAAK,GACvEmpB,EAAO9xB,KAAK6xB,KAAK,CAAE3B,KAAMA,EAAMzwB,KAAMkJ,EAAEuc,KAAKX,KAAMzkB,GAAI6I,EAAEuc,KAAKX,KAAKzkB,IAAM6I,EAAGmpB,GAE3ErN,EAAQ9lB,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAM8N,QAAQlM,MAAO9b,GACzDmpB,EAAO9xB,KAAK6xB,KAAK,CAAEtO,QAAStX,EAAMwY,MAAOA,GAAS9b,EAAGmpB,GACrD,IAAIvf,EAAO5T,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAM8N,QAAQC,MAAOjoB,GAExD,OADA3I,KAAK+xB,OAAOppB,EAAGmpB,GACRvf,GAETyf,YAAa,SAAUrpB,EAAG7I,EAAIiV,GAC5B,IAAI4a,EAAU5a,EAAIjV,GAElB,IAAK6vB,EAAS,OAAO,KACrB,GAAIhnB,EAAEmZ,MAAQ,EAAG,OAAO,KACxB,IAAIA,OAAmBxX,GAAX3B,EAAEmZ,MAAqBnZ,EAAEmZ,MAAQ,EAAI,EAE7C7V,EAAO,GACP6lB,EAAO9xB,KAAK6xB,KAAK,CACnB/xB,GAAI,KACJL,KAAM,KACNqiB,MAAO,EACPmQ,WAAY,KACZ1O,QAAS,KACTkB,MAAO,KACPwM,OAAQ,KACRiB,aAAc,MACbvpB,EAAGmpB,GAGF9vB,EAAQ,EACZ,IAAK,IAAItB,KAAKivB,EAAS,CAErBjuB,OAAO4L,OAAO3E,EAAG,CACf7I,GAAIY,EACJjB,KAAMkJ,EAAEC,MAAMlI,GACdohB,MAAOA,EACPmQ,WAAYtpB,EAAE2oB,UAAY5wB,EAAI,WAAa,GAC3CsB,MAAOA,EACPkwB,aAAc,OAGhB,IAAIzyB,EAAOO,KAAKshB,QAAQ3Y,EAAGoM,GAC3B9I,EAAK1E,KAAK9H,GAEVuC,IAIF,OADAhC,KAAK+xB,OAAOppB,EAAGmpB,GACR7lB,GAGTkmB,UAAW,SAAUxpB,EAAGmZ,EAAO9f,GAC7B,IAAIivB,EAeJ,YAAc3mB,IAbZ2mB,EADW,GAATnP,EACOsQ,OAAOC,aAAa,GAAKrwB,GAAS,IAG3B,GAAT8f,EACE9f,EAAQ,IAED,GAAT8f,EACE,SAGA,MAGqB,GAErBnjB,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAMoO,OAAQ,CAAEA,OAAQA,KAK7D3P,QAAS,SAAU3Y,EAAGoM,GACTpM,EAAElJ,KAAb,IACI6yB,EAAW3pB,EAAE5D,MACZutB,GAAY3pB,EAAE6oB,WACjBc,EAAW3pB,EAAE6oB,SAAS7oB,EAAEmZ,QAGrBwQ,IAAUA,EAAW3pB,EAAE4oB,UAC5B,IAmCIhf,EAnCAggB,EAAYtzB,IAAEmB,IAAIuI,EAAEka,MAAOyP,GAgB/B,GAbA3pB,EAAEsoB,OAASjxB,KAAKmyB,UAAUxpB,EAAGA,EAAEmZ,MAAOnZ,EAAE3G,OAExC2G,EAAE8b,MAAQ9lB,GAAG4H,eAAehC,IAAIguB,EAAW5pB,GAWvCA,EAAElJ,KAAK8vB,QAAS,CAElB,IACI9K,EADA+N,EAAYD,EAAUxtB,KAAKyR,KAAKiO,OAGdA,EAAlB+N,EAAU9vB,OAAgBzD,IAAEmB,IAAIuI,EAAE8b,MAAO+N,GAChC7pB,EAAE8b,OACJhL,WAAUgL,EAAMhL,SAAW,IAGtCgL,EAAMhL,SAASlS,KAAKoB,EAAEwE,MAUxB,GANAxE,EAAE4a,QAAUvjB,KAAKgyB,YAAYrpB,EAAGA,EAAE7I,GAAIiV,GAElCpM,EAAEspB,aAAetpB,EAAE4a,UAAS5a,EAAE4a,QAAU,IAIxC5a,EAAE4a,QAAS,CACb,IAAIkO,EAAWxyB,IAAEmB,IAAIuI,EAAEka,MAAOla,EAAE8oB,UAEhClf,EAAO5T,GAAG4H,eAAehC,IAAIktB,EAAU9oB,QAEpC4J,EAAO5J,EAAE8b,MAEd,OAAOlS,OAUf5L,GAAYof,YAAY,sBAAuB,CAC7CC,OAAQ,CACN5lB,IAAK,SAAUsE,GAEb,OADY/F,GAAGuX,YAAY3R,IAAIvE,KAAK+L,OAGtCA,KAAM,CACJwY,KAAM,CACJqJ,OAAM,oDACNxJ,KAAI,iHACJ3kB,KAAI,4HACJ4Z,MAAK,8mDA6Db1S,GAAYof,YAAY,iBAAkB,CACxCtI,MAAO,CACLuI,OAAQ,CACN5lB,IAAK,SAAUsE,EAAIiE,GAuDjB,OAtDAjE,EAAGiQ,MAAM,CACP/L,MAAO,mBACP2b,KAAM,kBACNW,KAAM,aACNrC,MAAO,uBACNla,GAGH3I,KAAKyyB,OAAO9pB,GAEZA,EAAE+pB,SAAW,CACXC,QAAS,CAAC,cAAe,YAAa,cAIxChqB,EAAEwG,MAAQ,CACRyjB,YAAa,OACblB,WAAY,QAGThtB,EAAGmS,MAAMgc,cACZnuB,EAAGmS,MAAMgc,YAAc,CAAE1zB,MAAO,CAAC,YAEjC2mB,GAAK0K,KAAKjsB,IAAI,+BAAgC,OAAQ,GAAI,CACxD0H,KAAM,CAAC,SAACzG,EAAMrG,GACZuF,EAAGmS,MAAMgc,YAAY1zB,MAAQA,EAC7BwH,GAAYkiB,aAAankB,EAAGc,QAAQ,GAAO,QAKjDmD,EAAEQ,QAAUxK,GAAGqiB,MAAM5gB,IAAIsE,EAAIqc,GAAM,CAAEK,QAAS,CAAEkL,OAAQ,CAAC,YAAa,YAGtE3jB,EAAEiH,MAAQ,UACVjH,EAAE4oB,SAAW,YACb5oB,EAAE6oB,SAAW,GACb7oB,EAAEsb,WAAa,CACbG,KAAM,YACNK,MAAO,cAET9b,EAAE8oB,SAAW,WACb9oB,EAAE+oB,WAAa,OACf/oB,EAAEmZ,MAAQ,EACVnZ,EAAEgL,KAAOhL,EAAE4b,KAAK3R,KAAKmC,IAErBpM,EAAE7I,GAAK,OACP6I,EAAElJ,KAAOkJ,EAAE4b,KACX5b,EAAEkqB,YAAcnuB,EAAGmS,MAAMgc,YAAY1zB,MAM9B,CAJIa,KAAK8yB,SAASnqB,GAEbhK,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAM0B,KAAKlL,MAAO1Q,KAKxDmqB,SAAU,SAAUnqB,GAClB,IAAI2pB,EAAW3pB,EAAE5D,MAAQ4D,EAAE+pB,SAASC,QAAQhqB,EAAEmZ,OACzCwQ,GAAUzsB,QAAQC,MAAM,UAAW6C,GACxC,IAAI5D,EAAO9F,IAAEmB,IAAIuI,EAAEka,MAAOyP,GAK1B,GAHavtB,EAAKA,KAAKkP,WAGZsP,QAAS,CAClB,IAAIrW,EAAavE,EAAEgL,KAAKhL,EAAE7I,IACtBgiB,EAAQnZ,EAAEmZ,MAAQ,EACtBnZ,EAAE4a,QAAUvjB,KAAK+yB,SAASpqB,EAAGuE,EAAY,SAAC/N,EAAOuB,GAC/C,MAAO,CACLZ,GAAIY,EACJjB,KAAMkJ,EAAEC,MAAMlI,GACdohB,MAAOA,KAQb,OAFWnjB,GAAG4H,eAAehC,IAAIQ,EAAM4D,IAMzCoqB,SAAU,SAAUpqB,EAAGuE,EAAYgV,GACjC,IAAIjW,EAAO,GAGX,IAAK,IAAIvL,KAFTiI,EAAEqqB,QAEY9lB,EAAY,CACxBvE,EAAE5E,IAAIme,EAAQhV,EAAWxM,GAAIA,IAC7B,IAAI6R,EAAOvS,KAAK8yB,SAASnqB,GACzBsD,EAAK1E,KAAKgL,GAKZ,OAFA5J,EAAEsqB,QAEKhnB,GAKTwmB,OAAQ,SAAU9pB,GAChBA,EAAE5E,IAAM,SAAU5E,GAChB,IAAIwJ,EAAI3I,KACJ8xB,EAAOnpB,EAAEmpB,KACb,IAAK,IAAIpxB,KAAKvB,OACImL,IAAZwnB,EAAKpxB,KACPoxB,EAAKpxB,GAAKiI,EAAEjI,IACdiI,EAAEjI,GAAKvB,EAAMuB,IAKjBiI,EAAEvI,IAAM,SAAUjB,GAChB,IAAIwJ,EAAI3I,KACJ8xB,EAAOnpB,EAAEmpB,KACb,IAAK,IAAIpxB,KAAKvB,OACImL,IAAZwnB,EAAKpxB,KACPoxB,EAAKpxB,GAAKiI,EAAEjI,IACdiI,EAAEjI,GAAKvB,EAAMuB,IAIjBiI,EAAEsqB,MAAQ,WACR,IAAItqB,EAAI3I,KACJ8xB,EAAOnpB,EAAEmpB,KAEb,IAAK,IAAIpxB,KAAKoxB,EACZnpB,EAAEjI,GAAKoxB,EAAKpxB,GAEdiI,EAAEmpB,KAAOnpB,EAAEuqB,OAAOC,OAGpBxqB,EAAEqqB,MAAQ,WAER,IAAIrqB,EAAI3I,KAEH2I,EAAEuqB,SAAQvqB,EAAEuqB,OAAS,IAE1BvqB,EAAEuqB,OAAO3rB,KAAKoB,EAAEmpB,MAEhBnpB,EAAEmpB,KAAO,SAWnBnrB,GAAYof,YAAY,YAAa,CACnCnd,MAAO,KASTjC,GAAYof,YAAY,kBAAmB,CACzClf,MAAO,WAAY,IAAAusB,EAAApzB,KACjBA,KAAKD,GAAKpB,GAAGoB,GAAGwE,IAAI,UACpB3F,OAAOy0B,eAAiB,WAAQ,OAAOD,EAAKE,WAC5CtzB,KAAKuzB,WAIPvM,aAAc,WAAY,IAAAwM,EAAAxzB,KACpBA,KAAKoI,OAAOxJ,OAAOuJ,aAAanI,KAAKoI,OAEzCpI,KAAKoI,MAAQxJ,OAAOyJ,WAAW,WAC7BmrB,EAAKF,WACJ,MAGLA,QAAS,WACP,IAAIG,EAAS9sB,GAAYU,SAAS,aAAauB,MAC3C8qB,EAAU,GACd,IAAK,IAAIhzB,KAAK+yB,EACZC,EAAQnsB,KAAKvH,KAAK2zB,SAASjzB,EAAG+yB,EAAO/yB,MAIzCizB,SAAU,SAAU7zB,EAAI2L,GACtB,IAAIjG,EAAOiG,EAAOjG,MAAQiG,EACtByZ,EAAOve,GAAY6hB,UAAUhjB,GACjC,OAAOxF,KAAKD,GAAGF,KAAK,CAAEqlB,QAAQplB,IAGhCyzB,QAAS,WACP,IAAIE,EAAS9sB,GAAYU,SAAS,aAAauB,MAE/C,IAAK,IAAIlI,KAAK+yB,EACZzzB,KAAK4zB,SAASlzB,EAAG+yB,EAAO/yB,KAG5BkzB,SAAU,SAAU9zB,EAAI2L,GACtB,IAAIjG,EAAOiG,EAAOjG,MAAQiG,EACtBooB,EAASpoB,EAAOooB,QAAU,KAC9B7zB,KAAKD,GAAGc,KAAKf,GAAIO,KAAK,SAACuI,GACjBA,GAASA,EAAMsc,MAAMve,GAAY5C,IAAIyB,EAAMoD,EAAMsc,MACjD2O,GAAQltB,GAAYmtB,MAAMD,EAAO,GAAIA,EAAO,OAIpDE,QAAS,CACP/N,OAAQ,CACNQ,WAAW,EACXpmB,IAAK,SAACsE,GACJ,OAAIA,EAAGmS,MAAMmd,KAAa,GAC1BtvB,EAAGmS,MAAMmd,MAAO,EACRtvB,EAAGiQ,MAAM,CAAEjQ,GAAI,oBACrBA,GAAGmC,QAEE,QAUfF,GAAYof,YAAY,WAAY,CAClCC,OAAQ,CACN5lB,IAAK,SAAUsE,GAEb,OADY/F,GAAGuX,YAAY3R,IAAIvE,KAAK+L,OAGtCA,KAAM,CACJyd,KAAI,w8DAmDJyK,UAAW,8CACXC,WAAU,+DAEVC,SAAQ,yBAMdxtB,GAAYof,YAAY,aAAc,CACpCnhB,KAAM,CACJwF,MAAO,CAAE7H,KAAM,IACfyqB,YAAa,OAEbsE,SAAU,MAKd3qB,GAAYof,YAAY,eAAgB,CACtCC,OAAQ,CACNhR,MAAO,CAAE6N,MAAO,WAAYuR,UAAW,kBAAmB7hB,KAAM,qBAChEnS,IAAK,SAAUsE,EAAIiE,GAMjB,OAJAjE,EAAGiQ,MAAM3U,KAAKgV,MAAOrM,GAErB1J,IAAE8E,IAAI4E,EAAE4J,KAAM5J,EAAEka,MAAM2G,KAAKzkB,KAAKyR,KAAK6d,MAAMzmB,OAAO,CAAC,QAAS,UAAWjF,EAAEyrB,UAAUhqB,OAE5EzB,EAAE4J,SAMf5L,GAAYof,YAAY,qBAAsB,CAC5CtI,MAAO,CACLuI,OAAQ,CACN7E,OAAQ,SAAUzc,EAAIiE,EAAGuB,GACvBxF,EAAGmS,MAAM3M,KAAOA,EAIhB4b,GAAK0K,KAAKlI,GAAG,cAAe,CAC1BxoB,GAAIoK,EAAKpK,GACT8I,MAAOjC,GAAY6hB,UAAU,eAC5B,CACC/K,MAAO,CACL,SAAUjY,EAAMrG,GACd0G,QAAQ6D,IAAI,WAAYvK,GACxBuF,EAAGmS,MAAM4G,MAAQte,EACjBwH,GAAYkiB,aAAankB,EAAGc,QAAQ,GAAO,QAOrDpF,IAAK,SAAUsE,EAAIiE,GAEjBjE,EAAGiQ,MAAM,CAAE/L,MAAO,cAAgBD,GAE7BjE,EAAGmS,MAAMyd,UACZ5vB,EAAGmS,MAAMyd,SAAU,EAEnB5vB,EAAGmS,MAAM4G,MAAQ,UAEjBqI,GAAK0K,KAAKlI,GAAG,cAAe,CAC1BxoB,GAAI,SACH,CACC2d,MAAO,CACL,SAAUjY,EAAMrG,GACd0G,QAAQ6D,IAAI,WAAYvK,GACxBuF,EAAGmS,MAAM4G,MAAQte,EACjBwH,GAAYkiB,aAAankB,EAAGc,QAAQ,GAAO,QAQrD,IAAIyM,EAAUtL,GAAYuM,WAAW,cAOrC,OANIxO,EAAGmS,MAAM3M,MAAQxF,EAAGmS,MAAMsP,KAAMzhB,EAAGmS,MAAMsP,IAAIoO,UAAU,cAActiB,SAAWA,GAElFjS,KAAKmhB,OAAOzc,EAAIiE,EAAGjE,EAAGmS,MAAM3M,MAIvBxF,EAAGmS,MAAM4G,OAElB+W,mBAAmB,MAKzB7tB,GAAYof,YAAY,uBAAwB,CAC9CvgB,KAAM,6BAGRmB,GAAYof,YAAY,oBAAqB,CAC3CC,OAAQ,CACNhR,MAAO,CAAE6N,MAAO,WAAYje,KAAM,eAAgBsgB,KAAM,OAAQuP,UAAW,wBAC3Er0B,IAAK,SAAUsE,EAAIiE,GACjB9C,QAAQ6D,IAAI,SAEZhF,EAAGiQ,MAAM3U,KAAKgV,MAAOrM,GAErBjE,EAAGiQ,MAAM,CAAE+T,KAAM/f,EAAE8rB,UAAUjvB,MAAQmD,GAGrC9C,QAAQ6D,IAAIf,EAAE+f,MAEd,IAAI1H,EAAQriB,GAAGqiB,MAAM5gB,IAAIsE,EAAIqc,GAC3B,CAAEI,OAAQ,CAAEuT,YAAa,yBAA2BnwB,IAAK,CAAEowB,WAAY,UAAWC,WAAY,gBA+BhG,IAAK,IAAIl0B,KA7BTiI,EAAEksB,IAAM,CACNj2B,OAAQ,CACN0e,OAAQ,MACRE,MAAO,OAETsX,UAAW,MAGbnsB,EAAE/D,KAAO,CACP8nB,MAAO,OACPqI,WAAY,WACZV,MAAO,CACLlT,OAAQH,EAAM0T,YACdrH,MAAOrM,EAAM4T,YAEfI,KAAM,CACJzvB,OAAQyb,EAAM2T,YAEhBE,IAAKlsB,EAAEksB,IAEPnM,KAAM/f,EAAE+f,KAER9Y,MAAO,OACP8hB,WAAY,OACZuD,UAAW,OAEXC,KAAM,IAGMvsB,EAAE8rB,UAAUR,UACpBtrB,EAAE8rB,UAAUR,UAAUvzB,KACxBiI,EAAE/D,KAAKqvB,UAAYvvB,EAAGiQ,MAAM,CAAEwgB,MAAOxsB,EAAE8rB,UAAUR,UAAUvzB,KAC3DiI,EAAE/D,KAAKqvB,UAAUrD,MAAQjyB,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAMoR,UAAWtrB,EAAE/D,OAKxE,OADA+D,EAAE4J,KAAO5T,GAAG4H,eAAehC,IAAIoE,EAAEka,MAAM2G,KAAM7gB,EAAE/D,MACxC+D,EAAE4J,MAEXiU,WAAW,KAMf7f,GAAYof,YAAY,OAAQ,CAC9BC,OAAQ,CACN5lB,IAAK,WAEH0lB,GAAK+H,aAAaC,cAEpBtH,WAAW,KAQf7f,GAAYyuB,eAAeC,WAAY,EACvC1uB,GAAY2uB,iBAKNC,eACJ,SAAAA,EAAYpwB,GAAO,IAAAqwB,EAAA,OAAA9zB,OAAAqa,EAAA,EAAAra,CAAA1B,KAAAu1B,IACjBC,EAAA9zB,OAAAsa,EAAA,EAAAta,CAAA1B,KAAA0B,OAAAua,EAAA,EAAAva,CAAA6zB,GAAArZ,KAAAlc,KAAMmF,KAIRK,KAAO,eAHLgwB,EAAKx0B,MAAQ,GAFIw0B,mFAOC,IAAAC,EAAAz1B,KAClB2G,GAAYQ,WAAWnH,KAAKwF,KAAM,MAAO,CACvCjB,IAAK,WACHkxB,EAAKnZ,SAAS,CAAErK,SAAW,IAAI3Q,MAAOC,8FAS1C,IAAIm0B,EAAa/uB,GAAYU,SAASrH,KAAKwF,MAE3C,OADW7G,GAAGiiB,WAAWH,cAAciV,GAAc,KAAO,eArB5ChvB,aAsFLivB,eAzDb,SAAAA,EAAYxwB,GAAO,IAAAywB,EAAA,OAAAl0B,OAAAqa,EAAA,EAAAra,CAAA1B,KAAA21B,IACjBC,EAAAl0B,OAAAsa,EAAA,EAAAta,CAAA1B,KAAA0B,OAAAua,EAAA,EAAAva,CAAAi0B,GAAAzZ,KAAAlc,KAAMmF,KAEDnE,MAAQ,CACX7B,MAAO,CAAE02B,MAAO,UAJDD,wEASjB,yuBAmCA,IAAIvc,EAAQrZ,KAAKsZ,SACboc,EAAa,CAEfrW,EAAAjF,EAAA7B,cAACud,GAAD,CAAOnuB,IAAI,OAEb,MAAO,CAEL0X,EAAAjF,EAAA7B,cAAA,SAAO5Q,IAAI,SAAS0R,GACpBqc,UArDgBhvB,aC1vFPqvB,eAVb,SAAAA,EAAY5wB,GAAQ,OAAAzD,OAAAqa,EAAA,EAAAra,CAAA1B,KAAA+1B,GAAAr0B,OAAAsa,EAAA,EAAAta,CAAA1B,KAAA0B,OAAAua,EAAA,EAAAva,CAAAq0B,GAAA7Z,KAAAlc,KACZmF,0EAKN,OADcka,EAAAjF,EAAA7B,cAACyd,GAAD,aANAtvB,aCCZuvB,GAAcC,QACW,cAA7Bt3B,OAAOu3B,SAASC,UAEe,UAA7Bx3B,OAAOu3B,SAASC,UAEhBx3B,OAAOu3B,SAASC,SAASxc,MACvB,2DAwCN,SAASyc,GAAgBC,EAAOC,GAC9BC,UAAUC,cACPC,SAASJ,GACTj2B,KAAK,SAAAs2B,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiB71B,QACfw1B,UAAUC,cAAcO,YAI1BnxB,QAAQ6D,IACN,gHAKE6sB,GAAUA,EAAOU,UACnBV,EAAOU,SAASN,KAMlB9wB,QAAQ6D,IAAI,sCAGR6sB,GAAUA,EAAOW,WACnBX,EAAOW,UAAUP,UAO5Bh2B,MAAM,SAAAmF,GACLD,QAAQC,MAAM,4CAA6CA,KC5FjEqxB,IAASC,OAAO/X,EAAAjF,EAAA7B,cAAC8e,GAAD,MAAS/e,SAASgf,eAAe,SDgB1C,SAAkBf,GAIrB,IAAMgB,EAAY,IAAIC,IAAIC,cAAwB74B,OAAOu3B,SAASuB,MAC9DH,EAAUI,SAAW/4B,OAAOu3B,SAASwB,OAQzC/4B,OAAOg5B,iBAAiB,OAAQ,WAC9B,IAAMtB,EAAK,GAAA1oB,OAAM6pB,cAAN,sBAEPxB,IAgEV,SAAiCK,EAAOC,GAEtC5hB,MAAM2hB,GACHj2B,KAAK,SAAAw3B,GAEJ,IAAMC,EAAcD,EAASE,QAAQ33B,IAAI,gBAEnB,MAApBy3B,EAASG,QACO,MAAfF,IAA8D,IAAvCA,EAAYtgB,QAAQ,cAG5Cgf,UAAUC,cAAcwB,MAAM53B,KAAK,SAAAs2B,GACjCA,EAAauB,aAAa73B,KAAK,WAC7BzB,OAAOu3B,SAASgC,aAKpB9B,GAAgBC,EAAOC,KAG1B51B,MAAM,WACLkF,QAAQ6D,IACN,mEArFA0uB,CAAwB9B,EAAOC,GAI/BC,UAAUC,cAAcwB,MAAM53B,KAAK,WACjCwF,QAAQ6D,IACN,+GAMJ2sB,GAAgBC,EAAOC,KArBzB1wB,QAAQC,MAAOyxB,EAAUI,QCpB/BlB,kFCXA,IAAArB,EAAA,CACAvuB,MAAA,SAAAsG,GACA,IAAA1N,EAAAiC,OAAAC,OAAA3B,MAYA,OAXAP,EAAAsI,OAAA,CACAswB,aAAA,CACAlrB,KAAA,EACAtK,KAAA,cACAsK,UAGA+lB,OAAA,IAEAzzB,EAAA41B,WAAA,EACA51B,EAAAsI,OAAAmrB,OAAA3rB,KAAA9H,EAAAsI,OAAAswB,cACA54B,GAEA64B,WAAA,SAAAnrB,GACA,GAAAnN,KAAAq1B,UAAA,CACA,IAAArC,EAAA,CACA7lB,KAAA,GACAorB,UAAAv4B,KAAA+H,OAAAswB,aACAp0B,MAAAjE,KAAA+H,OAAAmrB,OAAAxwB,OACAuF,MAAAkF,GAEAnN,KAAA+uB,QAAA,CACAlsB,KAAA,WACAmwB,UACK,GACLhzB,KAAA+H,OAAAmrB,OAAA3rB,KAAAyrB,GACAhzB,KAAA+H,OAAAswB,aAAArF,EACA7lB,GAAAnN,KAAA+uB,QAAA5hB,KAEA4hB,QAAA,SAAA5hB,EAAAqrB,GACAx4B,KAAAq1B,YACAmD,IAAArrB,EAAAlO,EAAA6F,UAAAqI,IACAnN,KAAA+H,OAAAswB,aAAAlrB,KAAA5F,KAAA4F,KAEAsrB,SAAA,SAAAtrB,GACAnN,KAAAq1B,YACAloB,GAAAnN,KAAA+uB,QAAA5hB,GACAnN,KAAA+H,OAAAswB,aAAAr4B,KAAA+H,OAAAswB,aAAAE,aAGAG,EAAA,CACA7xB,MAAA,WACA,IAAApH,EAAAiC,OAAAC,OAAA3B,MAsBA,OArBAP,EAAAuB,MAAA,CACAlC,IAAA,GACA65B,aAAA,GACA5wB,OAAA,GACA6wB,KAAA,GACA/hB,MAAA,GACA5E,QAAA,GACA4mB,aAAA,GACAvtB,SAAA,GACAwtB,eAAA,EACAC,aAAA,GACAje,QAAA,EACAke,OAAA,CACAtR,MAAA,GACAuR,MAAA,IAEAziB,KAAA,GACA0iB,QAAA,GACAC,MAAA,IAEA15B,EAAA21B,iBAAAvuB,MAAA7G,MACAP,GAEAuB,MAAA,CACA23B,aAAA,GACA5wB,OAAA,GACA6wB,KAAA,GACA/hB,MAAA,GACA5E,QAAA,GACA4mB,aAAA,GACAvtB,SAAA,GACAwtB,eAAA,EACAC,aAAA,GACAje,QAAA,EACAke,OAAA,CACAtR,MAAA,GACAuR,MAAA,IAEAziB,KAAA,GACA0iB,QAAA,GACAC,MAAA,IAEAC,OAAA,SAAAC,EAAAC,EAAAn6B,EAAAuoB,GACA,IAAA5oB,EAAAG,EAAAmB,IAAAJ,KAAAgB,MAAAlC,IAAA,CAAAu6B,EAAA,OAAA5zB,KAAA,MAEA3G,GAAAG,EAAA8E,IAAA/D,KAAAgB,MAAAlC,IAAA,CAAAu6B,EAAA,OAAA5zB,KAAA,KAAA3G,EAAA,CACA4oB,MAAA,KAGAzoB,EAAA8E,IAAAjF,EAAAw6B,EAAAn6B,GAEAL,EAAA4oB,MAAAngB,KAAA,CACAmgB,QACAliB,KAAA8zB,KAGAC,OAAA,SAAAF,EAAAj4B,GACA,IAIAk4B,EAJAx6B,EAAAG,EAAAmB,IAAAJ,KAAAgB,MAAAlC,IAAA,CAAAu6B,EAAA,OAAA5zB,KAAA,MAGA,IAAA3G,EAAA,YAGA,QAAA4B,KAAA5B,EAAA4oB,MACA,OAAA5oB,EAAA4oB,MAAAhnB,GAAAgnB,MAAAlQ,QAAApW,GAAA,CACAk4B,EAAAx6B,EAAA4oB,MAAAhnB,GAAA8E,KACA,MAIA,OAAA8zB,EAEAr6B,EAAAmB,IAAAtB,EAAAw6B,GAFA,MAMAxF,MAAA,SAAAuF,EAAAj4B,EAAA8I,GACA,IAAAuB,EAAAzL,KAAAu5B,OAAAF,EAAAj4B,GACA,OAAAqK,EACAA,EAAArK,GAAA8I,GADA,MAGAsvB,MAAA,SAAAh0B,EAAA0E,GACA,IAAAsK,EAAAhP,EAAAhD,MAAA,KACAi3B,EAAAjlB,EAAA2e,MACAuG,EAAAllB,EAAA/O,KAAA,KACAgG,EAAAzL,KAAAqH,SAAAqyB,GACA,GAAAjuB,EAAAguB,GAEA,OAAAx6B,EAAAG,WAAAqM,EAAAguB,IACAhuB,EAAAguB,GAAAvvB,EAAA1E,EAAAxF,MACKf,EAAAG,WAAAqM,EAAAguB,GAAAl1B,KACLkH,EAAAguB,GAAAl1B,IAAA2F,EAAA1E,EAAAxF,WADK,GAIL25B,cAAA,SAAAn0B,GACA,IAAAo0B,EAAA,GAEAC,EAAA56B,EAAAmB,IAAAJ,KAAAgB,MAAA+3B,aAAAvzB,EAAA,QAEA,IAAAq0B,EAAA,SAEA,QAAAn5B,KAAAm5B,EACAD,EAAAryB,KAAA7G,GACAk5B,IAAAhsB,OAAA5N,KAAA25B,cAAAj5B,IAGA,OAAAk5B,GAEAvyB,SAAA,SAAA7B,EAAAs0B,GACA,IAAAtlB,EAAAhP,EAAAhD,MAAA,KACArD,EAAAa,KAAA+5B,WAAAv0B,GACA,GAAArG,EAAA,OAAAA,EACA,IAAA26B,EAAA,QAAAp5B,EAAA,EAA+CA,EAAA8T,EAAA9R,OAAkBhC,IAAA,CACjE,IAAAs5B,EAAAxlB,EAAAqJ,MAAA,EAAAnd,GAAA+E,KAAA,KAEA,GAAAzF,KAAAgB,MAAA23B,aAAAqB,GAAA,CACA,IAAAC,EAAAj6B,KAAAgB,MAAA23B,aAAAqB,GAAAC,cACAC,EAAA1lB,EAAAqJ,MAAAnd,GAEAy5B,EAAAl7B,EAAAmB,IAAA65B,EAAAC,GAEA,QAAA5vB,IAAA6vB,EAAA,OAAAA,GAGAn6B,KAAAgB,MAAA23B,aAAAnzB,IAAA,EACA,IAAAyG,EAAAjM,KAAA+yB,SAAAvtB,GAUA,OATArG,EAAAa,KAAAo6B,YAAAnuB,EAAAzG,UACAxF,KAAAgB,MAAA23B,aAAAnzB,QAEA8E,IAAAnL,GAEAa,KAAAq6B,SAAA70B,EAAArG,GAIAA,GAEAk7B,SAAA,SAAA70B,EAAArG,EAAAm7B,GACAt6B,KAAAgB,MAAA6V,MAAArR,GAAA,CACArG,QACAm7B,iBAAA,EACAroB,QAAAjS,KAAAgB,MAAA83B,iBAGAiB,WAAA,SAAAv0B,EAAA+0B,GACA,OAAAv6B,KAAAgB,MAAA6V,MAAArR,GACA+0B,EAAAv6B,KAAAgB,MAAA6V,MAAArR,GAAArG,MACAa,KAAAgB,MAAA6V,MAAArR,GAAA80B,aAAA,KACAt6B,KAAAgB,MAAA6V,MAAArR,GAAArG,MAHA,MAKAq7B,aAAA,SAAAh1B,GACA,IAAAqR,EAAA7W,KAAAgB,MAAA63B,aAAArzB,GAEAqR,IACAA,EAAA7W,KAAAgB,MAAA63B,aAAArzB,GAAA,CACA2gB,IAAA,GACAsU,SAAA,GACAlG,UAAA,KAIA,IAAApO,EAAA,CACAsU,SAAA5jB,EAAA4jB,UAAA,GACAlG,UAAA1d,EAAA0d,WAAA,IAKA,OAHA1d,EAAAsP,aACAtP,EAAA4jB,gBACA5jB,EAAA0d,UACApO,GAEAuU,UAAA,SAAAC,EAAAn1B,GACAxF,KAAAgB,MAAA63B,aAAArzB,KAAAxF,KAAAgB,MAAA63B,aAAArzB,GAAA,IACA,IAAAqR,EAAA7W,KAAAgB,MAAA63B,aAAArzB,IAAA,GACAuzB,EAAA/4B,KAAAgB,MAAA+3B,aAEA6B,EAAA,SAAAxgB,EAAAC,GACA,IAAAwf,EAAA56B,EAAAmB,IAAA24B,EAAA3e,EAAA,QAEAyf,GAAA56B,EAAA8E,IAAAg1B,EAAA3e,EAAA,OAAAyf,EAAA,IACAA,EAAAxf,IAAA,GAGAwgB,EAAA,SAAAzgB,EAAAC,GACA,IAAAwf,EAAA56B,EAAAmB,IAAA24B,EAAA3e,EAAA,QAEAyf,UACAA,EAAAxf,IAGA7G,EAAA,SAAAsnB,EAAAC,GACA,QAAAr6B,KAAAo6B,EACAC,KAAAr6B,IAAAk6B,EAAAl6B,EAAA8E,GAGA,QAAA9E,KAAAq6B,EACAD,KAAAp6B,IAAAm6B,EAAAn6B,EAAA8E,IAIAgO,EAAAqD,EAAA4jB,SAAAE,EAAAF,UACAjnB,EAAAqD,EAAA0d,UAAAoG,EAAApG,YAEAC,kBAAA,SAAAhvB,GACA,IACAw1B,GADAh7B,KAAAgB,MAAA63B,aAAArzB,IAAA,IACA+uB,UAEA,QAAA7zB,KAAAs6B,EAAA,CACA,IAAAlC,EAAA94B,KAAAkT,WAAAxS,GACAs6B,EAAAt6B,GAAAuR,QAAA6mB,EACAjzB,QAAA6D,IAAA,mBAAAovB,EAAAkC,EAAAt6B,GAAAuR,WAGA8gB,SAAA,SAAAvtB,GACA,IAAAyG,EAAA,GACAuI,EAAAhP,EAAAgpB,OAAAhpB,EAAAhD,MAAA,KAAAgD,EAEAy1B,EAAAh8B,EAAAmB,IAAAJ,KAAAgB,MAAA+G,OAAAvC,GAEA,QAAA8E,IAAA2wB,EAAA,CACA,IAAAh8B,EAAAyc,aAAAuf,GAQA,OAPAhvB,EAAA1E,KAAA,CACA4C,IAAA,SACAhL,MAAA87B,EACAz1B,KAAA,GACA01B,QAAA11B,EACAyM,QAAA,IAEAhG,EAGAgvB,EAAAh8B,EAAA6F,UAAAm2B,GACAhvB,EAAA1E,KAAA,CACA4C,IAAA,SACAhL,MAAA87B,EACAz1B,KAAA,GACA01B,QAAA11B,EACAyM,QAAA,IAMA,IAFA,IAAA2mB,EAAA54B,KAAAgB,MAAA43B,KAEAl4B,EAAA,EAAmBA,EAAA8T,EAAA9R,QACnBk2B,EADqCl4B,IAAA,CAGrC,GAAAk4B,EAAA5S,OAAA,CACA,IAAAvmB,EAAA,CACA0K,IAAA,OACA6b,OAAA4S,EAAA5S,OACAxgB,KAAA,GACA01B,QAAA1mB,EAAAqJ,MAAA,EAAAnd,GACA4rB,OAAA9X,EAAAqJ,MAAAnd,IAEAuL,EAAA1E,KAAA9H,GAGAm5B,IAAApkB,EAAA9T,IAGA,IAAAy6B,EAAA3mB,EAsBA,OApBA,SAAA2F,EAAAnb,EAAAwV,EAAAvI,GACA,GAAAjN,EAAA,CAEA,GAAAA,EAAAgnB,OAAA,CACA,IAAAoV,EAAA,CACAjxB,IAAA,MACA6b,OAAAhnB,EAAAgnB,OACAxgB,KAAAgP,EACA0mB,QAAAC,EAAAvtB,OAAA4G,IAEAvI,EAAA1E,KAAA6zB,GAGA,QAAAC,KAAAr8B,EACA,UAAAq8B,GACAlhB,EAAAnb,EAAAq8B,GAAA7mB,EAAA5G,OAAAytB,GAAApvB,IAIAkO,CAAAye,EAAA,GAAA3sB,GACAA,GAEAqvB,UAAA,SAAA91B,EAAArG,EAAAo8B,GACAv7B,KAAAo1B,eAAArG,QAAA,CACAlsB,KAAA,YACA2C,OACArG,UAGAF,EAAA8E,IAAA/D,KAAAgB,MAAA+G,OAAAvC,EAAArG,GAEAa,KAAAgB,MAAA6V,MAAArR,KAAAxF,KAAAgB,MAAA6V,MAAArR,GAAA80B,cAAA,GACAiB,GAAAv7B,KAAAw7B,iBAAAh2B,IAEA40B,YAAA,SAAAnuB,EAAAzG,GACA,MAAAyG,EAAAvJ,QAAAuJ,EAAA,GAAA9M,MAAA,OAAA8M,EAAA,GAAA9M,MACA,IAAA+E,EAAA,GACAlE,KAAAgB,MAAA23B,aAAAnzB,GAAA,CACAy0B,cAAA/1B,GAMA,IAJA,IAAAu3B,EAAAxvB,EACAyvB,GAAA,EACAC,EAAA,EAEAD,GAAA,CAGA,KAFAC,EAEA,EAGA,OADA37B,KAAAgB,MAAA6V,MAAArR,GAAA80B,cAAA,EACAp2B,EAGA+H,EAAAwvB,EACAA,EAAA,GACAC,GAAA,EAEA,QAAAh7B,EAAA,EAAqBA,EAAAuL,EAAAvJ,OAAiBhC,IAAA,CACtC,IAAA+Q,EAAAxF,EAAAvL,GACAvB,OAAA,EAEA,GAAAsS,EAAAtS,MACAA,EAAAsS,EAAAtS,WACS,GAAAsS,EAAAuU,OACT,IACA7mB,EAAAa,KAAA47B,cAAAnqB,EAAAvN,EAAAsB,GACW,MAAA5F,GACX,YAAAA,GACAI,KAAAgB,MAAA6V,MAAArR,GAAA80B,cAAA,EACAmB,EAAAl0B,KAAAkK,GACAiqB,GAAA,GAEA71B,QAAAC,MAAAlG,GAGA,SAIA6R,EAAA6a,SAAAntB,EAAAF,EAAAmB,IAAAjB,EAAAsS,EAAA6a,SAEA7a,EAAAjM,KAAA9C,OACAzD,EAAA8E,IAAAG,EAAAuN,EAAAjM,KAAArG,GAEA,GAAAuC,OAAAsJ,OAAA9G,GAAAxB,OACAwB,EAAA/E,EAEAF,EAAAuO,MAAAtJ,EAAA/E,IAKA,OAAA+E,GAEA20B,aAAA,GACAgD,OAAA,SAAAC,EAAApL,EAAAqL,EAAA58B,GACAa,KAAAgB,MAAA63B,aAAAiD,KAAA97B,KAAAgB,MAAA63B,aAAAiD,GAAA,CACA7pB,QAAAjS,KAAAgB,MAAA83B,eACAkD,YAAA,KAEA,IAAAC,EAAAj8B,KAAAgB,MAAA63B,aAAAiD,GACAG,EAAAvL,KAAAuL,EAAAvL,GAAA,IACAuL,EAAAvL,GAAAqL,GAAA58B,IAAA,GAEAy8B,cAAA,SAAAnqB,EAAAvN,EAAAg4B,EAAAC,GACA,IAGAh9B,EAHA2B,EAAAd,KAEAk7B,EAAAzpB,EAAAypB,QAAAz1B,KAAA,KAGA,IACA,IAAA22B,EAAA,CACAhc,IAAA,SAAA5a,EAAApE,GACAN,EAAA+6B,OAAAX,EAAA,YAAA11B,EAAA,CACAyM,SAAA,EACA7Q,OACAoE,OACA01B,cAIAlV,EAAAvU,EAAAuU,OAEA,GAAAA,EAAAqW,MACA,GAAArW,EAAAsW,YAAAtW,IAAAsW,gBAA4D,CAC5D,IAAAA,EAAAt8B,KAAAu8B,gBAAAvW,EAAAqW,OACArW,EAAAsW,cACAtW,EAAAsW,EAIA,GAAAtW,EAAAnlB,KACA,OAAAb,KAAAgB,MAAA6V,MAAAqkB,GACA,IAGA/7B,EAAA6mB,EAAAnlB,KAAAqD,EAAAlE,KAAAo8B,EAAA3qB,EAAAuU,OAAAvU,GAEAxS,EAAA8E,IAAA/D,KAAAgB,MAAA+G,OAAAmzB,EAAA/7B,GAEAa,KAAAgB,MAAA6V,MAAAqkB,GAAA,CACAlV,QAAA,EACA7mB,MAAA,IAEAA,GAGA,IAAAg9B,EAAA,CACA,IAAAK,EAAAx8B,KAAA+5B,WAAAmB,GAEA,GAAAsB,EAAA,OAAAA,EAGA,OAAA/qB,EAAAtH,KAAAnK,KAAA67B,OAAAK,EAAA,WAAAhB,GACA,IAAAP,EAAA36B,KAAAw6B,aAAAU,GAEA,GAAAlV,EAAA5lB,IACA,IACA,IAAAsE,EAAA+3B,EAAAt7B,KAAA+C,EAAAlE,KAAAo8B,EAAA3qB,EAAAuU,OAAAvU,EAAAzR,KAAAgB,MAAA63B,aAAAqC,IACA/7B,EAAAwH,EAAAif,OAAAI,EAAA5lB,IAAAsE,IAAAiE,GAA+Dqd,EAAA5lB,IAAAsE,EAAA1E,KAAAo8B,EAAA3qB,EAAAuU,OAAAvU,EAAAzR,KAAAgB,MAAA63B,aAAAqC,IACtD,MAAAt7B,GACT,IAAAA,GAAA,UAAAA,EAAAiD,KAGA,MAAAjD,EAFAT,EAAAS,EAAAT,MAOA,kBAAAA,EACA,OAAAa,KAAA+5B,WAAAmB,GAAA,QACO5wB,IAAAnL,IACPa,KAAAq6B,SAAAa,EAAA/7B,GACAa,KAAA06B,UAAAC,EAAAO,GACAlV,EAAAwO,mBAAAx0B,KAAAw0B,kBAAA0G,GAEAj8B,EAAA8E,IAAA/D,KAAAgB,MAAAiR,QAAAipB,EAAA,WAAAl7B,KAAAgB,MAAA83B,iBAEK,MAAAl5B,GACLiG,QAAAC,MAAAlG,GAIA,OADAomB,KAAA0W,YAAA18B,KAAAgB,MAAA6V,MAAAqkB,GAAAZ,cAAA,GACAn7B,GAEA2tB,YAAA,SAAAtnB,EAAApE,EAAA8I,GACA,IAAAgxB,EAAA11B,EAEAwgB,EAAA/mB,EAAAmB,IAAAJ,KAAAgB,MAAA43B,KAAApzB,GAEA,GAAAwgB,IACAA,YACA5kB,GAAA,CACA,IAAAsD,EAAA+3B,EAAAt7B,KAAA,GAAuBnB,KAAA,GAAUgmB,EAAA,CACjCkV,WACKl7B,KAAAgB,MAAA63B,aAAAqC,IAEL,OADAlV,EAAA5kB,GAAAsD,IAAAiE,EAAAuB,GACA,OAEAyyB,SAAA,SAAAn3B,EAAA0E,GACA,IAAAxK,EAAAM,KAAAqH,SAAA7B,GACA,GAAA9F,KAAA6E,IAAA,OAAA7E,EAAA6E,IAAAq4B,MAAAl9B,EAAAwK,IAEAse,UAAA,SAAAhjB,GACA,OAAAvG,EAAAmB,IAAAJ,KAAAgB,MAAA+G,OAAAvC,IAEAq3B,WAAA,SAAAr3B,EAAArG,GACA,IAAAoP,EAAAvO,KAEAA,KAAAo1B,eAAArG,QAAA,CACAlsB,KAAA,aACA2C,OACArG,UAEA,IAAA29B,EAAAt3B,EAAAvG,EAAAmB,IAAAJ,KAAAgB,MAAA+G,OAAAvC,GAAAxF,KAAAgB,MAAA+G,OAEA+0B,IACAA,EAAA,GAEA79B,EAAA8E,IAAA/D,KAAAgB,MAAA+G,OAAAvC,EAAAs3B,IAGA,IAAAC,EAAA,GACA/8B,KAAAgB,MAAA83B,iBACA,IAAAtkB,EAAAvV,EAAAoL,SAAA7E,KAAAhD,MAAA,KAAAgD,GAAA,GACA,GAAAgP,EAAA9R,QAAA,IAAA8R,EAAA,KAAAA,EAAA,IACA,IAAA9U,EAAA,CACAs9B,QAAA,SAAAtoB,GACA,IAAAJ,EAAAE,EAAA5G,OAAA8G,GACAqoB,EAAAx1B,KAAA+M,GAEArV,EAAA8E,IAAAwK,EAAAvN,MAAAiR,QAAAqC,EAAA7O,KAAA,gBAAA8I,EAAAvN,MAAA83B,kBAWA,QAAAp4B,KARAV,KAAAi9B,WAEAh+B,EAAAyc,aAAAvc,GACAa,KAAAk9B,SAAAJ,EAAA39B,EAAAO,EAAA,IAEAmG,QAAA6D,IAAA,mBAGAqzB,EACA/8B,KAAAm9B,oBAAAJ,EAAAr8B,IACAV,KAAAw7B,iBAAAuB,EAAAr8B,GAAA+E,KAAA,MAGAzF,KAAAo9B,gBAEAH,SAAA,WACAj9B,KAAAgB,MAAAq8B,2BACAr9B,KAAAs9B,cAAAt9B,KAAAgB,MAAAq8B,iCACAr9B,KAAAgB,MAAAq8B,0BAGAr9B,KAAAgB,MAAAu8B,8BACAv9B,KAAAs9B,cAAAt9B,KAAAgB,MAAAu8B,oCACAv9B,KAAAgB,MAAAu8B,8BAGAC,YAAA,SAAAC,EAAAv1B,EAAA9G,GACA,IAAAs8B,GAAA,EAUA,OADA9+B,OAAA++B,sBAPA,SAAAj+B,IACAg+B,IAEAD,IACA7+B,OAAA++B,sBAAAj+B,MAIA,WACAg+B,GAAA,IAGAJ,cAAA,SAAAM,GACA,GAAAA,EACA,OAAAA,KAEAR,aAAA,WACA,IAAAxiB,EAAA5a,KAEAA,KAAAgB,MAAAq8B,2BAEAr9B,KAAAgB,MAAAq8B,yBAAAr9B,KAAAw9B,YAAA,WAEA5iB,EAAAijB,iBACK,gBAELA,cAAA,WACA,IAAAt0B,EAAA7H,OAAA6H,KAAAvJ,KAAAmS,UAEA,MAAA5I,EAAA7G,OAKA,OAJA1C,KAAAs9B,cAAAt9B,KAAAgB,MAAAq8B,0BAEAr9B,KAAA89B,iBAAA,eACA99B,KAAAgB,MAAAq8B,yBAKAr9B,KAAA89B,iBAAAv0B,EAAA,IAAAvJ,KAAAmS,SAAA5I,EAAA,WACAvJ,KAAAmS,SAAA5I,EAAA,IACAvJ,KAAA+9B,mBAAAx0B,EAAA,KAEAy0B,WAAA,WACA,IAAAlW,EAAA9nB,KAEAA,KAAAgB,MAAAu8B,6BACA,GAAAv9B,KAAAgB,MAAAg4B,OAAAC,MAAAv2B,SACA1C,KAAAgB,MAAAu8B,4BAAAv9B,KAAAw9B,YAAA,WACA1V,EAAAmW,uBACK,cAELA,oBAAA,WACA,MAAAj+B,KAAAgB,MAAAg4B,OAAAC,MAAAv2B,OAGA,OAFA1C,KAAAs9B,cAAAt9B,KAAAgB,MAAAu8B,yCACAv9B,KAAAgB,MAAAu8B,4BAIA,IAAAhxB,EAAAvM,KAAAgB,MAAAg4B,OAAAC,MAAAzT,QACA,IAAAjZ,EAAA,OAAA1G,QAAAC,MAAAyG,UAEAvM,KAAAgB,MAAAg4B,OAAAtR,MAAAnb,EAAAzM,IACAE,KAAAk+B,WAAA3xB,IAAAd,OAAAc,EAAA4xB,WAEAJ,mBAAA,SAAAv4B,GACA,GAAAxF,KAAAgB,MAAAsK,SAAA9F,GAAA,CACA,GAAAxF,KAAAgB,MAAAg4B,OAAAtR,MAAAliB,GAAA,OACA,IAAA8F,EAAAtL,KAAAgB,MAAAsK,SAAA9F,GAEA,QAAA9E,KAAA4K,EAAA,CACA,IAAAiB,EAAAjB,EAAA5K,GACAZ,EAAAyM,EAAAzM,IAAA0F,EAAA,MAAA9E,EACAV,KAAAgB,MAAAg4B,OAAAtR,MAAAhnB,KACA6L,EAAA/G,OAAA+G,EAAAd,OAAAjG,GACA+G,EAAA6xB,QAAA7xB,EAAA4xB,SAAAz9B,GACA6L,EAAAzM,KAAAyM,EAAAzM,MACAE,KAAAgB,MAAAg4B,OAAAtR,MAAA5nB,IAAA,EACAE,KAAAgB,MAAAg4B,OAAAC,MAAA1xB,KAAAgF,IAGAvM,KAAAq+B,aACAr+B,KAAAg+B,eAGAK,WAAA,WACAr+B,KAAAgB,MAAAg4B,OAAAC,MAAAh3B,KAAA,SAAAq8B,EAAAC,GACA,OAAAA,EAAAC,SACAF,EAAAE,SACAF,EAAAE,SAAAD,EAAAC,UADA,EADA,KAKAtB,SAAA,SAAAzxB,EAAA0T,EAAAzf,EAAA8F,GACA,QAAA9E,KAAAye,OACA7U,IAAA6U,EAAAze,KAA4CzB,EAAAyc,aAAAyD,EAAAze,KAC5C+K,EAAA/K,KAAA+K,EAAA/K,GAAA,IACAV,KAAAk9B,SAAAzxB,EAAA/K,GAAAye,EAAAze,GAAAhB,EAAA8F,EAAAoI,OAAAlN,KAEA+K,EAAA/K,IAAAye,EAAAze,KACA+K,EAAA/K,GAAAye,EAAAze,GACAhB,EAAAs9B,QAAAx3B,EAAAoI,OAAAlN,OAKA+9B,cAAA,SAAAj5B,EAAArG,EAAAu/B,GACA,IAAAjzB,EAAAxM,EAAAmB,IAAAJ,KAAAgB,MAAA+G,OAAAvC,GAEA,IAAAiG,EAEA,OADAtM,EAAA,CAAAA,GACAa,KAAA+D,IAAAyB,EAAArG,GAAA,EAAAu/B,GAGA,IAAAz6B,EAAAwH,EAAA/I,OACA8R,EAAAvV,EAAA4J,QAAArD,OAAAhD,MAAA,KAEA,OADAgS,EAAAjN,KAAAtD,GACAjE,KAAA+D,IAAAyQ,EAAArV,GAAA,EAAAu/B,IAEAC,YAAA,SAAAn5B,EAAArG,GACAF,EAAA4J,QAAArD,SAAAC,KAAA,MAEA,IAAA42B,EAAAp9B,EAAAmB,IAAAJ,KAAAgB,MAAA43B,KAAApzB,GAEA,IAAA62B,MAAArW,SAAAqW,EAAArW,OAAAjiB,IAAA,SACA,IAAAW,EAAA+3B,EAAAt7B,KAAA,GAAuBnB,KAAA,GAAUq8B,EAAArW,OAAA,GAAkBhmB,KAAAgB,MAAA63B,aAAArzB,IAEnD,OADArG,EAAAk9B,EAAArW,OAAAjiB,IAAAW,EAAAvF,IACA,GAEA4E,IAAA,SAAAyB,EAAArG,EAAAy/B,EAAAF,GACA1+B,KAAAo1B,eAAAkD,WAAA,CACAz1B,KAAA,MACA2C,OACArG,UAGA,IACA,GAAAa,KAAA2+B,YAAAn5B,EAAArG,GACA,OAGA,IAAAsM,EAAAmzB,EAAA5+B,KAAAgB,MAAA43B,KAAA54B,KAAAgB,MAAA+G,OAEA9I,EAAA8E,IAAA0H,EAAAjG,EAAArG,GAGAa,KAAAgB,MAAA83B,iBAEA94B,KAAAm9B,oBAAA33B,EAAAhD,MAAA,MAEAvD,EAAA8E,IAAA/D,KAAAgB,MAAAiR,QAAAzM,EAAA,WAAAxF,KAAAgB,MAAA83B,gBAEA,IAAA+F,EAAA5/B,EAAA4J,QAAArD,KAAAC,KAAA,KAAAD,EACAxF,KAAAw7B,iBAAAqD,GACA7+B,KAAAo9B,eACK,MAAAx9B,GACLiG,QAAAC,MAAAlG,GACK,QACLI,KAAAo1B,eAAAqD,aAGAtmB,SAAA,GACA2rB,iBAAA,GACAgB,iBAAA,EACAjW,aAAA,SAAArjB,EAAAu5B,EAAAC,EAAAC,GACAD,GAAAh/B,KAAA8+B,mBACAC,GAAA/+B,KAAAi9B,WAEAgC,IACAj/B,KAAAgB,MAAA83B,iBACA94B,KAAAk/B,cAAA15B,IAGAxF,KAAAw7B,iBAAAh2B,GAEAu5B,GAAA/+B,KAAAo9B,gBAEA5B,iBAAA,SAAAh2B,GAKA,GAJAxF,KAAAgB,MAAA6V,MAAArR,KACAxF,KAAAgB,MAAA6V,MAAArR,GAAA80B,cAAA,IAGAt6B,KAAAmS,SAAA3M,IAAAxF,KAAAmS,SAAA3M,GAAAs5B,kBAAA9+B,KAAA8+B,iBAAA,CAIA9+B,KAAAmS,SAAA3M,GAAA,CACAs5B,iBAAA9+B,KAAA8+B,iBACA7sB,QAAAjS,KAAAgB,MAAA83B,eACA93B,MAAA,GAEA,IAAAwT,EAAAhP,EAAAhD,MAAA,KACAq8B,EAAArqB,EAAA,GACAxU,KAAAw7B,iBAAAhnB,EAAA,IAEA,QAAA9T,EAAA,EAAmBA,EAAA8T,EAAA9R,OAAA,EAAsBhC,IACzCm+B,GAAA,IAAArqB,EAAA9T,GACAV,KAAAw7B,iBAAAqD,GAGA,IAAAjF,EAAA55B,KAAA25B,cAAAn0B,GAEA,QAAA9E,KAAAk5B,EACA55B,KAAAw7B,iBAAA5B,EAAAl5B,MAGAy+B,iBAAA,SAAA35B,GAKA,IAHA,IAAAgP,EAAAhP,EAAAhD,MAAA,KACAq8B,EAAArqB,EAAA,GAEA9T,EAAA,EAAmBA,EAAA8T,EAAA9R,OAAkBhC,IACrCm+B,GAAA,IAAArqB,EAAA9T,GACAV,KAAAgB,MAAA6V,MAAAgoB,KAAA7+B,KAAAgB,MAAA6V,MAAAgoB,GAAAvE,cAAA,GACAt6B,KAAAo/B,cAAAP,GACA7+B,KAAAq/B,cAAAR,IAGA9B,aAAA,GACAsC,cAAA,SAAA75B,GACA,IAAAo0B,EAAA55B,KAAA25B,cAAAn0B,GACAqR,EAAA7W,KAAAgB,MAAA6V,MAEA,QAAAnW,KAAAk5B,EACA/iB,EAAA+iB,EAAAl5B,MACAmW,EAAA+iB,EAAAl5B,IAAA45B,cAAA,GAGAt6B,KAAAq/B,cAAAxoB,EAAA+iB,EAAAl5B,KACAV,KAAAo/B,cAAAxF,EAAAl5B,KAGA0+B,cAAA,SAAA55B,GACAxF,KAAAgB,MAAAsK,SAAA9F,IACAxF,KAAAs/B,YAAAt/B,KAAAgB,MAAAsK,SAAA9F,OAGA85B,YAAA,SAAApyB,EAAA1H,GACA,QAAA9E,KAAAwM,EACAlN,KAAAk+B,WAAAhxB,EAAAxM,GAAA8E,EAAA9E,IAGAw9B,WAAA,SAAA3xB,EAAA/G,EAAA44B,GACA,GAAAn/B,EAAAG,WAAAmN,EAAAhI,KACA,OAAAgI,EAAAhI,IAAAgI,EAAA/G,EAAA44B,GAGA,IAAA1+B,EAAAT,EAAAmB,IAAAJ,KAAAgB,MAAA+G,OAAAwE,EAAAhI,KAEA,OAAAtF,EAAAG,WAAAM,KAAA6M,EAAA/G,EAAA44B,GAA0D1+B,EAAA6E,IAAA7E,EAAA6E,IAAAgI,EAAA/G,EAAA44B,QAAA,GAE1D75B,IAAA,SAAAiB,EAAArG,KACAogC,YAAA,SAAA9zB,EAAA3I,EAAAiF,EAAA6C,EAAAwxB,EAAAoD,GACA,QAAA9+B,KAAAoC,EACA,WAAApC,EAAA,CACA,IAAAvB,EAAA2D,EAAApC,GAEA,GAAAzB,EAAAoL,SAAAlL,IACA,QAAAA,EAAA0S,OAAA,IACA,IAAA4tB,EAAAtgC,EAAAqvB,OAAA,GAEA4N,KAAAhc,IAAAqf,EAAA/+B,GACAvB,EAAAyL,EAAAvD,SAAAo4B,QACS,GAAAD,EAAA,CACT,IAAAE,EAAAvgC,EACAi9B,KAAAhc,IAAAsf,EAAAh/B,GACAvB,EAAAyL,EAAAvD,SAAAq4B,QAEO,YAAAvgC,EAAAwgC,MACPn6B,KAAArG,EAAAqG,KAAAC,KAAA,KACA22B,KAAAhc,IAAA5a,KAAA9E,GACAvB,EAAAyL,EAAAvD,SAAA7B,OAGA,QAAA8E,IAAAnL,EAAA,gBACA,IAAAuM,EAAAhL,EACA+K,EAAAC,GAAAvM,EACAsM,EAAAtB,MAAAsB,EAAAtB,IAAA,IACAsB,EAAAtB,IAAAuB,GAAA,CACA/D,IAAA7E,EAAApC,GACAgL,KAAAhL,GAIA,OAAA+K,GAEAsa,YAAA,SAAAvgB,EAAArG,GACAa,KAAAo1B,eAAAkD,WAAA,CACAz1B,KAAA,cACA2C,OACArG,UAEA,IAAA+X,EAAA,CACA0oB,QAAA,GACAC,aAAA,GACAxG,SAAA7zB,EAAAhD,MAAA,KACArD,QACAqX,KAAA,GACAspB,QAAA,IAEAC,EAAA//B,KAAAma,QAAAhb,EAAA,GAAA+X,GAEA,GAAAA,EAAAV,KAAA9T,OAAA,CACA,IAAAs9B,EAAA,GAEA,QAAAt/B,KAAAwW,EAAAV,KAAA,CACA,IAAAypB,EAAA/oB,EAAAV,KAAA9V,GAIAs/B,EAFAC,EAAA9gC,OAAA8gC,EAAAz6B,KAAAqY,OAAA,OAEA,CACArY,KAAAy6B,EAAAz6B,KACA8O,SAAA4C,EAAAmiB,SAAAzrB,OAAAqyB,EAAAz6B,OAIA,IAAAgR,EAAAvX,EAAAmB,IAAAJ,KAAAgB,MAAAwV,KAAAhR,EAAA,SAEAgR,GAAAvX,EAAA8E,IAAA/D,KAAAgB,MAAAwV,KAAAhR,EAAA,QAAAgR,EAAA,IAEAvX,EAAAuO,MAAAgJ,EAAAwpB,GAGA,GAAA9oB,EAAA4oB,QAAAp9B,OACA,QAAAhC,KAAAwW,EAAA4oB,QAAA,CACA,IAAAx6B,EAAA4R,EAAA4oB,QAAAp/B,GAEA,cAAA4E,EAAAzC,KAAA,CACA,IACAq9B,EAAA,CACAP,IAAA,WACAn6B,KAHAgR,EAAAlR,EAAAgB,KAGAgO,UAGAhP,EAAA66B,SACAlhC,EAAA8E,IAAAmT,EAAA0oB,QAAAt6B,EAAA86B,KAAAF,GAEAjhC,EAAA8E,IAAA5E,EAAAmG,EAAA86B,KAAAF,OAES,SAAA56B,EAAAzC,MACTyC,EAAA6zB,MAAAkH,YACArgC,KAAAk/B,cAAA55B,EAAAE,MAQA,GAFAu6B,GAAA//B,KAAA+D,IAAAyB,EAAArG,GAAA,MAEA+X,EAAAopB,WAIA,QAAA5/B,KAFAV,KAAA+D,IAAAyB,EAAA0R,EAAA0oB,SAAA,MAEA1oB,EAAA2oB,aAAA,CACA,IAAAU,EAAArpB,EAAA2oB,aAAAn/B,GACAV,KAAAq6B,SAAAkG,EAAA96B,KAAA,SAAyC,GAEzC,IAAAugB,EAAA/mB,EAAAmB,IAAAJ,KAAAgB,MAAA43B,KAAA2H,GAEAva,mBAAAQ,WACAxmB,KAAAgB,MAAAk4B,QAAA3xB,KAAA,CACA/B,KAAA+6B,EAAA96B,KAAA,OAOAzF,KAAAo1B,eAAAqD,YAEAnD,WAAA,WAGA,IAFA,IAAA4D,EAAAl5B,KAAAgB,MAAAk4B,QAEAA,EAAAx2B,QAAA,CACA,IAAAjD,EAAAy5B,EAAA1T,QACAxlB,KAAAqH,SAAA5H,EAAA+F,QAGAg7B,WAAA,SAAAp2B,EAAA5E,GACA,IAEAi7B,EAFAC,EAAAt2B,EAAAu2B,MACAv2B,EAAAnL,EAAA6F,UAAAsF,IAGA,GAAAs2B,EAAAlpB,QAAA,OACAipB,EAAAC,EAAAl+B,MAAA,KACAk+B,EAAAD,EAAAjb,QACApb,EAAAq2B,UAGA,IAAA17B,EAAA/E,KAAAqH,SAAAq5B,GAEA37B,EAAA67B,cAAAH,GACA17B,EAAA67B,aAAAx2B,EAAAq2B,EAAAj7B,GAGA,IAAAxG,EAAAC,EAAA6F,UAAAC,EAAA87B,UAEA,GAAA97B,EAAA+7B,UAAA,CACA,IAAAnoB,EAAA5T,EAAA+7B,UAEA,GAAAnoB,EAAAzT,IACA,QAAAxE,KAAAiY,EAAAzT,IAAA,CACA,IAAAI,EAAAqT,EAAAzT,IAAAxE,GAEA,mBAAA4E,EAAAzC,KAAA,CACA,IAAA1D,EAAAF,EAAAmB,IAAAgK,EAAA9E,EAAA6Z,QAEA7Z,EAAA86B,KAAsCnhC,EAAA8E,IAAA/E,EAAAsG,EAAA86B,KAAAjhC,GAAtCH,EAAAG,OACW,WAAAmG,EAAAzC,KAAA,CACX,IAAAk+B,EAAAz7B,EAAA5F,GAAA0K,EAAA9E,GAEAO,QAAA6D,IAAAq3B,GAEA9hC,EAAA8E,IAAAqG,EAAA9E,EAAA86B,KAAAW,IAKApoB,EAAAwnB,WACAnhC,EAAA,CACAgnB,OAAAhnB,IAYA,YAPAsL,IAAAF,EAAA9D,MAAAtH,EAAAsH,IAAA8D,EAAA9D,KACAtG,KAAAo1B,eAAArG,QAAA,CACAlsB,KAAA,aACA2C,OACA4E,QACApL,QAEAA,GAEAmb,QAAA,SAAAnb,EAAAwG,EAAA0R,GACA,KAAAlY,KAAA2hC,OAAA,CACA,IAAAK,EAAAhhC,KAAAwgC,WAAAxhC,EAAAkY,EAAAmiB,SAAAzrB,OAAApI,IAEA,QAAA9E,KAAA1B,SACAA,EAAA0B,GAGAzB,EAAAuO,MAAAxO,EAAAgiC,GAKA,IAAAjB,GAAA,EAEA,QAAAr/B,KAAA1B,EAAA,CACA,IAAAwb,EAAAhV,EAAAoI,OAAAlN,GAEA,UAAAA,EACAwW,EAAAV,KAAAjP,KAAA,CACAiT,UACAhV,OACArG,MAAAH,EAAA0B,YAEA1B,EAAA0B,QACO,aAAAA,EACPV,KAAAihC,UAAA/pB,EAAA0oB,QAAAp6B,EAAAxG,EAAA0B,GAAAwW,EAAAmiB,SAAAniB,GACAA,EAAA2oB,aAAAt4B,KAAA2P,EAAAmiB,SAAAzrB,OAAApI,WACAxG,EAAA0B,GACAwW,EAAAopB,YAAA,OACO,YAAA5/B,EACPwW,EAAA4oB,QAAAv4B,KAAA,CACA1E,KAAA,QACA2C,KAAA0R,EAAAmiB,SAAAzrB,OAAApI,GAAAC,KAAA,KACAiP,QAAAlP,EACA2zB,MAAAn6B,EAAAm6B,aAEO,GAAAl6B,EAAAoL,SAAArL,EAAA0B,KAAA,KAAA1B,EAAA0B,GAAAmR,OAAA,GACP7S,EAAA0B,GAAAV,KAAAkhC,eAAAliC,EAAA0B,KAAA1B,EAAAwb,EAAAtD,GACA6oB,GAAA,OACO,GAAA9gC,EAAAyc,aAAA1c,EAAA0B,IAAA,CACPV,KAAAma,QAAAnb,EAAA0B,GAAA8Z,EAAAtD,KAIA6oB,GAAA,GAGAA,GAAA,OAEAA,GAAA,EAIA,OAAAA,GAEAmB,eAAA,SAAAx1B,EAAAzH,EAAAjF,EAAAwG,EAAA0R,GACA,eAAAxL,EAAAwL,EAAAmiB,SAAAzrB,OAAApI,IACA0R,EAAA4oB,QAAAv4B,KAAA,CACA1E,KAAA,UACAu9B,KAAA56B,EACAc,IAAAoF,EAAAoG,UAAA,KAEA,CACA6tB,IAAA,mBAIAwB,OAAA,WACA,OAAAnhC,KAAAgB,MAAA8Z,WAEA3T,WAAA,SAAAsE,EAAA0yB,EAAA5xB,GACAvM,KAAAgB,MAAAsK,SAAAG,KAAAzL,KAAAgB,MAAAsK,SAAAG,GAAA,IACAzL,KAAAgB,MAAAsK,SAAAG,GAAA0yB,GAAA5xB,GAEA60B,WAAA,SAAA31B,EAAA0yB,GACA,OAAAn+B,KAAAgB,MAAAsK,SAAAG,GACAzL,KAAAgB,MAAAsK,SAAAG,GAAA0yB,GADA,MAGAkD,WAAA,SAAA51B,EAAA0yB,GACAn+B,KAAAgB,MAAAsK,SAAAG,WACAzL,KAAAgB,MAAAsK,SAAAG,GAAA0yB,IAEA8C,UAAA,SAAArB,EAAAp6B,EAAArG,EAAAk6B,EAAAniB,GACA,GAAAjY,EAAAoL,SAAAlL,GAAA,CACA,IAAAmiC,EAAAjI,EAAAzrB,OAAApI,GAAAC,KAAA,KACA87B,EAAAvhC,KAAAohC,WAAAjiC,EAAAmiC,GACAC,KAAA/7B,MAAAxF,KAAAqhC,WAAAE,EAAA/7B,KAAA87B,GACAthC,KAAAmH,WAAAhI,EAAAmiC,EAAA,CACA/8B,IAAA,oBACAokB,WAAAxpB,EACAqiC,YAAAF,IAEAniC,EAAAa,KAAAqH,SAAAlI,GAGAa,KAAAyhC,cAAAtiC,EAAAk6B,EAAA7zB,EAAAoI,OAAA,UAAAsJ,GAEAjY,EAAA8E,IAAA67B,EAAAp6B,EAAAoI,OAAA,UAAAzO,IAGAsiC,cAAA,SAAAzb,EAAAqT,EAAA1Q,EAAAzR,GACAlX,KAAA0hC,iBAAA1b,EAAA,YAAAhnB,EAAA0M,EAAAlG,GACA,GAAAvG,EAAAoL,SAAArL,IAAA,KAAAA,EAAA6S,OAAA,GACA,eAAA7S,EACAkY,EAAAmiB,SAAAzrB,OAAA+a,IAGAzR,EAAA4oB,QAAAv4B,KAAA,CACA1E,KAAA,UACAu9B,KAAAzX,EAAA/a,OAAApI,GACAc,IAAAtH,EAAA8S,UAAA,GACAquB,UAAA,IAEA,CACA/7B,EAAA,QAKAs9B,iBAAA,SAAA1iC,EAAAwG,EAAAtC,GACA,GAAAlE,GAAAC,EAAA8S,SAAA/S,GAEA,QAAA0B,KAAA1B,EAAA,CACA,IAAAG,EAAA+D,EAAAlE,EAAA0B,KAAA8E,EAAAoI,OAAA,CAAAlN,UAEA4J,IAAAnL,EAKAF,EAAA8S,SAAA/S,EAAA0B,KAAAV,KAAA0hC,iBAAA1iC,EAAA0B,GAAA8E,EAAAoI,OAAA,CAAAlN,IAAAwC,GAJAlE,EAAA0B,GAAAvB,IAOAwiC,OAAA,SAAA7+B,GACA,QAAApC,KAAAoC,EACA9C,KAAA+lB,YAAArlB,EAAAoC,EAAApC,KAGA67B,gBAAA,SAAA/2B,GACA,OAAAxF,KAAAqH,SAAA7B,IAEA0N,WAAA,SAAA1N,GAKA,IAJA,IAAAgP,EAAAhP,EAAAhD,MAAA,KACAyP,GAAA,EACA2vB,EAAA5hC,KAAAgB,MAAAiR,QAEAvR,EAAA,EAAmBA,EAAA8T,EAAA9R,OAAkBhC,IAAA,CACrC,IAAAgL,EAAA8I,EAAA9T,GACA,IAAAkhC,EAAAl2B,GAAA,OAAAuG,GACA2vB,IAAAl2B,IACAuG,YAAA2vB,EAAA3vB,SAGA,OAAAA,GAEA4vB,eAAA,SAAAr8B,GACA,IAAAo8B,EAAA5hC,KAAAgB,MAAAiR,QACA,OAAAhT,EAAAmB,IAAAwhC,EAAAp8B,IAEA23B,oBAAA,SAAA33B,GACA,QAAA9E,EAAA,EAAmBA,EAAA8E,EAAA9C,OAAiBhC,IACpCzB,EAAA8E,IAAA/D,KAAAgB,MAAAiR,QAAAzM,EAAAqY,MAAA,EAAAnd,GAAAkN,OAAA,WAAA5N,KAAAgB,MAAA83B,iBAUAoG,cAAA,SAAA15B,GACAvG,EAAA8E,IAAA/D,KAAAgB,MAAAiR,QAAAzM,EAAA,WAAAxF,KAAAgB,MAAA83B,iBAEAgJ,WAAA,SAAAC,EAAAC,GAiEA,OAhEA,SAAAC,EAAAC,EAAAC,GACA,IAAAljC,EAAA8S,SAAAmwB,KAAAjjC,EAAA8S,SAAAowB,GAAA,OACAhhB,OAAA,CACAyL,KAAAsV,EACAvV,GAAAwV,IAGA,IAAAj+B,EAAA,GACAyN,GAAA,EAEA,QAAAjR,KAAAyhC,EACA,QAAA73B,IAAA43B,EAAAxhC,GACAwD,EAAAxD,GAAA,CACAygB,OAAA,CACAyL,UAAAtiB,EACAqiB,GAAAwV,EAAAzhC,GACAmC,KAAA,UAGA8O,GAAA,OACS,GAAA1S,EAAAG,WAAA+iC,EAAAzhC,KAAAwhC,EAAAxhC,IAAAyhC,EAAAzhC,GAAAnB,YAAA2iC,EAAAxhC,GAAAnB,WACT2E,EAAAxD,GAAA,CACAygB,OAAA,CACAyL,KAAAsV,EAAAxhC,GACAisB,GAAAwV,EAAAzhC,GACAmC,KAAA,qBAGA8O,GAAA,OACS,GAAA1S,EAAA8S,SAAAowB,EAAAzhC,IAAA,CACT,IAAA0hC,EAAAH,EAAAC,EAAAxhC,GAAAyhC,EAAAzhC,IAEA0hC,IACAl+B,EAAAxD,GAAA0hC,EACAzwB,GAAA,QAESwwB,EAAAzhC,IAAAwhC,EAAAxhC,KACTwD,EAAAxD,GAAA,CACAygB,OAAA,CACAyL,KAAAsV,EAAAxhC,GACAisB,GAAAwV,EAAAzhC,GACAmC,KAAA,YAGA8O,GAAA,GAIA,QAAAjR,KAAAwhC,OACA53B,IAAA63B,EAAAzhC,KACAiR,GAAA,EACAzN,EAAAxD,GAAA,CACAygB,OAAA,CACAyL,KAAAsV,EAAAxhC,GACAisB,GAAA,KACA9pB,KAAA,aAMA,OAAA8O,EAAAzN,EAAA,KAGA+9B,CAAAF,EAAAC,IAEAK,IAAA,SAAA78B,EAAA0E,EAAAxF,GACA,IAAAvF,EAAAF,EAAA8S,SAAAvM,KAAAxF,KAAAqH,SAAA7B,GAEAd,IACAA,EAAA1E,KAAA0E,MAGA,IAAA29B,EAAAC,EAAAnhC,KAAAhC,EAAAa,KAAAkK,EAAA1E,EAAAd,GACA,OAAA29B,GAEA39B,GAAA,WACA,IAAAA,EAAA+3B,EAAAt7B,KAAA,GAAuBnB,KAAA,QAAgB,GAAI,IAC3C,OAAA0E,IAIAiC,EAAA+xB,EAAA7xB,QAEAy7B,EAAA,CACA13B,OAAA,KACAzB,QAAA,KACAe,KAAA,KACA/I,KAAA,SAAAgI,EAAAyB,EAAAV,EAAA1E,EAAAd,GACA,IAAAjF,EAAAiC,OAAAC,OAAA3B,MAMA,OALAP,EAAAmL,SACAnL,EAAA0J,UACA1J,EAAAyK,OACAzK,EAAA+F,OACA/F,EAAAiF,KACAjF,GAEA8E,IAAA,SAAAnD,EAAA8I,GACA,OAAAlK,KAAAmJ,QAAA/H,GAAAw7B,MAAA58B,KAAAmJ,QAAA,CAAAe,EAAAlK,KAAA0E,OAGA+3B,EAAA,CACA7xB,OAAA,KACAwxB,OAAA,KACAzjB,KAAA,KACAlH,KAAA,KACAoF,MAAA,KACAlO,EAAA,KACAxH,KAAA,SAAA4G,EAAA6C,EAAAwxB,EAAAzjB,EAAAlH,EAAAoF,GACA,IAAApX,EAAAiC,OAAAC,OAAA3B,MAUA,OATA0B,OAAA4L,OAAA7N,EAAA,CACAsI,SACA6C,SACAwxB,SACAzjB,OACAlH,OACAoF,UAEApX,EAAAkJ,EAAA,GACAlJ,GAEA4iC,IAAA,SAAA78B,EAAA0E,GACA,IAAAm4B,EAAAriC,KAAA4K,OAAAy3B,IAAA78B,EAAA0E,EAAAlK,MACA,OAAAqiC,GAEA/Z,GAAA,SAAAlnB,EAAA8I,GAGA,OAFAlK,KAAAuiC,UAAAviC,KAAAuiC,QAAA57B,EAAAU,SAAA,YAEArH,KAAAuiC,QAAAnhC,GAKApB,KAAAuiC,QAAAnhC,GAAAmD,IAAAvE,KAAAuiC,QAAAnhC,GAAAmD,IAAA2F,EAAAlK,MAA0Ef,EAAAG,WAAAY,KAAAuiC,QAAAnhC,IAAApB,KAAAuiC,QAAAnhC,GAAA8I,EAAAlK,WAAA,GAJ1E6F,QAAA6D,IAAA,MAAAtI,GACA,OAKAoE,KAAA,WACA,OAAAvG,EAAA4J,QAAA7I,KAAAyR,KAAAypB,SAAAl7B,KAAAyR,KAAAypB,QAAAz1B,KAAA,KAAAzF,KAAAyR,KAAAypB,SAEAvmB,MAAA,SAAAK,EAAAvJ,GACA,OAAAzL,KAAAwiC,UAAAxtB,EAAAvJ,IAEA+2B,UAAA,SAAAxtB,EAAAvJ,EAAAvK,GACA,IAAAuuB,EAAAzvB,KAEAyiC,GAAA,GAEAxjC,EAAAoL,SAAA2K,MAAA2qB,OACA8C,GAAA,EACAztB,EAAA,CACA0tB,WAAA1tB,IAIA,IAAAhK,EAAA,GAUA,QAAAtK,KATAV,KAAA4K,OAAA20B,YAAAv0B,EAAAgK,EAAAhV,KAAA+H,OAAA/H,KAAA4K,OAAA,CACAwV,IAAA,SAAA5a,EAAAkG,GACA,GAAA+jB,EAAA2M,OAAA,CACA,IAAAh7B,EAAA,eAAAsK,GAAAxK,GAAA,IAAA0M,OAAAlC,GAAAxK,GAAA,GAEAuuB,EAAA2M,OAAAhc,IAAA5a,EAAApE,EAAAqE,KAAA,UAEK,GAELuF,EACA,GAAAA,EAAAtK,IAAA,UAAAsK,EAAAtK,GAAAmC,KAAA,CACA,IAAA8/B,EAAA,cAAAjiC,GAAAQ,GAAA,IAAA0M,OAAAlN,GAAAQ,EACA8J,EAAAtK,GAAAV,KAAAwiC,UAAAx3B,EAAAtK,GAAA,KAAAiiC,QACO,GAAA33B,EAAAtK,IAAA,SAAAsK,EAAAtK,GAAAmC,WAEA,GAAAmI,EAAAtK,IAAAzB,EAAAoL,SAAAW,EAAAtK,KAAA,KAAAsK,EAAAtK,GAAAmR,OAAA,IACP,IAAA+wB,EAAA,cAAAliC,GAAAQ,GAAA,IAAA0M,OAAAlN,GAAAQ,EAEA8J,EAAAtK,GAAAV,KAAAwiC,UAAAx3B,EAAAtK,GAAAoR,UAAA,QAAA8wB,GAMA,GAFAH,IAAAz3B,IAAA03B,YAEAj3B,EAAA,CACA,GAAAA,EAAAtB,IAAA,CACA,IAAAA,EAAAa,EAAAb,WACAa,EAAAb,IAEAlL,EAAAuO,MAAA/B,EAAAtB,OAIA,OADAzI,OAAA4L,OAAA7B,EAAAT,GACAS,EAEA,OAAAT,GAGA63B,OAAA,SAAAr9B,GAEA,OADAA,EAAAxF,KAAA2I,EAAAwB,IAAA3E,IACAmC,IAAAnC,EAAAmC,IACA1I,EAAAoL,SAAA7E,UAAA,GAEAzB,IAAA,SAAAyB,EAAArG,GAKA,IAJA,IAAAsM,EAAAzL,KAAA2I,EACA6L,EAAAvV,EAAAoL,SAAA7E,KAAAhD,MAAA,KAAAgD,EACAs9B,EAAA,KAEApiC,EAAA,EAAmBA,EAAA8T,EAAA9R,OAAkBhC,IAAA,CACrC,IAAAgL,EAAA8I,EAAA9T,GASA,GAPA+K,EAAAtB,KAAAsB,EAAAtB,IAAAuB,KACAo3B,EAAA,CACA34B,IAAAsB,EAAAtB,IAAAuB,GACA4S,KAAA9J,EAAAqJ,MAAAnd,EAAA,MAIA+K,EAAAC,GACA,MAGAD,IAAAC,GAGA,GAAAo3B,EAAA,CACA,IACAxuB,GADArV,EAAAoL,SAAAy4B,EAAA34B,IAAAxC,KAAAm7B,EAAA34B,IAAAxC,IAAAnF,MAAA,KAAAsgC,EAAA34B,IAAAxC,IAAAnC,MACAoI,OAAAk1B,EAAAxkB,MAAA7Y,KAAA,KACAzF,KAAA4K,OAAA7G,IAAAuQ,EAAAnV,KAGAqoB,OAAA,WACA,IAAAub,EAAArhC,OAAAC,OAAA3B,MAGA,OAFA+iC,EAAAp6B,EAAA,GACAo6B,EAAA3G,OAAA,KACA2G,GAEAC,KAAA,SAAAx9B,GAKA,IAJA,IACAw9B,EADAhjC,KAAA4K,OAAAvD,SAAA7B,GACArE,OAGAT,EAFA,EAEuBA,EAAAuiC,UAAAvgC,OAAsBhC,IAC7CsiC,EAAAE,GAAAD,UAAAviC,IAGA,OAAAsiC,IAIA,IACApkC,OAAA+H,cACA/H,OAAA+H,cACA/H,OAAA85B,gBAGC,MAAA94B,yBCp5CDujC,EAAAC,QAAiBtlC,EAAAulC,EAAuB","file":"static/js/main.0ed755dc.chunk.js","sourcesContent":["import _ from \"lodash\"\nimport faker from \"faker\"\nimport PouchDB from \"pouchdb\"\nimport PouchDBFind from 'pouchdb-find';\nimport PouchDBQuickSearch from 'pouchdb-quick-search';\n\nPouchDB.plugin(PouchDBFind);\nPouchDB.plugin(PouchDBQuickSearch);\n\nvar cu = window.cu;\n\n\nvar ub = {\n\n    ctx: {},\n\n    serialize : function( obj ) {\n        let item = _.cloneDeepWith( obj, function ( value ) {\n            if ( _.isFunction( value ) ) return { TYPE : \"FN\", body : value.toString() };\n        })\n\n        return item;\n    },\n\n    deserialize : function ( obj ) {\n        let item = _.cloneDeepWith( obj, function ( value ) {\n            if ( value && value.TYPE == \"FN\" ) {\n                let fn;\n                try  { \n                    eval( \"fn=\" + value.body )\n                } catch (e ) {\n\n                }\n                return fn;\n            } \n        })\n\n        return item;\n    },\n\n    save: function (value, id) {\n        var db = this.ctx.db;\n\n        let item = this.serialize( value );\n        if (!item.uid) item.uid = id || item.id || this.generateUid();\n        if (!item._id) item._id = item.uid;\n  \n        return db.get(item._id)\n          .then((doc) => {\n            let rev = doc.rev;\n            let _rev = doc._rev;\n\n            item.rev = rev;\n            item._rev = _rev;\n            return db.put(item).then( ( i)=> {\n            })\n          })\n          .catch(err => {\n            return db.put(item);\n          })\n\n\n\n    },\n\n\n\n    load: function (id) {\n        return this.ctx.db.get(id).catch( e => {\n            return null\n        })\n        .then ( item => {\n            if ( item ) item = this.deserialize( item );\n            return item;\n        })\n    },\n\n\n    generateUid : function ( ) {\n        this.cfg.state.nextId++;\n        return this.cfg.state.prefix + \"_\" + this.cfg.state.nextId;\n    },\n\n    init: function (name) {\n        let ctx = {\n            db: new PouchDB(name, {auto_compaction: true}),\n            state: {\n                prefix: new Date().getTime().toString() + \"_\" + Math.random().toString(),\n                nextId: 0,\n                id : \"state\"\n            }\n        }\n\n        let item = Object.create(this);\n\n        item.ctx = ctx;\n\n        item.load(\"state\").then(state => {\n            if ( state ) item.ctx.state = state\n            else item.save( item.ctx.state )\n        })\n\n        return item;\n    },\n\n    destroy : function ( ) {\n        this.ctx.db.destroy( ) \n            .then ( () => {\n\n                alert( \"done cleanup\")\n            })\n    },\n\n    loadfilter : function ( selector, count, sort ) {\n        return this.ctx.db.find( { selector });\n    },\n\n    partialTextSearch : function ( word ) { \n        return this.ctx.db.query( (doc, emit)=> {\n            if ( !doc.text ) return;\n            let tokens = doc.text.split( /\\s+/g );\n            tokens.filter( word => word.length > 2 ).forEach(element => {\n                emit( element, { type : doc.type, map : doc.mapId , parent : doc.parentId ,test : \"salut\"} )\n            });\n        }, {startKey : word, endKey : word + \"\\0\"})\n    },\n\n    searchText : function ( text ) {\n        return this.ctx.db.search( {\n            query: text ,\n            fields: ['title', 'text'],\n            include_docs: true,\n            highlighting: true\n          })\n    },\n\n    loadFromIndex : function ( selector, sortField, sortDir, limit, fields ) {\n        let db = this.ctx.db;\n        //let fields = _.uniq( Object.keys(sort).concat(Object.keys( selector )) );\n\n        if ( !selector[sortField] ) selector[sortField] = { $gt : null };\n        let sort = [_.set( {}, sortField, sortDir ? \"desc\" : \"asc\")]\n        return (\n            db.createIndex(\n                {index : {\n                    fields : fields\n                }}\n            )\n            .then ( (result)=>{\n                return result.name\n            })\n            .then( (index )=>{\n                //db.explain( {selector, limit, sort}) .then( (res)=> console.log( \"explain\", res ))\n                return db.find( {selector , limit, sort}).then( result => result.docs)\n            })\n        ) \n\n    }\n\n\n\n}\n\nvar test = (result) => {\n    result.obj = ub.serialize( {x : function ( ) {} , y : \"test\"})\n\n    result.obj2 = ub.deserialize( result.obj );\n\n    ub.init(\"testdb\")\n}\n\n\ncu.db = {\n    //test,\n    run: function (name) {\n        return ub.init(name);\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nvar cu = window.cu;\n\n\nvar ub = {\n\n    ctx: {\n        tb: {}\n    },\n\n    run: function (model, data, getter) {\n        model = _.cloneDeep(model);\n        let obj = model.mold.tpl;\n\n        this.applyOps(model.mold.ops, obj, data, getter);\n\n\n        if (obj.props)\n            obj.props.tplid = model.uid;\n\n\n        return obj;\n    },\n\n    applyOps: function (ops, obj, data, getter) {\n        let get = getter || _.get;\n\n        let newOps = [];\n        for (var i = 0; i < ops.length; i++) {\n\n            let op = ops[i];\n\n            if (op.type == \"value\") {\n                let value = get(data, op.action, op, newOps);\n                _.set(obj, op.path, value)\n            }\n            else if (op.type == \"computedValue\") {\n                let value = op.value;\n                _.set(obj, op.path, value)\n            }\n            else if (op.type == \"concat\") {\n                let value = get(obj, op.path, op, newOps).join(\"\");\n                _.set(obj, op.path, value)\n            }\n            else if (op.type == \"pathSet\") {\n                let value = get(obj, op.path, op, newOps);\n\n                _.set( obj, value.PATH, value.VALUE );\n                _.unset( obj, op.path )\n            }\n            else if (op.type == \"makeFunction\") {\n                let body = get(obj, op.path, op, newOps).join(\"\");\n                try {\n                    let fn;\n                    eval(\"fn=\" + body)\n\n                    _.set(obj, op.path, fn)\n                }\n                catch (e) {\n                    console.error ( \"makeFunction::\" + body)\n                }\n            }\n        }\n\n        if (newOps.length)\n            this.applyOps(newOps, obj, data, getter)\n    },\n\n\n}\n\n\nvar inputs = {\n    data: {\n        \"#color\": 12,\n        \"#handle\": \"handle\",\n        \"#test2\": \"test2\",\n        \"#test1\": \"test1\",\n        \"#title\": \"title it is\",\n    }\n}\n\nvar test = (result) => {\n\n    let mold = cu.tests.get(\"mold.x\");\n\n    if (!mold) return \"pending\";\n\n    let value = ub.run(mold, inputs.data);\n\n    result.value = value;\n    result.mold = mold;\n\n    cu.tests.pin(\"reactTree\", value)\n\n    //result.mold = value;\n}\n\ncu.reactAssembler = {\n    //test,\n\n    run: function (mold, data, getter) {\n        return ub.run(mold, data, getter)\n    },\n\n    init: function () {\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}\n\ncu.moldAssembler = cu.reactAssembler;","\nimport React, { Component } from 'react';\nimport { UnControlled as CodeMirror } from 'react-codemirror2'\nimport 'codemirror/lib/codemirror.css';\nrequire('codemirror/mode/javascript/javascript');\n\nclass CodeMirrorEditor extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {};\n\n    this.changeValue = this.changeValue.bind(this);\n    this.changeCursor = this.changeCursor.bind(this);\n    this.isBlured = this.isBlured.bind(this);\n  }\n\n  changeValue(editor, data, value) {\n\n    if (!this.props || !this.props.valueChanged)\n      return;\n\n    //window.editor = editor;\n\n\n    let cursor = editor.getCursor();\n    if (data.origin != undefined) {\n      this.props.valueChanged({ scode: value, cursor: { line: cursor.line, ch: cursor.ch } });\n    }\n    else {\n      this.props.valueChanged({ scode: value })\n    }\n\n    this.setState({ caret: editor.cursorCoords(true, \"local\") })\n  }\n\n  changeCursor(editor, cursor) {\n    this.setState({ caret: editor.cursorCoords(true, \"local\") })\n\n    if (cursor.sticky == undefined) return;\n\n    if (!this.props || !this.props.valueChanged)\n      return;\n\n    this.props.valueChanged({ cursor: { line: cursor.line, ch: cursor.ch } });\n\n  }\n  isBlured() {\n    if (this.props.blured)\n      this.props.blured()\n  }\n\n  render() {\n\n    //this means that setting the value with null will delete the value from wallet ?!?\n    let text = this.props.data.scode || \"\";\n    if (!text.length) text = \"\";\n\n    let cursor = this.props.data.cursor;\n    if (!cursor || !cursor.ch) cursor = 0;\n\n    let popup;\n    let caret = this.state.caret || { right : 0, bottom : 0} \n    if (caret) {\n\n      let left = caret.right + 30;\n      let top = caret.bottom + 0;\n\n      popup = <div className=\"popup\" style={{ transform: \"translate(\" + left + \"px ,\" + top + \"px)\", zIndex: 100 }} > Salut  </div>\n    }\n    else popup = null;\n\n    let style = `\n      .popup { border : 1px solid #999; background : #bbb; padding : 10px; min-width:40px; width : 100px; transition : all 0.2s ease; }\n\n      .popup { opacity : 0.05; position : absolute;pointer-events: none;}\n    `\n    return <div style={{position:\"relative\"}}>\n      <style>{style}</style>\n      {popup}\n      <CodeMirror\n        value={text}\n\n        options={{\n          mode: 'javascript',\n          lineNumbers: true, \n          smartIndent : true,\n        }}\n\n        autoCursor={false}\n\n        cursor={cursor}\n        ///onBeforeChange={this.changeValue}\n        onChange={this.changeValue}\n        onCursor={this.changeCursor}\n        onBlur={this.isBlured}\n      />\n    </div>\n  }\n}\n\nexport default CodeMirrorEditor;","import React, { Component } from 'react';\nimport _ from \"lodash\";\nimport $ from \"jquery\";\nimport go from \"gojs\";\nimport \"../libs/dataManager\";\nvar DataManager = window.DataManager;\n\n\nvar KeyboardManager = {\n    setup: function () {\n        if (this.isInitialized) return;\n\n        $(\"body\").on(\"keydown\", (evt) => {\n            this.handleKey(evt)\n        })\n\n        DataManager.setTrigger(\"keyboardShortcuts.layout\", \"kbdManager\", {\n            run: () => {\n                this.load();\n            }\n        })\n        this.load();\n    },\n\n    load: function () {\n        let layout = DataManager.getValue(\"keyboardShortcuts.layout\");\n        this.layout = layout || {};\n    },\n\n    handleKey: function (evt) {\n        var name = [];\n        if (evt.altKey) name.push(\"alt\");\n        if (evt.ctrlKey) name.push(\"ctrl\");\n        if (evt.metaKey) name.push(\"meta\");\n        if (evt.shiftKey) name.push(\"shift\");\n\n        name.push(evt.key.toLowerCase())\n        let comb = name.join(\"+\");\n\n        if (this.layout[comb])\n            return this.run(this.layout[comb], comb)\n    },\n\n    run: function (action,comb) {\n        if (_.isFunction(action)) return action(comb, action);\n        else if (action.run)\n            return action.run(comb, action)\n    }\n}\n\nKeyboardManager.setup();\n\nexport default KeyboardManager","var TimerManager = {\n    init : function ( DataManager ) {\n      var item = Object.create( this );\n\n      item.DataManager = DataManager;\n      item.wallet = {timers : {} }\n      return item;\n    },\n    wallet: { timers: {} },\n  \n    start: function (name, action, delay) {\n      if (this.wallet.timers[name]) window.clearTimeout(this.wallet.timers[name]);\n  \n      var timer = window.setTimeout(() => {\n        this.cancel( name );\n        action(name, action, delay);\n      }, delay)\n  \n      this.wallet.timers[name] = timer;\n\n      let date = new Date();\n      this.DataManager.set(\"TimerManager.timer.\"  + name , { start : date.getTime(), end : date.getTime() + delay })\n    },\n  \n    cancel: function (name) {\n      if (this.wallet.timers[name]) window.clearTimeout(this.wallet.timers[name]);\n      delete this.wallet.timers[name]\n      this.DataManager.set(\"TimerManager.timer.\"  + name , \"\")\n\n    }\n  }\n\n  export {TimerManager};","\nvar cu = {}\n\nwindow.cu = cu;\n\nexport default cu;\n","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\n\nvar actionsBundle = {}\n\nactionsBundle.db = {\n\n    saveItems : function ( op, v ) {\n        let items = _.isArray( op.items ) ? op.items : [op.items]\n        v.tb.db.saveItems( cu.uids.run() , items )\n    },\n\n    loadItem: function (op, v) {\n\n        let promise;\n        let loadedItems;\n\n        if ( op.append && v.data[ op.append ]) {\n            loadedItems =  v.data[ op.append ];\n        }\n\n        v.tb.db.loadItems([op.id], loadedItems ).then(item => {\n\n            if (v.cancel) return;\n\n            if (op.append)\n                v.actions.appendById({ path: op.append, value: item }, v)\n\n\n            if (op.pin)\n                v.actions.setValue({ path: op.pin, value: item[0] }, v)\n\n        })\n    },\n\n    loadItems: function (op, v) {\n        let ids = _.isArray(op.ids) ? op.ids : Object.keys(op.ids);\n        let loadedItems;\n\n        if ( op.append && v.data[ op.append ]) {\n            loadedItems =  v.data[ op.append ];\n        }\n\n        v.tb.db.loadItems(ids, loadedItems).then(items => {\n\n            if (v.cancel) return;\n\n\n            if (op.append) {\n                v.actions.appendById({ path: op.append, value: items }, v)\n            }\n            if (op.pin)\n                v.actions.setValue({ path: op.pin, value: items }, v)\n        })\n    },\n\n\n    loadFromIndex : function ( op, v ) {\n        v.tb.db.loadFromIndex( op ).then( items => {\n\n            if (v.cancel) return;\n\n\n            if (op.append) {\n                v.actions.appendById({ path: op.append, value: items }, v)\n            }\n            if (op.pin)\n                v.actions.setValue({ path: op.pin, value: items }, v)\n        } )\n    },\n\n    searchItems: function (op, v) {\n        let filter = op.filter;\n\n        v.tb.db.loadFilter(filter).then(docs => {\n\n            let items = docs.docs;\n\n            if (v.cancel) return;\n\n\n            console.log(\"filter items\", items);\n\n\n            if (op.append) {\n                v.actions.appendById({ path: op.append, value: items }, v)\n            }\n            if (op.pin)\n                v.actions.setValue({ path: op.pin, value: items }, v)\n        })\n    },\n\n\n    searchText: function (op, v) {\n        this.tb.db.searchText(op.text).then(items => {\n\n            if (v.cancel) return;\n\n\n            if (op.pin)\n                v.actions.setValue({ path: op.pin, value: items }, v)\n        })\n    },\n\n}\nactionsBundle.core = {\n    triggerRerun: function (val, v) {\n        if (v.running) {\n            v.shouldRerun = true;\n        }\n        else {\n            v.actions.runAllOps({}, v);\n        }\n    },\n\n    prepareOp: function (op, v) {\n        let args = { src: {} };\n        for (var i in op.input) {\n            if (i == \"type\") args.type = op.input[i];\n            else if (!_.isString(op.input[i])) args[i] = op.input[i]\n            else {\n                args.src[i] = op.input[i];\n                let value = v.actions.getValue(op.input[i], v);\n                if (value === undefined) {\n                    if (!op.partial)\n                        return null;\n                    else {\n                        if (!args.missing) args.missing = [];\n                        args.missing.push(i);\n                    }\n                }\n                else args[i] = value;\n            }\n        }\n        for (var i in op) {\n            if (i != \"input\")\n                args[i] = op[i]\n        }\n\n        args.OP = op;\n\n        return args;\n    },\n    runOp: function (op, v) {\n        if (!op.uid) op.uid = v.actions.getUid(\"\", v);\n        let args = v.actions.prepareOp(op, v);\n        if (args === null) {\n            return \"notcomplete\";\n        }\n\n        if (args.name) args.pin = args.name;\n\n        if (!v.actions[args.type]) {\n            console.error({ v, args, op })\n        }\n        let value = v.actions[args.type](args, v);\n\n        if (value === \"notcomplete\") return \"notcomplete\";\n    },\n\n    getUid: function (args, v) {\n        v.master.state.nextId++;\n        let id = \"op_\" + v.master.state.nextId;\n        return id;\n    },\n\n    opIsDone: function (op, v) {\n        if (op.partial) return false;\n        if (!op.pin) return false;\n\n        return _.get(v.data, op.pin) !== undefined;\n\n    },\n    runAllOps: function (args, v) {\n        v.ncOps = [];\n\n        v.running = true;\n        v.shouldRerun = false;\n\n        for (var i in v.ops) {\n            let op = v.ops[i];\n\n            let isDone = v.actions.opIsDone(op, v)\n            if (!isDone) {\n                let value = v.actions.runOp(op, v);\n\n                if (value === \"notcomplete\") v.ncOps.push(op)\n                else v.shouldRerun = true;\n            }\n        }\n\n        v.ops = v.ncOps;\n\n        v.running = false;\n\n        if (v.shouldRerun) {\n            v.shouldRerun = false;\n            this.runAllOps(args, v)\n        }\n\n        else {\n            if (v.ncOps.length == 0) {\n                v.actions.checkGuards({ path: \"DONE\" }, v)\n            }\n            else {\n                //console.log( \"pending\", {v})\n            }\n        }\n\n\n\n    },\n\n}\n\nactionsBundle.values = {\n    pinTo: function (args, value, v) {\n        if (args.pin) {\n            v.actions.setValue({ path: args.pin, value: value }, v)\n        }\n    },\n\n    staticValue: function (args, v) {\n        v.actions.pinTo(args, args.value, v)\n    },\n\n    getValue: function (path, v) {\n        if (v.privat) return this.getFromPrivate( path, v );\n        if (v.prefix) return this.getValueWithPrefix(path, v)\n        return _.get(v.data, path);\n    },\n\n    getFromPrivate : function ( path, v  ) {\n        let value = _.get( v.privat, path );\n        if ( value != undefined ) return value;\n\n        if (v.prefix) return this.getValueWithPrefix(path, v)\n\n        return _.get(v.data, path);\n    } ,\n\n    getValueWithPrefix: function (path, v) {\n        let value = _.get(v.data, v.prefix + \".\" + path);\n        if (value === undefined) value = _.get(v.data, path);\n        return value;\n    },\n\n\n    checkGuards: function (val, v) {\n\n        var triggers = v.triggers[val.path];\n\n        if (triggers) {\n\n            if (!_.isArray(triggers)) triggers = [triggers];\n\n            triggers.forEach(item => {\n                if (_.isFunction(item))\n                    item(val.path, val.value, val.isPartial, v)\n                else if (item.run)\n                    item.run(val.path, val.value, val.isPartial, v)\n\n            })\n\n        }\n\n        if (v.guards) {\n            var triggers = v.guards[val.path];\n\n            if (triggers) {\n\n                if (!_.isArray(triggers)) triggers = [triggers];\n\n                triggers.forEach(item => {\n                    if (_.isFunction(item))\n                        item(val.path, val.value, val.isPartial, v)\n                    else if (item.run)\n                        item.run(val.path, val.value, val.isPartial, v)\n\n                })\n            }\n        }\n\n    },\n\n\n    setValue: function (val, v) {\n        let path = val.path;\n\n        if (v.privat) {\n            _.set( v.privat, path, val.value )\n        }\n\n        else {\n            if (v.prefix) path = v.prefix + \".\" + val.path;\n\n            _.set(v.data, path, val.value);\n        }\n\n        this.checkGuards(val, v)\n\n        if (val.isPartial) return;\n\n        v.actions.triggerRerun({}, v)\n\n\n    },\n\n\n    appendById: function (val, v) {\n        let target = _.get(v.data, val.path);\n        if (!target) {\n            target = {};\n            _.set(v.data, val.path, target);\n        }\n\n        let value = val.value;\n        for (var i in value) {\n            if ( !value[i]) {\n                continue;\n            }\n            let slot = value[i].id\n            if ( !target[slot] )\n            target[slot] = value[i];\n        }\n\n\n        if (val.isPartial) return;\n\n        v.actions.triggerRerun({}, v)\n    },\n}\n\nactionsBundle.generic = {\n    log: function (val, v) {\n        let obj = {};\n        for (var i in val.OP.input) {\n            obj[i] = val[i]\n        }\n        console.log(\"log\", obj, v);\n    },\n\n    fn: function (op, v) {\n        if (!op.fn) return;\n        let result\n\n        if (op.fn.run)\n            result = op.fn.run(op, v);\n        else\n            result = op.fn(op, v);\n\n        if (result === \"notcomplete\") return result;\n\n        if (op.pin) {\n            v.actions.setValue({ path: op.pin, value: result }, v)\n        }\n    },\n\n    assembleObj: function (args, v) {\n        let obj = {};\n\n        for (var i in args.OP.input) {\n            obj[i] = args[i]\n        }\n\n        if (args.partial && args.pin && args.missing) {\n\n            if (!v.opState[args.uid]) v.opState[args.uid] = { missing: [] }\n\n\n            obj.partial = true;\n\n            if (_.isEqual(args.missing, v.opState[args.uid].missing)) {\n                return \"notcomplete\";\n            }\n            else\n                v.opState[args.uid].missing = args.missing;\n\n            v.actions.setValue({ path: args.pin, value: obj, isPartial: args.missing ? \"skipRerun\" : false }, v)\n        }\n\n        else if (args.pin && !args.missing)\n            v.actions.setValue({ path: args.pin, value: obj }, v)\n\n        if (args.missing) return \"notcomplete\";\n\n    },\n\n}\n\nactionsBundle.tpls = {\n    listTemplate: function (args, v) {\n        let list = [];\n\n        for (var i in args.list) {\n            let item = cu.moldAssembler.run(args.tpl, args.list[i]);\n            list.push(item)\n        }\n\n\n        if (args.pin) {\n            v.actions.setValue({ path: args.pin, value: list }, v)\n        }\n\n        return list;\n    },\n\n    useTpl: function (args, v) {\n        let list = [];\n        let isPartial = false;\n\n        let item = cu.moldAssembler.run(args.tpl, args, function (data, path) {\n            let value = _.get(data, path);\n            if (value === undefined) value = _.get(v.data, path);\n\n            if (value === undefined) {\n                value = \"\";\n                isPartial = true;\n            }\n\n            return value;\n        });\n\n        if (args.pin) {\n            v.actions.setValue({ path: args.pin, value: item, isPartial: isPartial }, v)\n        }\n\n        return item;\n    },\n}\n\nvar flowGuards = {\n\n    makeTriggers: function (guards) {\n\n        let triggers = {};\n\n        for (var i in guards)\n            triggers[i] = this.makeTrigger(i, guards[i])\n        return triggers;\n    },\n\n    makeTrigger: function (index, guard) {\n        let tb = guard.tb;\n        let name = guard.name;\n        let trigger = function (path, result, partial, v) {\n            let triggerName = name || path;\n            console.log(\"should trigger\", { tb, name, result, partial })\n            v.master.tb[tb].trigger(name, result, partial)\n        }\n        return trigger;\n    }\n}\nvar ub = {\n\n    setup: function (opt) {\n        let item = Object.create(this);\n\n        item.ctx = {\n            actions: {},\n            opsCollection: opt.opsCollection || {},\n            data: opt.data || {},\n            triggers: {},\n            valuesChain: {}\n        };\n\n        item.state = {\n            nextId: 1,\n            open: {},\n        };\n\n        item.tb = opt.tb || {};\n\n        item.addTriggers(opt.triggers);\n\n        item.addActionsCollection(actionsBundle);\n\n        if (opt.actions)\n            item.addActionsCollection(opt.actions);\n\n\n        if (opt.ops)\n            item.addMainOps(opt.ops)\n\n        if (opt.guards)\n            item.addTriggers(flowGuards.makeTriggers(opt.guards));\n\n        if (opt.valuesChain)\n            item.addValuesChains(opt.valuesChain)\n        return item;\n    },\n\n    addValuesChains: function (chains) {\n        for (var i in chains) {\n            let chain = chains[i];\n            if (_.isString(chain.unset)) chain.unset = chain.unset.split(\",\");\n\n            this.ctx.valuesChain[i] = chain;\n        }\n    },\n    addActionsCollection: function (collection, info) {\n\n        for (var i in collection) {\n            if (_.isString(collection[i]))\n                this.fetchCollection(collection, i, collection[i])\n        }\n\n        for (var i in collection)\n            this.addActions(collection[i], Object.assign({}, info, { slot: i }))\n    },\n\n    fetchCollection: function (target, name, path) {\n        let values = _.cloneDeep(cu.DataManager.getValue(path));\n\n        if (values.isCollection) {\n            _.unset(target, name);\n            delete values.isCollection;\n\n            for (var i in values) {\n                if (_.isString(values[i]))\n                    this.fetchCollection(values, i, values[i])\n            }\n            _.merge(target, values)\n        }\n        else {\n            target[i] = values;\n        }\n    },\n\n    addActions: function (actions, info) {\n        const getAction = function (action) {\n            return function (args, v) {\n                return action.run(args, v)\n            }\n        }\n        for (var i in actions) {\n            let action = actions[i];\n            if (action.run) action = getAction(action)\n            this.ctx.actions[i] = action\n        }\n    },\n\n    addOps: function (name, ops) {\n        this.ctx.opsCollection[name] = ops;\n    },\n\n    addMainOps: function (ops) {\n        this.addOps(\"main\", ops)\n    },\n\n    addTriggers: function (triggerCollection) {\n        for (var i in triggerCollection) {\n            let triggers = triggerCollection[i];\n            if (!_.isArray(triggers)) triggers = [triggers];\n\n            if (this.ctx.triggers[i]) triggers = this.ctx.triggers[i].concat(triggers);\n\n            this.ctx.triggers[i] = triggers;\n\n        }\n    },\n\n    run: function (opName, values, guards, extra ) {\n\n        opName = opName || \"main\";\n\n        if (values)\n            this.changeData(values)\n\n        let ops = this.ctx.opsCollection[opName];\n\n        if (!ops) return;\n\n        let v = this.getOpen(opName);\n        v.ops = ops;\n\n        delete v.guards;\n        if (guards) v.guards = guards;\n\n\n        _.merge( v, extra );\n        \n        if ( extra &&  extra.privat )\n            v.privat = extra.privat\n        else\n            delete v.privat\n\n        this.ctx.actions.runAllOps({}, v);\n    },\n\n    getOpen: function (name) {\n        if (this.state.open[name]) return this.state.open[name];\n\n        let v = {\n            master: this,\n            data: this.ctx.data,\n            actions: this.ctx.actions,\n            tb: this.tb,\n            triggers: this.ctx.triggers\n        }\n\n        this.state.open[name] = v;\n\n        return v;\n    },\n\n    cancel: function (name) {\n        let open = this.state.open[name];\n\n        open.cancel = true;\n\n        delete this.state.open[name];\n    },\n\n    changeData: function (data) {\n\n        for (var i in data) {\n            if (this.ctx.valuesChain[i])\n                this.applyValuesChain(i, data[i], this.ctx.valuesChain[i])\n        }\n\n        for (var i in data) {\n            let path = i;\n            let value = data[i];\n            if (value === null)\n                _.unset(this.ctx.data, path)\n            else\n                _.set(this.ctx.data, path, value)\n        }\n\n    },\n\n    applyValuesChain: function (path, value, chain) {\n        let unset = chain.unset\n        if (unset)\n            unset.forEach(slot => _.unset(this.ctx.data, slot))\n\n        if ( chain.reset ) {\n            for ( var i in chain.reset )\n            this.ctx.data[i] = chain.reset[ i ].value \n        }\n    }\n\n\n\n}\n\nvar test = (result) => {\n    let flow = ub.setup({\n        data: {},\n        ops: [\n            { pin: \"obj\", type: \"assembleObj\", input: { s1: \"salut\", s2: \"outcome\" } },\n            //{ type: \"log\", input: { salut: \"obj\" } },\n            { pin: \"salut\", type: \"fn\", fn: () => \"test\" + Math.random() },\n            { pin: \"outcome\", type: \"fn\", input: { a: \"salut\" }, fn: (v) => v.a + \" ready\" + Math.random() }\n        ],\n\n        xtriggers: {\n            \"outcome\": (path, value, partial) => { console.log(\"outcome\", { path, value, partial }) },\n            \"salut\": {\n                run: (path, value, partial) => { console.log(\"salut\", { path, value, partial }) },\n            },\n        }\n    });\n\n    flow.run(\"main\");\n\n    result.flow = flow;\n    result.data1 = _.cloneDeep(flow.ctx.data);\n\n\n    flow.changeData({ \"outcome\": null })\n\n    flow.run(\"main\");\n    result.data2 = _.cloneDeep(flow.ctx.data);\n\n}\n\ncu.actionFlow = {\n    //test,\n\n    setup: function (specs) {\n        return ub.setup(specs);\n    },\n\n    setupFlow: function (opts) {\n        _.merge(this, opts)\n\n        this.actionsFlow = cu.actionFlow.setup(this);\n\n        this.run = (name, value, guards,refreshOpen) => { this.actionsFlow.run(name, value, guards,refreshOpen) }\n\n        this.actionsFlow.run(\"setup\")\n        console.log(\"actionFlow\", this)\n    },\n    run: function () {\n        // return ub.run(name);\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nimport chroma from \"chroma-js\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n  getRandomFn: function (str) {\n    var seed = 0;\n    for (var i in str) {\n      seed += str.charCodeAt(i) * i\n    }\n    function getRandom() {\n      var x = Math.sin(seed++) * 10000;\n      return x - Math.floor(x);\n    }\n\n    return getRandom;\n\n  },\n\n  getBrand: function (uid) {\n    let randomFn = this.getRandomFn(uid);\n\n    let baseBrand = {\n      mainColor: \"#007abc\",\n      complementColor: \"\"\n    }\n\n    let brand = {\n      mainColor_hsl: this.getColor(randomFn(), baseBrand.mainColor),\n      complementColor_hsl: this.getColor(randomFn(), baseBrand.mainColor),\n    }\n\n    brand.mainColor = \"hsl( \" + brand.mainColor_hsl[0] + \",\" + brand.mainColor_hsl[1] + \"% ,\" + (brand.mainColor_hsl[2]) + \"%  )\"\n    brand.complementColor = \"hsl( \" + brand.complementColor_hsl[0] + \",\" + brand.complementColor_hsl[1] + \"% ,\" + (brand.complementColor_hsl[2]) + \"%  )\"\n\n    brand.fadedColor = \"hsla( \" + brand.mainColor_hsl[0] + \",\" + 10 + \"% ,\" + (brand.mainColor_hsl[2]) + \"%, 1 )\"\n\n    return brand;\n  },\n\n  getColor: function (seed, baseColor) {\n\n    baseColor = baseColor || \"#007abc\";\n    let hue = seed * 360;\n    let color = chroma(\"#007abc\").set(\"hsi.h\", hue).hsl();\n\n    color[1] = color[1] * 100;\n    color[2] = color[2] * 100;\n\n    return color;\n  },\n  get: function (seed, count) {\n\n    var str = seed; //faker.lorem.sentence(10);\n    var seed = 0;\n    for (var i in str) {\n      seed += str.charCodeAt(i) * i\n    }\n    function getRandom() {\n      var x = Math.sin(seed++) * 10000;\n      return x - Math.floor(x);\n    }\n\n    count = Math.max(2, Math.floor((getRandom() * 5)))\n\n\n\n    let scale = 50 / count;\n\n    let color = this.getColor(getRandom());\n\n    let pointsStar = [\n      [0, 0, 0.5, 0.5, 1, 0],\n      [0, 0, 0.5, 0.5, 0, 1],\n      [1, 1, 0.5, 0.5, 0, 1],\n      [1, 1, 0.5, 0.5, 1, 0],\n    ]\n\n\n\n    let polies = [];\n    for (var i = 0; i < count; i++) {\n      for (var j = 0; j < count; j++) {\n        let lum = 10; //points[i][j];\n        let x = i * scale;\n        let y = j * scale;\n        let poly = pointsStar.map((poligonPoints) => {\n          let col = \"hsl( \" + color[0] + \",\" + color[1] + \"% ,\" + (color[2]) + \"%  )\";\n          let classname = Math.round(getRandom() * 5);\n          let points = poligonPoints.map((value, i) => {\n            return value * scale + (i % 2 ? x : y)\n          })\n          polies.push(`<polygon\n                  class='poligon poligon_${classname}'\n                  points=\"` + points.join(\" \") + `\" stroke=\"transparent\" fill=\"transparent\" \n                  style=\" strokeWidth: ` + (1 / scale) + `;\n                  fill: `+ col + `;\n                  opacity : `+ getRandom() + `; \n                  \" />`)\n\n        })\n      }\n    }\n\n    return \"<svg style='position :relative;width: inherit; height: inherit;'> \" + polies.join(\"\") + \"</svg>\"\n\n\n  }\n}\n\nvar test = (result) => {\n\n}\n\ncu.brand = {\n  //test,\n\n  getLogo: function (seed, scale, count) {\n    let logo = ub.get(seed, count);\n    return logo;\n  },\n\n  getBrand: function (uid) {\n    return ub.getBrand(uid);\n  },\n\n  def: `\n    `,\n\n  debug: {\n    ub: ub\n  }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nimport { types } from \"util\";\nvar cu = window.cu;\n\nvar ub = {\n}\n\n\nvar test = (result) => {\n\n}\n\ncu.bubbleBoard = {\n    //test,\n\n    init: function () {\n    },\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n    },\n\n\n    addItem : function ( obj ) {\n        let id = this.getId();\n        obj.id = id;\n        this.mergeItem( id, obj );\n        return id;\n    },\n\n    getId : function ( ) {\n        this.ctx.data.state.nextId++;\n\n        let id = \"bubble_\" + this.ctx.data.state.nextId;\n\n        return id;\n    },\n    mergeItem: function (id, value) {\n        let ctx = this.ctx;\n        let result = ctx.data.result[id];\n\n\n        ctx.changed = {};\n\n        this.appendTo(id, value)\n\n        let minStep;\n        let results = ctx.data.result;\n        let changed = ctx.changed;\n\n        console.log( ctx.data );\n        let versions = ctx.data.versions;\n\n        for ( var i in changed ) {\n            if ( !versions[i] ) versions[i] = 0;\n            versions[i]++;\n            let result = results[ i ];\n            if ( !result ) continue;\n            if ( !result.isReady ) continue;\n            if ( minStep == undefined ) minStep = result.completedAt;\n            if ( minStep > result.completedAt ) minStep = result.completedAt;\n        }\n\n        if (minStep !== undefined) {\n            this.rewindTo(minStep)\n        }\n\n\n        if ( this.ctx.tb.onchanged)\n            this.ctx.tb.onchanged( changed )\n        \n        return minStep;\n    },\n\n    rewindTo: function (step) {\n        let ctx = this.ctx;\n        for (var id in ctx.data.result) {\n            let result = ctx.data.result[id];\n            if (result.isReady && (result.completedAt >= step || result.createdAt > step)) {\n                result.isReady = false;\n                result.completedAt = 0;\n            }\n        }\n\n        ctx.data.step = step;\n    },\n\n    appendTo: function (id, values) {\n        let ctx = this.ctx;\n        let item = ctx.data.items[id];\n        let hasChanges = false;\n\n        if (!item) {\n            ctx.data.step++;\n            ctx.data.items[id] = item = {}\n            ctx.data.result[id] = { createdAt: ctx.data.step }\n            hasChanges = true;\n        }\n\n        for (var slot in values) {\n            let value = values[slot];\n            if ( value == \"REMOVE\" && item[slot] !== undefined ) {\n                delete item[slot];\n                hasChanges = true;\n                continue;\n            }\n            if ( value === null && item[slot] !== undefined ) {\n                delete item[slot]\n                hasChanges = true;\n                continue;\n\n            }\n\n            if ( !value ) continue;\n\n            let bubbleid = item[slot] ? item[slot].id : null;\n            if (_.isString(value) && value.charAt(0) == \"#\") {\n                value = {id : value.substring(1) };\n            }\n\n            if ( value.id !== undefined) {\n                if ( value.id == \"#\"  || value.id==\"\" ) value.id = null;\n                value.id = value.id || bubbleid || this.getId();\n                item[slot] = { id: value.id };\n            }\n\n\n            if (value.id && _.isObject(value)) {\n                if ( value.id != bubbleid ) hasChanges = true;\n                this.appendTo(value.id, value)\n            }\n\n            else if ( _.isObject( value ) && !_.isMatch(item[slot], value )) {\n                hasChanges = true;\n                item[slot] = value;\n            }\n            else if ( item[slot]!=value) {\n                hasChanges = true;\n                item[slot] = value;\n            }\n\n        }\n\n        if( hasChanges ) {\n            if ( item.version ) {\n                item.version = item.version ? item.version+1 : 1;\n            }\n            this.ctx.changed[ id ] =true;\n        }\n    },\n\n    evalItems: function (count) {\n        this.ctx.affected = {};\n        this._evalItems( count );\n\n        if ( this.ctx.tb.onchanged)\n            this.ctx.tb.onchanged( this.ctx.affected )\n        \n    },\n\n    _evalItems : function ( count ) {\n\n        if (count<=0) return;\n\n        let ctx = this.ctx;\n\n        let hasChanges = false;\n\n        for (var id in ctx.data.items) {\n            let item = ctx.data.items[id];\n            let result = ctx.data.result[id];\n\n            if (result && result.isReady) continue;\n            let values = this.isCompleteValues(item, id);\n            if (values) {\n                if (!ctx.data.result[id]) ctx.data.result[id] = {};\n\n                this.evalItem(item, id, values, ctx.data.result[id]);\n                if ( ctx.data.result[id].isReady )\n                    hasChanges = true;\n            }\n        }\n\n\n        if (hasChanges) this._evalItems(count - 1);\n    },\n\n    evalItem: function (item, id, values, result) {\n        let ctx = this.ctx;\n\n        result.isReady = true;\n        result.values = values;\n\n        let node = this.ctx.tb.getNode(item, values, result, ctx);\n        if ( node ) \n            result.node = node;\n\n        if ( result.isReady ) {\n            ctx.data.step++;\n            result.completedAt = ctx.data.step;\n            this.ctx.affected[ id ] = true;\n        }\n\n    },\n\n    isCompleteValues(item) {\n        //if (!this.ctx.tb.checkIfComplete(item)) return false;\n\n        let ctx = this.ctx;\n\n        let values = {};\n\n        let bellow = [];\n\n        for (var slot in item) {\n            let value = item[slot];\n            if (value.id) {\n                let bubble = ctx.data.result[value.id];\n\n                if (!bubble || !bubble.isReady) return false;\n\n                let node = bubble.node;\n\n                if ( item[slot+\"_path\"]) {\n                    node = _.get( node, item[slot+\"_path\"] )\n                }\n\n                values[slot] = node;\n            }\n            else values[slot] = value\n        }\n\n        return values;\n    },\n\n    init: function (ctx) {\n        let item = Object.create(this);\n        item.ctx = ctx;\n\n        _.defaultsDeep(ctx, {\n            data : {\n                items : {},\n                result : {},\n                step : 1,\n                versions : {},\n                trails : {},\n                rels : {\n                    bellow : {},\n                    above  : {},\n                    uses   : {}\n                },\n\n                state : {\n                    nextId : 8\n                }\n            },  \n            tb: {\n                checkIfComplete: (item) => item.type || item.tpl || item.node,\n                getNode: (item, values, result) => { return { val: values, x: item.tpl } }\n            }\n        })\n\n        ctx.master = item; \n        return item;\n    },\n\n    evaluateflow : function () {\n        this.evalItems(5);\n    },\n\n    getVersion : function ( id ) {\n        let item = this.ctx.data.items[ id ];\n\n        if ( !item ) return null;\n        return item.version;\n    }\n}\n\nvar test = (result) => {\n    let ctx = {\n        data: {\n            items: {},\n            result: {},\n            versions : {},\n            ants : {},\n            step: 1,\n        }\n    }\n\n    let nub = ub.init(ctx);\n\n    nub.mergeItem(\"b1\", {\n        tpl: \"salut\",\n        testval: \"#\"\n    })\n\n    nub.mergeItem(\"b1\", {\n        tpl: \"salutare\",\n        testval: { x: 12, elefant: \"test\", tpl: \"test\" }\n    })\n\n    nub.evalItems(0);\n\n\n\n    nub.mergeItem(\"b1\", {\n        tpl: \"salutare\",\n        testval: { x: 12, elefant: \"test\", tpl: \"test\" }\n    })\n\n\n\n    nub.evalItems(0);\n\n\n    result.ctx = ctx;\n}\n\ncu.bubbleFlow = {\n    //test,\n\n\n    run: function (ctx) {\n        return ub.init( ctx );\n    },\n    init: function () {\n\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\nvar fns = {}\n\nvar ub = {\n\n    ctx: {\n    },\n\n    doubleCheck: function (id) {\n        let tb = fns.evaluate.setup({ data: this.ctx.data, state: this.ctx.state }).target(id);\n\n        for (var i in checks)\n            tb.run(checks[i])\n    },\n\n    check: function (id) {\n        let item = this.ctx.data.items[id];\n        let result = this.ctx.data.result[id];\n        let shaddow = this.ctx.data.shaddow[id];\n\n        if (!shaddow)\n            shaddow = this.ctx.data.shaddow[id] = {}\n\n        let results = this.ctx.data.result;\n\n        let score = shaddow.score = {\n            subs: {\n                total: 0,\n                resolved: [],\n                unresolved: []\n            },\n        };\n\n        for (var slot in item) {\n            if (item[slot].id) {\n                score.subs.total++;\n\n                if (results[item[slot].id] && results[item[slot].id].isReady)\n                    score.subs.resolved.push({ slot: slot, id: item[slot].id });\n                else\n                    score.subs.unresolved.push({ slot: slot, id: item[slot].id });\n\n            }\n        }\n\n        if (result && result.values && result.values.tpl) {\n            let tpl = result.values.tpl;\n            score.tplParams = { total: 0, defined: 0, resolved: 0, unresolved: [] }\n            let parameters = tpl.mold.parameters;\n\n            for (var param in parameters) {\n                score.tplParams.total++;\n                if (result.values[param] || item[param]) {\n                    score.tplParams.defined++;\n                }\n                else {\n                    score.tplParams.unresolved.push(param)\n                }\n            }\n        }\n\n    },\n\n    setup: function (ctx) {\n        let item = Object.create(this);\n\n        item.ctx = ctx;\n\n        _.defaultsDeep(ctx, {\n            data: {\n                items: {},\n                result: {},\n                shaddow: {},\n                trails: {}\n            }\n        })\n\n        return item;\n    }\n}\n\n\n\nfns.evaluate = {\n    target: function (id) {\n\n        let model = this.model || this;\n\n        var item = Object.create(model);\n\n        item.model = model;\n\n        item.setup();\n\n        item.v.targetId = id;\n\n        return item;\n    },\n    setup: function (opt) {\n        this._setup(opt);\n        return this;\n    },\n    _setup: function (opt) {\n        if (opt) Object.assign(this, opt)\n\n        if (this.model && this.model.shaft) {\n            this.shaft = {};\n        }\n\n        this.v = { result: {} };\n    },\n    get: function (key) {\n        if (!_.isString(key)) return key;\n        let id = this.v.targetId;\n\n        let fullPath;\n        if (key == \"values\")\n            fullPath = [\"result\", this.v.targetId, \"values\"]\n        if (key == \"item\")\n            fullPath = [\"items\", this.v.targetId]\n        else\n            fullPath = [key, \"id\"];\n        return _.get(this.data, fullPath)\n    },\n\n    getFull: function (route) {\n        let base = route[0];\n        let id = route[1];\n        let relPath = route[2];\n\n        if (!base) base = \"items\";\n        if (base == \"item\") base = \"items\";\n\n        if (!id) id = this.v.targetId;\n\n        let fullPath = [base, id]\n        if (relPath) fullPath.push(relPath);\n\n        return _.get(this.data, fullPath.join(\".\"))\n    },\n    fetch: function (map) {\n        for (var i in map) {\n            this.v[i] = this.getFull(map[i])\n        }\n        return this;\n    },\n\n    it: function (collection, cb) {\n        collection = this.get(collection);\n\n        //let subTb = Object.create( this );\n        //subTb.v  = Object.create( this.v )\n\n        //prepare\n        let subTb = this;\n        let oldValues = {\n            slot: subTb.v.slot,\n            value: subTb.v.value,\n            info: subTb.v.info,\n            sub: subTb.v.sub\n        }\n        subTb.v.slot = null;\n        subTb.v.value = null;\n        subTb.v.info = null;\n        subTb.v.sub = null;\n        for (var i in collection) {\n            subTb.v.slot = i;\n            subTb.v.value = collection[i];\n            subTb.v.info = i;\n            subTb.v.sub = {};\n            cb(subTb, subTb.v)\n        }\n\n        //cleanup\n        for (var i in oldValues)\n            subTb[i] = oldValues[i]\n\n    },\n\n    run: function (cb) {\n        try {\n            let result = cb(this, this.v)\n        } catch (e) {\n            if (e && e.type == \"notApplicable\") {\n                return;\n            }\n            console.log(e)\n        }\n\n        if (this.v.result) {\n\n            if (!this.data.trails[this.v.targetId]) {\n                this.data.trails[this.v.targetId] = {};\n            }\n            Object.assign(this.data.trails[this.v.targetId], this.v.result)\n        }\n    },\n\n    result: function (name, value) {\n        this.v.result[name] = value;\n    },\n\n    check: function (paths) {\n        for (var i in paths) {\n            let path = paths[i];\n\n            if (path == \"isCurrentItem\") {\n                let stateCurrentId = this.state.currentItem.targetid;\n                if (!stateCurrentId || this.v.targetId != stateCurrentId)\n                    throw { type: \"notApplicable\", path: paths[i] }\n            }\n            else {\n                let value = _.get(this.v, paths[i]);\n                if (value === undefined) throw { type: \"notApplicable\", path: paths[i] }\n            }\n        }\n    }\n}\n\nfns.compile = Object.assign({}, fns.evaluate, {\n    setup: function (opt) {\n        this._setup(opt);\n\n        this.clues = {\n            needes: {},\n            provides: {},\n            collections: []\n        }\n\n        return this;\n    },\n    fetch: function (map) {\n        for (var i in map) {\n            this.clues.needes[i] = { key: map[i] }\n            this.v[i] = { test: \"test\" }\n        }\n        return this;\n    },\n\n\n    check: function (check) {\n\n    },\n\n    result: function (name, value) {\n        this.clues.provides[name] = value;\n    },\n\n    it: function (collection, cb) {\n        this.clues.collections.push(collection)\n    },\n\n    run: function (cb) {\n        let result = cb(this, this.v);\n    }\n});\n\n\nvar checks = [\n\n    (tb, v) => {\n\n        tb.fetch({\n            item: [\"item\"]\n        })\n\n        v.score = {\n            total: 0,\n            resolved: [],\n            unresolved: []\n        }\n\n        tb.it(v.item, (tb, v) => {\n            let sub = v.value;\n            if (!sub.id) return;\n\n            v.score.total++;\n\n            let result = tb.getFull([\"result\", sub.id]);\n\n            if (!result || !result.isReady) v.score.unresolved.push(sub.id)\n            else v.score.resolved.push(sub.id)\n        })\n\n        tb.result(\"subScore\", v.score)\n        return { subScore: v.score }\n    },\n\n\n\n    (tb, v) => {\n\n        tb.fetch({\n            values: [\"result\", \"\", \"values\"],\n            item: [\"item\"],\n            parameters: [\"result\", \"\", \"values.tpl.mold.parameters\"]\n        })\n\n        tb.check([\n            \"values.tpl\"\n        ])\n\n        v.score = { total: 0, defined: 0, undefined: [] }\n        v.params = {};\n        tb.it(v.parameters, (tb, v) => {\n            let param = v.slot;\n            v.params[param] = true;\n            v.score.total++;\n            if (!v.item[param] && !v.values[param])\n                v.score.undefined.push(param)\n        })\n\n        tb.it(v.parameters, (tb, v) => {\n            let param = v.slot;\n            v.params[param] = true;\n        })\n\n\n        v.score.undefinedCount = v.score.undefined.length;\n        v.score.definedCount = v.score.total - v.score.undefinedCount;\n\n        tb.result(\"tplParamsScore\", v.score);\n        tb.result(\"tplParams\", v.params)\n    },\n\n\n\n    (tb, v) => {\n\n        tb.fetch(  {\n            trails : [\"trails\"],\n\n        })\n        tb.check([\n            \"isCurrentItem\"\n        ])\n\n        console.log(\"trails is currentItem\", v.trails);\n    }\n\n]\n\nvar test = (result) => {\n\n    ub.ctx.data = {\n        items: {\n            bubble1: {\n                slot1: \"salut\",\n                slot2: { id: \"bubble2\" }\n            },\n            bubble2: {\n                test: \"salut\"\n            }\n        },\n        result: {},\n        trails: {}\n    }\n\n    let tb = fns.evaluate.target(\"bubble1\");\n\n    tb.run(checks[0]);\n    tb.run(checks[1]);\n\n    result.tb = tb.v.result;\n    result.trails = ub.ctx.data.trails;\n}\n\ncu.bubbleGuns = {\n    //test,\n\n    setup: function (ctx) {\n        return ub.setup(ctx);\n    },\n    init: function () {\n\n    },\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nimport { types } from \"util\";\nvar cu = window.cu;\n\nvar ub = {\n    ctx: {\n        tb: {\n\n            onchanged: function (changed) { },\n            getNode: function (item, values, result, ctx) {\n                return cu.bubbleTypes.dispatch.getNode(item, values, result, ctx)\n            }\n        },\n\n        data: {\n            state: {\n                nextId: 0\n            }\n        }\n    }\n}\n\n\nvar test = (result) => {\n    ub.ctx.data = { state: { nextId: 0 } };\n    ub.ctx.tb.guns = cu.bubbleGuns.setup(ub.ctx);\n    ub.ctx.tb.flow = cu.bubbleFlow.run(ub.ctx)\n\n    ub.ctx.tb.flow.mergeItem(\"item1\", {\n        id: \"item1\",\n        tpl: {\n            id: \"item2\",\n            type: \"tpl\",\n            main: \"<div style='border:1px solid #007abc'>{h1} {salut} {someothervalue}</div>\"\n        },\n        tpl_path: \"main\",\n        h1: \"noh\",\n        salut: {\n            id: \"item3\",\n            tpl: {\n                id: \"item4\",\n                type: \"tpl\",\n                main: \"<div style='border:1px solid #007abc'>{text}</div>\"\n            },\n            tpl_path: \"main\",\n            text: \"salutare\"\n        }\n    });\n\n\n    ub.ctx.tb.flow.mergeItem(\"item5\", {\n        id: \"item5\",\n        type: \"mirror\",\n        model: \"item1\",\n        data: {\n            id: \"item6\",\n            version: 1,\n            node: {\n                h1: \"hh1\",\n                salut: {\n                    text: \"hey\"\n                }\n            }\n        }\n    })\n\n\n\n    ub.ctx.tb.flow.evaluateflow();\n\n    ub.ctx.tb.flow.mergeItem(\"item6\", {\n        node: {\n            h1: \"hh11\",\n            salut: {\n                text: \"testchanged\"\n            }\n        }\n    })\n\n    ub.ctx.tb.flow.evaluateflow();\n\n\n    result.items = ub.ctx.data.items;\n    result.result = ub.ctx.data.result;\n    result.shaddow = ub.ctx.data.shaddow;\n    //result.item6_1 = ub.ctx.data.result.item5.mirror.node.children[0][0];\n    //result.item6_2 = ub.ctx.data.result.item5.mirror.node.children[0][2].children\n}\n\ncu.bubbleTest = {\n    //test,\n\n    init: function () {\n    },\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nimport { types } from \"util\";\nvar cu = window.cu;\n\nvar type = {}\n\n\ntype.dispatch = {\n    getNode: function (item, values, result, ctx) {\n        let nodeType = values.type;\n        if (!nodeType) {\n            if (values.tpl) nodeType = \"reactNode\"\n\n            else if (values.node) nodeType = \"dataNode\"\n        }\n\n        if (nodeType && type[nodeType]) {\n            return type[nodeType].getNode(item, values, result, ctx)\n        }\n        else result.isReady = false;\n    }\n}\n\ntype.tpl = {\n    getNode: function (item, values, result, ctx) {\n        delete values.type;\n        let tpl = cu.tplObjParse.run(values);\n        result.viewAs = \"object\";\n        return tpl;\n    }\n}\n\ntype.dataNode = {\n    getNode: function (item, values, result, ctx) {\n        return item.node;\n    }\n}\n\ntype.reactNode = {\n    getNode: function (item, values, result, ctx) {\n\n        let tpl = values.tpl;\n        if (!tpl || !tpl.mold) {\n            result.isReady = false;\n            return;\n        }\n\n        let neededValues = [];\n        let node = cu.reactAssembler.run(tpl, values, (data, path, op) => {\n            let value = _.get(data, path);\n            if (value !== undefined) return value;\n            neededValues.push(path);\n            return \"dummyvalue\"\n        });\n\n        if (neededValues.length) {\n            node = [neededValues, node];\n        }\n        result.viewAs = \"reactComponent\"\n\n        result.cues = { pins: tpl.mold.pins }\n\n        return node;\n\n    }\n\n}\n\ntype.mirror = {\n\n    description: \"\",\n\n\n    getNode: function (item, values, result, ctx) {\n\n\n        let model = ctx.data.items[item.model];\n        let data = values.data;\n\n        let newItem = _.cloneDeep(model);\n\n        if (!result.bubbles) result.bubbles = {};\n        if (!result.cache) result.cache = { data: {} };\n\n        if (!_.isMatch(result.cache.data, data)) {\n            result.cache.data = data;\n\n            for (var i in newItem) {\n                if (i != \"tpl\" && newItem[i].id && data[i]) {\n                    if (result.bubbles[i]) {\n                        ctx.master.mergeItem(result.bubbles[i].id, { data: data[i] })\n                    }\n                }\n            }\n        }\n\n        for (var i in newItem) {\n            if (i != \"tpl\" && newItem[i].id && data[i]) {\n\n                if (result.bubbles[i]) {\n                    newItem[i] = { id: result.bubbles[i].id }\n                }\n                else {\n                    let newId = ctx.master.addItem({ type: \"mirror\", data: data[i], model: newItem[i].id })\n                    result.bubbles[i] = { id: newId, model: newItem[i].id };\n                }\n\n                newItem[i] = { id: result.bubbles[i].id }\n            }\n            else if (data[i]) {\n                newItem[i] = data[i]\n            }\n        }\n\n        newItem.id = item.id;\n\n        let newValues = ctx.master.isCompleteValues(newItem);\n\n        if (!newValues) {\n            result.isReady = false;\n            return;\n        }\n\n        result.mirror = {};\n        ctx.master.evalItem(item, item.id, newValues, result.mirror)\n        if (result.mirror.viewAs) result.viewAs = result.mirror.viewAs;\n        return result.mirror.node;\n    }\n}\n\nvar ub = {\n}\n\n\nvar test = (result) => {\n\n}\n\ncu.bubbleTypes = {\n    //test,\n\n    mirror: type.mirrorBubble,\n\n    types: type,\n    dispatch: type.dispatch,\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport { UV_UDP_REUSEADDR } from \"constants\";\nvar cu = window.cu;\n\n\nvar ub = {\n\n    ctx: {\n        payload: {\n        },\n\n        tb: {\n        }\n    },\n\n    run: function (obj) {\n        let oldPayload = this.ctx.payload;\n\n        let mold = {\n            ops: [],\n            parameters: {},\n            pins: {},\n            tpl: {},\n            comments : []\n        }\n\n        mold.tpl = this.getTpl(obj, [], mold)\n        this.ctx.payload = oldPayload;\n\n        return mold;\n    },\n\n    getTpl: function (obj, path, mold) {\n        if (_.isFunction(obj)) {\n            let str = obj.toString();\n            let result = this.opValues(obj.toString(), path, mold, \"makeFunction\");\n            if (str == result) return obj;\n            return result;\n        }\n        else if (_.isObject(obj)) {\n            let newValue = {};\n            for (var i in obj) {\n                let slot = i;\n                let value;\n                if ( slot.indexOf( \"{\") != -1 || slot.indexOf( \".\") != -1 ) {\n                    let x = {\n                        VALUE : obj[ i ], \n                        PATH  : i\n                    }\n\n                    slot = slot.replace(/[^\\w]+/g, \"_\" );\n                    value = this.getTpl(x, path.concat(slot), mold);\n\n                    this.addOp( mold, path.concat(slot), { type : \"pathSet\", stage : 10, path : path.concat(slot)  }  )\n                }\n                else \n                    value = this.getTpl(obj[i], path.concat(i), mold)\n\n                newValue[slot] = value;\n            }\n            return newValue;\n        }\n        else if (_.isArray(obj)) {\n            let newValue = [];\n            for (var i in obj)\n                newValue.push(this.getTpl(obj[i], path.concat(i), mold));\n            return newValue;\n        }\n        else if (_.isString(obj)) {\n            return this.opValues(obj, path, mold, \"concat\")\n        }\n        else return obj;\n    },\n\n    addOp: function (payload, path, op) {\n        if (!op.stage) op.stage = 0;\n        if (op.action)\n            payload.parameters[op.action] = op.path;\n        payload.ops.push(op)\n    },\n    addComment: function (payload, path, text) {\n        let comment = { text : text, path : path }\n        payload.comments.push(comment)\n    },\n\n    opValues: function (value, path, mold, finalOp) {\n        if (!_.isString(value)) return value;\n\n        /*\n        let comments = value.matchAll(/\\/\\/\\.\\:.+^/g);\n        for ( var i in comments )\n            this.addComment( mold, path, comments[i])\n        */\n\n        if (value.indexOf(\"{\") == -1) return value;\n\n\n        let ops = mold.ops;\n        let values = value.split(/(\\{[^}\\n\\:\\;]+)\\}|(\\$\\$\\w+)/g);\n        values = values.map((item, i) => {\n            if ( !item ) return null;\n\n            let firstChar = item.charAt(0);\n\n            if ( firstChar == \"{\") {\n                item = item.substring(1);\n            }\n            else if ( firstChar == \"$\") {\n                item = item.substring( 2 );\n            }\n            else return item;\n\n            let action = item;\n            return { type: \"value\", action , firstChar  };\n        })\n            .filter(item => item)\n\n\n        if (values.length == 0) return null;\n        else if (values.length == 1) {\n            values = values[0];\n            if (values.type) {\n                values.path = path;\n            }\n            if (_.isObject(values))\n                this.addOp(mold, values.path, values)\n            return values;\n        }\n        else if (!finalOp) {\n            values = values.map((item, i) => {\n                if (item.type) {\n                    item.path = path.concat(i);\n                    item.index = i;\n                    item.stage = 0;\n                    this.addOp(mold, path, item);\n\n                    return item;\n                }\n                else return item;\n            })\n            return values;\n        }\n        else {\n            values = values.map((item, i) => {\n                if (item.type) {\n                    item.path = path.concat(i);\n                    item.index = i;\n                    item.concatParent = true;\n                    item.stage = 0;\n\n                    this.addOp(mold, path, item);\n                    return item;\n                }\n                else return item;\n            })\n            this.addOp(mold, path, { path: path, type: finalOp, ops: values, stage: 1 });\n            return values;\n        }\n\n    }\n}\n\nvar test = (result) => {\n    var obj = {\n        x: \"salut - {test} - ce mai faci ? \",\n        z: function () {\n            console.log(\"test\")\n        },\n        p: \"{test}\",\n        zz: function () {\n            //{test} used for calling salut\n            this.$$test.salut();\n            console.log(\"t{test}\")\n        },\n\n        \"test.{test}.test\" : \"salut\"\n\n    }\n\n    result.mold = ub.run(obj)\n\n\n    result.obj = cu.moldAssembler.run( result, { test : \"elefant\"} )\n}\n\ncu.parseObjIntoMold = {\n    //test,\n\n    run: function (obj) {\n        return ub.run(obj)\n    },\n\n    init: function () {\n    },\n\n    def: `\n        @obj with string or .html slots \n        transform it into componentsObjects\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nvar cu = window.cu;\n\n\nvar phase1 = {\n\n    run: function (html) {\n        html = html.trim();\n\n        let nest = document.createElement('div');\n        nest.innerHTML = html;\n\n        let specs = [];\n\n        for (var i = 0; i < nest.childNodes.length; i++) {\n            let el = nest.childNodes[i];\n\n            let spec = this._spec(el);\n\n            specs.push(spec);\n        }\n\n        return specs.length == 1 ? specs[0] : specs;\n    },\n\n\n    _spec: function (el) {\n\n        if (el.nodeType == 3) {\n            return el.nodeValue\n        }\n\n        let props = {};\n        for (var i = 0; i < el.attributes.length; i++) {\n            let attr = el.attributes[i];\n            let name = attr.name;\n            if (name.indexOf(\"_\") != -1) {\n                name = name.replace(/\\_(.)/g, (all, char) => { return char.toUpperCase() })\n            }\n            props[name] = attr.value;\n        }\n\n        if (props.class) {\n            props.className = props.class;\n            delete props.class;\n        }\n\n        if (props.style) {\n            props.style = this._style(props.style);\n        }\n\n\n        let spec = {\n          type: \"node\",\n          componentName: el.nodeName.toLowerCase(),\n          props: props,\n          children: null,\n      };\n\n        if ( props.htmlSlot ) {\n          props[ props.htmlSlot ] = el.innerHTML;\n          return spec;\n        }\n\n        if (Object.keys(props) == 0) props = null;\n\n        let children = []\n        el.childNodes.forEach(child => {\n            children.push(this._spec(child))\n        })\n        if (children.length == 0) children = null;\n        spec.children = children;\n\n        return spec;\n    },\n\n    _style: function (str) {\n        str = str + \";\";\n        let reg = /\\s*([^:\\s]+)\\s*\\:\\s*([^;]+)\\s*\\;+/g\n        let css = {};\n        let match;\n        while (match = reg.exec(str)) {\n            css[match[1]] = match[2]\n        }\n\n        return css;\n    },\n\n}\n\nvar phase2 = {\n    run: function (obj , attrs ) {\n      let payload = {\n        ops: [],\n        pins: {},\n        parameters : {},\n        attrs : {},\n        watchAttrs : attrs || []\n      }\n  \n      if ( _.isArray( obj ) )\n        payload.tpl = obj.map(( obj, i)  => this.iterate(obj, [i], payload) )\n      else \n        payload.tpl = this.iterate(obj, [], payload)\n\n      payload.ops.sort ( (a,b) => a.stage - b.stage )\n  \n      return { ops: payload.ops, tpl: payload.tpl, pins : payload.pins , parameters : payload.parameters, attrs : payload.attrs}\n    },\n    iterate: function (obj, path, payload) {\n      if (!obj) return;\n  \n      if (_.isString(obj)) {\n        return this.opValues(obj, path, payload, false);\n      }\n  \n      obj = this.handleObj(obj, path, payload);\n  \n      let childrenPath = path.concat([\"children\"])\n      for (var i in obj.children) {\n        obj.children[i] = this.iterate(obj.children[i], childrenPath.concat(i), payload)\n      }\n  \n      let subPath = path.concat([\"props\"])\n      for (var i in obj.props) {\n        if (i == \"style\") continue;\n        obj.props[i] = this.handleProp(obj.props[i], subPath.concat(i), obj, payload)\n      }\n  \n      if (obj.props && obj.props.style) {\n        let subPath = path.concat([\"props\", \"style\"])\n        for (var i in obj.props.style) {\n          obj.props.style[i] = this.handleProp(obj.props.style[i], subPath.concat(i), obj, payload)\n        }\n      }\n  \n      if (obj.props && obj.props.pin) {\n        payload.pins[ obj.props.pin ] = path;\n      }\n\n      if (obj.props && obj.props.id) {\n        payload.pins[ obj.props.id ] = path;\n      }\n\n      if ( obj.props )\n        payload.watchAttrs.forEach( attr => {\n            if ( !obj.props[attr] ) return ;\n            if ( !payload.attrs[attr] ) payload.attrs[ attr ] = [];\n            payload.attrs[ attr ].push({  path, value : obj.props[attr] } );\n        })\n  \n      return obj;\n    },\n  \n    handleObj: function (obj, path) {\n      return obj;\n    },\n  \n    handleProp: function (obj, path, parent, payload) {\n      if (!_.isString(obj)) return obj;\n  \n      return this.opValues(obj, path, payload, true)\n    },\n    addOp: function (payload, path, op) {\n\n        if ( !op.stage ) op.stage = 0;\n      payload.parameters[ op.action ] = op.path;\n      payload.ops.push(op)\n    },\n  \n    prepareAction: function (item) {\n      return item;\n    },\n    opValues: function (value, path, payload, concatOp) {\n      if (!_.isString(value)) return value;\n      if (value.indexOf(\"{\") == -1) return value;\n  \n      let ops = payload.ops;\n      let values = value.split(/(\\{[^}\\n\\:\\;]+)\\}/g);\n      values = values.map((item, i) => {\n        if (item == \"\") return null\n        if (item.charAt(0) !== \"{\") return item;\n  \n        item = item.substring(1);\n        let action = this.prepareAction(item)\n        return { type: \"value\", action: action };\n      })\n        .filter(item => item)\n  \n  \n      if (values.length == 0) return null;\n      else if (values.length == 1) {\n        values = values[0];\n        if (values.type) {\n          values.path = path;\n        }\n        if ( _.isObject( values ))\n          this.addOp(payload, values.path, values)\n        return values;\n      }\n      else if (!concatOp) {\n        values = values.map((item, i) => {\n          if (item.type) {\n            item.path = path.concat(i);\n            item.index = i;\n            item.stage = 0;\n            this.addOp(payload, path, item);\n  \n            return item;\n          }\n          else return item;\n        })\n        return values;\n      }\n      else {\n        values = values.map((item, i) => {\n          if (item.type) {\n            item.path = path.concat(i);\n            item.index = i;\n            item.concatParent = true;\n            item.stage = 0;\n\n            this.addOp(payload, path, item);\n            return item;\n          }\n          else return item;\n        })\n        this.addOp(payload, path, { path: path, type: \"concat\", ops: values, stage : 1 });\n        return values;\n      }\n  \n    }\n  \n  }\n\n\nvar ub = {\n    run : function ( html , attrs ) {\n        var result = phase1.run( html );\n        result = phase2.run( result, attrs );\n\n        return result;\n    }\n}\n\nvar test = (result) => {\n    result.output = ub.run( \"<div>Salut {#test} </div>\");\n}\n\ncu.parseStringIntoComp = {    \n    //test,\n\n    run: function (obj, attrs ) {\n        return ub.run(obj, attrs )\n    },\n    def: `\n        @obj string \n        transform it into componentsObjects\n    `\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nimport js_beautify from \"js-beautify\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n        nextUID : 0\n    },\n\n    run : function (name ) {\n        return (name || \"uid\" ) +\"_\"+ this.ctx.nextUID++;\n    },\n\n\n    makestr : function ( obj, indent ) {\n        if ( _.isFunction( obj ) ) return obj.toString();\n        if ( _.isString( obj ) ) {\n \n            let usequouts = '\"';\n            if ( obj.indexOf( \"\\n\") != -1 ) usequouts = \"`\";\n            if ( obj.indexOf('\"') != -1 ) usequouts = \"`\";\n            \n            if (usequouts == \"`\") {\n                obj = js_beautify.html( obj, { \n                    indent_size : 2,\n                    indent_level : indent + 1,\n                    preserve_newlines : true,\n                    max_preserve_newlines : 0,\n                    indent_inner_html: true,\n                } )\n\n                obj = obj.trimStart();\n            }\n            return usequouts + obj + usequouts\n        }\n        if ( _.isArray(obj)) {\n            let lines = [];\n            for ( var i in obj ) {\n                let value = this.makestr( obj[i] , indent + 1);\n\n                lines.push( value)\n            }\n\n            return \"[\" + lines.join(\",\\n\") + \"]\";\n        }\n\n        if ( _.isObjectLike(obj)) {\n            let lines = [];\n            let multiLine = false;\n            for ( var i in obj ) {\n                let slot = i;\n                let value = this.makestr( obj[i], indent + 1 );\n\n                if ( !slot.match( /^[a-z0-9$_]+$/) ) slot = '\"' + slot + '\"'\n\n                if ( value.indexOf(\"\\n\") != -1 ) multiLine = false;\n                lines.push( slot + \":\" + value )\n            }\n\n            return \"{\" + lines.join(\",\") + \"}\"\n        }\n        \n        if ( _.isNil( obj )) return \"null\"\n\n        return obj.toString();\n    },\n\n    beautify : function ( str ) {\n        return js_beautify.js_beautify( str, {\n            indent_size :2 ,\n            indent_level : -1, \n            max_preserve_newlines : 1,\n            preserve_newlines : true\n        } )\n    }\n}\n\nvar test = (result) => {\n\n    var obj = {\n        tpl : `<div>s\nce mai faci <span>\nsdf</span>\n        alut</div>`,\n        fn : function ( ) {\n\n        },\n        \"#b ce mai faci\" : \"\",\n        x : {\n            \"test\" : \"salut\" \n        }\n    }\n\n    result.str = ub.makestr( obj ,10 )\n    result.beuaty = js_beautify.js_beautify( result.str, {\n        indent_size :2 ,\n        indent_level : -1, \n        max_preserve_newlines : 1,\n        preserve_newlines : true\n    } )\n}\n\ncu.prettyScode = {\n    //test,\n\n    run: function (name) {\n        let str =  ub.makestr(name, 1)\n        return ub.beautify( str );\n    },\n    \n    def: `\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","\nimport React, { Component } from 'react';\n\nclass MyInput extends Component {\n\n    constructor(props) {\n      super(props);\n\n      this.state = {\n        value : \"\"\n      }\n\n      this.onChange = this.onChange.bind( this );\n    }\n\n    onChange ( evt ) {\n      this.setState( {value : evt.target.value});\n\n      if ( this.props.onChange ) this.props.onChange( evt );\n    }\n  \n\n    componentWillReceiveProps(nextProps) {\n      if ( nextProps.value!==undefined && nextProps.value.text!==undefined) this.setState({value : nextProps.value.text})\n    }\n\n    render () {\n\n      let props = Object.assign({}, this.props, {value : this.state.value, onChange : this.onChange })\n      \n      return React.createElement(\"input\", props, null);\n    }\n  }\n\n  export default MyInput;","import React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport * as webcola from \"webcola\";\nimport $ from \"jquery\"\n\n\nexport default class MapDiagram extends Component {\n  constructor ( props ) {\n    super( props);\n    this.ref = React.createRef();\n\n    this.state = {\n      id : \"salut\"\n    }\n  }\n\n  componentDidMount() {\n    this.makeTree();\n\n    this.drawTree( this.props.graph )\n\n  }\n  makeTree ( ) {\n\n    this.svg = d3.select(this.ref.current)\n      .append(\"svg\")\n\n      this.d3cola = webcola.d3adaptor(d3)\n      .avoidOverlaps(true)\n\n\n      this.svg.append('svg:defs').append('svg:marker')\n      .attr('id', 'end-arrow')\n      .attr('viewBox', '0 -5 10 10')\n      .attr('refX', 6)\n      .attr('markerWidth', 3)\n      .attr('markerHeight', 3)\n      .attr('orient', 'auto')\n      .append('svg:path')\n      .attr('d', 'M0,-5L10,0L0,5')\n      .attr('fill', '#000');\n\n  }\n\n  drawTree(graph) {\n   \n\n\n    console.log( \"drawtree\", graph)\n    let h = $(this.ref.current).height();\n    let w = $(this.ref.current).width();\n\n\n\n\n    for ( var i in graph.nodes ) {\n      if ( !graph.nodes[i].radius ) graph.nodes[i].radius = Math.random() * 10 + 5;\n    }\n\n\n    var pageBounds = {\n      x: 0,\n      y: 0,\n      width: w,\n      height: h\n    }\n\n\n    var nodeRadius = 5;\n\n    graph.nodes.forEach(function (v) { v.height = v.width = 3 * v.radius; });\n\n\n    var realGraphNodes = graph.nodes.slice(0),\n     topLeft = { x: pageBounds.x, y: pageBounds.y, fixed: true },\n     tlIndex = graph.nodes.push(topLeft) - 1,\n     bottomRight = { x: pageBounds.x + pageBounds.width, y: pageBounds.y + pageBounds.height, fixed: true },\n     brIndex = graph.nodes.push(bottomRight) - 1,\n     constraints = [];\n    for (var i = 0; i < realGraphNodes.length; i++) {\n        let nodeRadius = realGraphNodes[i].radius;\n        constraints.push({ axis: 'x', type: 'separation', left: tlIndex, right: i, gap : nodeRadius });\n        constraints.push({ axis: 'y', type: 'separation', left: tlIndex, right: i , gap : nodeRadius});\n        constraints.push({ axis: 'x', type: 'separation', left: i, right: brIndex , gap : nodeRadius});\n        constraints.push({ axis: 'y', type: 'separation', left: i, right: brIndex, gap : nodeRadius});\n    }\n\n\n\n    this.svg\n      .attr(\"width\", w)\n      .attr(\"height\", h)\n      .style(\"margin-left\", 0);\n\n\n\n\n    this.d3cola.size([w,h]);\n\n\n    this.d3cola\n      .nodes(graph.nodes)\n      .links(graph.links)\n      .constraints( constraints )\n      .avoidOverlaps(true)\n      .linkDistance(60,0.5)\n      .size([w,h])\n      .flowLayout(\"y\", 10)\n      .symmetricDiffLinkLengths(5)\n      .start(10,20,20)\n\n\n    var path = this.svg.selectAll(\".link\")\n    .data(graph.links)\n    .enter().append('svg:path')\n    .attr('class', 'link');\n\n    var node = this.svg.selectAll(\".node\")\n      .data(graph.nodes)\n      .enter().append(\"circle\")\n      .attr(\"class\", \"node\")\n      .attr(\"r\", function (d) { return d.radius })\n      .style(\"fill\", function (d) { return \"#007abc\"; })\n      .call(this.d3cola.drag);\n\n    var titles = this.svg.selectAll(\"text\")\n    .data(graph.nodes)\n    .enter().append(\"text\")\n          .text(function (d) { return d.name; })\n          .attr(\"text-anchor\", \"middle\")\n\n    this.d3cola.on(\"tick\", function () {\n      node.attr(\"cx\", function (d) { return d.x; })\n        .attr(\"cy\", function (d) { return d.y; });\n\n        titles.attr(\"dx\", function (d) { return d.x })\n        .attr(\"dy\", function (d) { return d.y; });\n\n\n        path.attr('d', function (d) {\n          return 'M' + d.target.x + ',' + d.target.y + 'L' + d.source.x + ',' + d.source.y;\n        });\n  \n    });\n\n\n  }\n\n\n  componentWillReceiveProps ( newprops ) {\n    console.log( \"will componentWillReceiveProps\", newprops )\n    this.drawTree( newprops.graph )\n  }\n\n  render() {\n    return <div ref={this.ref} id={\"#\" + this.props.id} style={{height:\"100%\",width:\"100%\"}}></div>\n  }\n\n}\nclass TreeDiagram extends Component {\n    constructor(props) {\n      super(props);\n  \n      this.ref = React.createRef();\n    }\n    componentDidMount() {\n      this.drawTree();\n    }\n  \n    drawChart() {\n      const data = [12, 5, 6, 6, 9, 10];\n  \n      let h = 200;\n      let w = 200;\n  \n  \n      console.log(this.ref.current);\n      const svg = d3.select(this.ref.current)\n        .append(\"svg\")\n        .attr(\"width\", 200)\n        .attr(\"height\", 200)\n        .style(\"margin-left\", 10);\n  \n      svg.selectAll(\"rect\")\n        .data(data)\n        .enter()\n        .append(\"rect\")\n        .attr(\"x\", (d, i) => i * 70)\n        .attr(\"y\", (d, i) => h - 10 * d)\n        .attr(\"width\", 65)\n        .attr(\"height\", (d, i) => d * 10)\n        .attr(\"fill\", \"green\")\n    }\n  \n    drawTree() {\n      var  graph = {\n        \"nodes\": [{ \"name\": \"Toprato\" }, { \"name\": \"Fella\" }, { \"name\": \"Tirti\" }, { \"name\": \"LA Piu' Bella\" }, { \"name\": \"Deep Shadow 1-5-8\" }, { \"name\": \"Oobiscus\" }, { \"name\": \"Rioky\" }, { \"name\": \"Klashe\" }, { \"name\": \"Tau Beta\" }, { \"name\": \"311040\" }, { \"name\": \"Nevf Zotsamm\" }, { \"name\": \"Gnaron\" }, { \"name\": \"Green Dor\" }, { \"name\": \"Gravity\" }, { \"name\": \"Jurrawensaed\" }, { \"name\": \"Andrill Primus\" }, { \"name\": \"Ulti-Mad\" }, { \"name\": \"Jellyfish\" }, { \"name\": \"Yersa\" }, { \"name\": \"Therfady\" }, { \"name\": \"SC 09\" }, { \"name\": \"Glueck\" }, { \"name\": \"Fiddle\" }, { \"name\": \"LV-017\" }, { \"name\": \"Sardinle\" }, { \"name\": \"Latalava\" }, { \"name\": \"Penumbra\" }, { \"name\": \"Chi Qoppa\" }, { \"name\": \"Vopru Maufyb\" }, { \"name\": \"Onadha\" }, { \"name\": \"Muplita Furr\" }, { \"name\": \"Psi Epsilon\" }, { \"name\": \"Dimloon\" }, { \"name\": \"Tanned I\" }, { \"name\": \"Woolaris 10\" }, { \"name\": \"Semend\" }, { \"name\": \"Blacus\" }, { \"name\": \"Darknok\" }, { \"name\": \"Oastar Secundus\" }, { \"name\": \"Green One\" }, { \"name\": \"Kayin Minor A\" }, { \"name\": \"Arton\" }, { \"name\": \"Anerstis\" }, { \"name\": \"Lament\" }, { \"name\": \"Shaison\" }, { \"name\": \"Rekini-H-S6\" }, { \"name\": \"Darkless\" }, { \"name\": \"MBTP 20\" }, { \"name\": \"Yankee Quebec\" }, { \"name\": \"Shere Jauj-Bred\" }, { \"name\": \"Embalm\" }, { \"name\": \"Small Rock 4\" }, { \"name\": \"Libra-D-S3\" }, { \"name\": \"Dying Warmth\" }, { \"name\": \"Sofa\" }, { \"name\": \"Grobnor\" }, { \"name\": \"Forbidden 1\" }, { \"name\": \"Glimmer II\" }, { \"name\": \"Aleksis\" }, { \"name\": \"Relu\" }, { \"name\": \"Scoff\" }, { \"name\": \"Elas\" }, { \"name\": \"Great Crater\" }, { \"name\": \"Leuprekota\" }, { \"name\": \"Yetton\" }, { \"name\": \"Fheyhs\" }, { \"name\": \"Edriwoise\" }, { \"name\": \"Usque\" }, { \"name\": \"Surfatu\" }, { \"name\": \"Drumana\" }, { \"name\": \"Hausner\" }, { \"name\": \"Vitalis\" }, { \"name\": \"Hyacinta IV\" }, { \"name\": \"Revenge of the Lith\" }, { \"name\": \"Asclephyrus\" }, { \"name\": \"Little Friend VI\" }, { \"name\": \"Fontelitio\" }, { \"name\": \"Shinmien\" }, { \"name\": \"Nine\" }, { \"name\": \"Kalgash\" }]\n        ,\n        \"links\": [{ \"target\": 1, \"source\": 0, \"value\": 1 }, { \"target\": 2, \"source\": 0, \"value\": 1 }, { \"target\": 9, \"source\": 0, \"value\": 1 }, { \"target\": 11, \"source\": 0, \"value\": 1 }, { \"target\": 78, \"source\": 1, \"value\": 1 }, { \"target\": 3, \"source\": 2, \"value\": 1 }, { \"target\": 4, \"source\": 3, \"value\": 1 }, { \"target\": 5, \"source\": 4, \"value\": 1 }, { \"target\": 6, \"source\": 5, \"value\": 1 }, { \"target\": 10, \"source\": 6, \"value\": 1 }, { \"target\": 8, \"source\": 7, \"value\": 1 }, { \"target\": 11, \"source\": 7, \"value\": 1 }, { \"target\": 12, \"source\": 8, \"value\": 1 }, { \"target\": 18, \"source\": 9, \"value\": 1 }, { \"target\": 35, \"source\": 10, \"value\": 1 }, { \"target\": 13, \"source\": 12, \"value\": 1 }, { \"target\": 14, \"source\": 12, \"value\": 1 }, { \"target\": 15, \"source\": 12, \"value\": 1 }, { \"target\": 16, \"source\": 12, \"value\": 1 }, { \"target\": 17, \"source\": 12, \"value\": 1 }, { \"target\": 19, \"source\": 12, \"value\": 1 }, { \"target\": 20, \"source\": 12, \"value\": 1 }, { \"target\": 21, \"source\": 12, \"value\": 1 }, { \"target\": 23, \"source\": 12, \"value\": 1 }, { \"target\": 25, \"source\": 12, \"value\": 1 }, { \"target\": 26, \"source\": 12, \"value\": 1 }, { \"target\": 28, \"source\": 12, \"value\": 1 }, { \"target\": 29, \"source\": 12, \"value\": 1 }, { \"target\": 31, \"source\": 12, \"value\": 1 }, { \"target\": 24, \"source\": 13, \"value\": 1 }, { \"target\": 45, \"source\": 14, \"value\": 1 }, { \"target\": 22, \"source\": 15, \"value\": 1 }, { \"target\": 49, \"source\": 16, \"value\": 1 }, { \"target\": 30, \"source\": 18, \"value\": 1 }, { \"target\": 39, \"source\": 19, \"value\": 1 }, { \"target\": 40, \"source\": 20, \"value\": 1 }, { \"target\": 50, \"source\": 21, \"value\": 1 }, { \"target\": 27, \"source\": 22, \"value\": 1 }, { \"target\": 63, \"source\": 23, \"value\": 1 }, { \"target\": 72, \"source\": 24, \"value\": 1 }, { \"target\": 60, \"source\": 26, \"value\": 1 }, { \"target\": 68, \"source\": 27, \"value\": 1 }, { \"target\": 59, \"source\": 29, \"value\": 1 }, { \"target\": 32, \"source\": 31, \"value\": 1 }, { \"target\": 33, \"source\": 31, \"value\": 1 }, { \"target\": 34, \"source\": 31, \"value\": 1 }, { \"target\": 36, \"source\": 31, \"value\": 1 }, { \"target\": 37, \"source\": 31, \"value\": 1 }, { \"target\": 38, \"source\": 31, \"value\": 1 }, { \"target\": 58, \"source\": 32, \"value\": 1 }, { \"target\": 75, \"source\": 33, \"value\": 1 }, { \"target\": 41, \"source\": 34, \"value\": 1 }, { \"target\": 48, \"source\": 35, \"value\": 1 }, { \"target\": 76, \"source\": 36, \"value\": 1 }, { \"target\": 42, \"source\": 37, \"value\": 1 }, { \"target\": 44, \"source\": 38, \"value\": 1 }, { \"target\": 46, \"source\": 38, \"value\": 1 }, { \"target\": 47, \"source\": 38, \"value\": 1 }, { \"target\": 43, \"source\": 39, \"value\": 1 }, { \"target\": 57, \"source\": 40, \"value\": 1 }, { \"target\": 67, \"source\": 41, \"value\": 1 }, { \"target\": 74, \"source\": 42, \"value\": 1 }, { \"target\": 51, \"source\": 43, \"value\": 1 }, { \"target\": 52, \"source\": 48, \"value\": 1 }, { \"target\": 53, \"source\": 48, \"value\": 1 }, { \"target\": 54, \"source\": 48, \"value\": 1 }, { \"target\": 55, \"source\": 48, \"value\": 1 }, { \"target\": 56, \"source\": 48, \"value\": 1 }, { \"target\": 61, \"source\": 48, \"value\": 1 }, { \"target\": 62, \"source\": 48, \"value\": 1 }, { \"target\": 64, \"source\": 62, \"value\": 1 }, { \"target\": 65, \"source\": 62, \"value\": 1 }, { \"target\": 66, \"source\": 62, \"value\": 1 }, { \"target\": 69, \"source\": 62, \"value\": 1 }, { \"target\": 70, \"source\": 69, \"value\": 1 }, { \"target\": 71, \"source\": 69, \"value\": 1 }, { \"target\": 73, \"source\": 69, \"value\": 1 }, { \"target\": 77, \"source\": 69, \"value\": 1 }, { \"target\": 79, \"source\": 78, \"value\": 1 }]\n        ,\n        \"constraints\": [\n          { \"axis\": \"y\", \"left\": 0, \"right\": 1, \"gap\": 25 },\n          { \"axis\": \"y\", \"left\": 0, \"right\": 2, \"gap\": 25 },\n          { \"axis\": \"y\", \"left\": 0, \"right\": 9, \"gap\": 25 },\n          { \"axis\": \"y\", \"left\": 0, \"right\": 11, \"gap\": 25 },\n          { \"axis\": \"y\", \"left\": 1, \"right\": 78, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 2, \"right\": 3, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 3, \"right\": 4, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 4, \"right\": 5, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 5, \"right\": 6, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 6, \"right\": 10, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 7, \"right\": 8, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 7, \"right\": 11, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 8, \"right\": 12, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 9, \"right\": 18, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 10, \"right\": 35, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 13, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 14, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 15, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 16, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 17, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 19, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 20, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 21, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 23, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 25, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 26, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 28, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 29, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 12, \"right\": 31, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 13, \"right\": 24, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 14, \"right\": 45, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 15, \"right\": 22, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 16, \"right\": 49, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 18, \"right\": 30, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 19, \"right\": 39, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 20, \"right\": 40, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 21, \"right\": 50, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 22, \"right\": 27, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 23, \"right\": 63, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 24, \"right\": 72, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 26, \"right\": 60, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 27, \"right\": 68, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 29, \"right\": 59, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 31, \"right\": 32, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 31, \"right\": 33, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 31, \"right\": 34, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 31, \"right\": 36, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 31, \"right\": 37, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 31, \"right\": 38, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 32, \"right\": 58, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 33, \"right\": 75, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 34, \"right\": 41, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 35, \"right\": 48, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 36, \"right\": 76, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 37, \"right\": 42, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 38, \"right\": 44, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 38, \"right\": 46, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 38, \"right\": 47, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 39, \"right\": 43, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 40, \"right\": 57, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 41, \"right\": 67, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 42, \"right\": 74, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 43, \"right\": 51, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 52, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 53, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 54, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 55, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 56, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 61, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 48, \"right\": 62, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 62, \"right\": 64, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 62, \"right\": 65, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 62, \"right\": 66, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 62, \"right\": 69, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 69, \"right\": 70, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 69, \"right\": 71, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 69, \"right\": 73, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 69, \"right\": 77, \"gap\": 25 }, { \"axis\": \"y\", \"left\": 78, \"right\": 79, \"gap\": 25 }]\n      };\n  \n  \n      var graph = {\n        nodes : []\n      }\n  \n      for ( var i = 0; i< 5; i++ ) {\n        graph.nodes[ i ] = { name : \"node \" + i}\n      }\n  \n      graph.links = [\n        {source : 0, target : 1}, \n        {source : 1, target : 2}, \n        {source : 1, target : 3}, \n        {source : 0, target : 4}, \n        {source : 4, target : 3}\n      ] \n  \n  \n      let h = 200;\n      let w = 200;\n  \n  \n      for ( var i in graph.constraints )\n      graph.constraints[i].gap = 5;\n  \n      //var color = d3.scaleOrdinal(d3.schemeCategory20);\n  \n  \n  \n  \n      const svg = d3.select(this.ref.current)\n        .append(\"svg\")\n        .attr(\"width\", 400)\n        .attr(\"height\", 400)\n        .style(\"margin-left\", 0);\n      var nodeRadius = 5;\n  \n      graph.nodes.forEach(function (v) { v.height = v.width = 2 * nodeRadius; });\n  \n      console.log(webcola);\n  \n      var d3cola = webcola.d3adaptor(d3)\n        .avoidOverlaps(true)\n        .size([400, 400]);\n  \n  \n      d3cola\n        .nodes(graph.nodes)\n        .links(graph.links)\n        .flowLayout(\"y\", 50)\n        .symmetricDiffLinkLengths(20)\n        .start(1,1,1);\n  \n      // define arrow markers for graph links\n      svg.append('svg:defs').append('svg:marker')\n        .attr('id', 'end-arrow')\n        .attr('viewBox', '0 -5 10 10')\n        .attr('refX', 6)\n        .attr('markerWidth', 3)\n        .attr('markerHeight', 3)\n        .attr('orient', 'auto')\n        .append('svg:path')\n        .attr('d', 'M0,-5L10,0L0,5')\n        .attr('fill', '#000');\n  \n      var path = svg.selectAll(\".link\")\n        .data(graph.links)\n        .enter().append('svg:path')\n        .attr('class', 'link');\n  \n      var node = svg.selectAll(\".node\")\n        .data(graph.nodes)\n        .enter().append(\"circle\")\n        .attr(\"class\", \"node\")\n        .attr(\"r\", nodeRadius)\n        .style(\"fill\", function (d) { return \"red\"; })\n        //.call(d3cola.drag);\n  \n      node.append(\"title\")\n        .text(function (d) { return d.name; });\n  \n      d3cola.on(\"tick\", function () {\n        // draw directed edges with proper padding from node centers\n        path.attr('d', function (d) {\n          var deltaX = d.target.x - d.source.x,\n            deltaY = d.target.y - d.source.y,\n            dist = Math.sqrt(deltaX * deltaX + deltaY * deltaY),\n            normX = deltaX / dist,\n            normY = deltaY / dist,\n            sourcePadding = nodeRadius,\n            targetPadding = nodeRadius + 2,\n            sourceX = d.source.x + (sourcePadding * normX),\n            sourceY = d.source.y + (sourcePadding * normY),\n            targetX = d.target.x - (targetPadding * normX),\n            targetY = d.target.y - (targetPadding * normY);\n          return 'M' + sourceX + ',' + sourceY + 'L' + targetX + ',' + targetY;\n        });\n  \n        node.attr(\"cx\", function (d) { return d.x; })\n          .attr(\"cy\", function (d) { return d.y; });\n      });\n      // turn on overlap avoidance after first convergence\n      //cola.on(\"end\", function () {\n      //    if (!cola.avoidOverlaps()) {\n      //        graph.nodes.forEach(function (v) {\n      //            v.width = v.height = 10;\n      //        });\n      //        cola.avoidOverlaps(true);\n      //        cola.start();\n      //    }\n      //});\n  \n    }\n  \n    render() {\n      return <div ref={this.ref} id={\"#\" + this.props.id}></div>\n    }\n  \n  }","import React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport * as webcola from \"webcola\";\nimport $ from \"jquery\"\nimport vis from \"vis\"\n\n\nexport default class TreeMap extends Component {\n  constructor(props) {\n    super(props);\n    this.ref = React.createRef();\n\n    this.state = {\n      id: \"salut\"\n    }\n  }\n\n  componentDidMount() {\n    this.makeTree();\n\n    this.drawTree(this.props.graph)\n\n  }\n  makeTree() {\n    let node = this.ref.current;\n\n    this.nodes = new vis.DataSet();\n    this.edges = new vis.DataSet();\n    var options = {\n      layout: { randomSeed: 2 }, autoResize: true,\n      height: '100%',\n      width: '100%'\n    };\n    this.network = new vis.Network(node, { nodes: this.nodes, edges: this.edges }, options);\n\n    this.network.on(\"click\", (params) => {\n\n      let id = this.network.getNodeAt(params.pointer.DOM);\n\n      console.log(id, this.props)\n      if (id && this.props.onClick) this.props.onClick(id)\n      //console.log('click event, getNodeAt returns: ' + this.getNodeAt(params.pointer.DOM), params);\n    });\n\n\n  }\n\n  drawTree(graph) {\n\n\n\n    console.log(\"drawtree\", graph)\n    let h = $(this.ref.current).height();\n    let w = $(this.ref.current).width();\n\n    this.nodes.update(graph.nodes);\n    this.edges.clear();\n    this.edges.add(graph.edges);\n\n  }\n\n\n  componentWillReceiveProps(newprops) {\n    console.log(\"will componentWillReceiveProps\", newprops)\n    this.drawTree(newprops.graph)\n  }\n\n  render() {\n    return <div ref={this.ref} id={\"#\" + this.props.id} style={{ height: \"100%\", width: \"100%\" }}></div>\n  }\n\n}\n","import _ from \"lodash\"\nimport faker from \"faker\"\nimport React, { Component } from 'react';\nimport MyInput from \"../../components/MyInput\"\nimport MapDiagram from \"../../components/TreeDiagram\"\nimport TreeMap from \"../../components/TreeMap\"\n\nvar cu = window.cu;\n\n\nvar customComponents = {\n  myinput : MyInput,\n  mapdiagram: MapDiagram,\n  treemap : TreeMap\n}\n\n\nvar ub = {\n\n    makeComponent : function (obj, i ) {\n        if (!obj) return null;\n        if (_.isString(obj)) return obj;\n        if (_.isArray(obj)) return obj.map((obj, i) => this.makeComponent(obj, i))\n        if ( !obj.componentName) return null;\n    \n        let children = null;\n        if (obj.children) children = obj.children.map((obj, i) => this.makeComponent(obj, i));\n    \n        let props = null;\n        if (obj.props) props = _.cloneDeep(obj.props);\n    \n        if (props && !props.key) props.key = i;\n        if (!props) props = { key: i }\n    \n        if (obj.componentName == \"style\") {\n          children = [_.flattenDeep(children).join(\"\")]\n        }\n    \n        let component = obj.componentName;\n        if (customComponents[component]) component = customComponents[component];\n    \n        var node;\n        try {\n          node = React.createElement(component, props, children)\n        } catch (e) {\n          console.error(e)\n          node = \"error\"\n        }\n        return node;\n        },\n\n}\n\nvar test = (result) => {\n}\n\ncu.reactUtils = {\n    //test,\n\n    makeComponent: function (tplComponent) {\n        return ub.makeComponent(tplComponent, 1)\n    },\n    \n    def: `\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nimport $ from \"jquery\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n        nextUID : 0\n    },\n\n    createStore : function ( tb, hapi, fns  ) {\n        if (tb && tb.cache.store ) return tb.cache.store;\n\n        let tpls = {\n          changeValueTpl : ( path ) =>  {\n            return function ( evt ) {\n              let value = evt.target.value;\n              hapi.set( path, value )\n            }\n          }, \n          runActionTpl : ( action ) => {\n            return function ( evt ) {\n              if ( hapi[action] ) return hapi[action]( evt );\n            }\n          },\n          runWithActionTpl : ( action ) => {\n            return function ( evt ) {\n                let target = evt.target;\n                let attr = $(target).attr( action[1])\n                if ( attr === undefined ) {\n                    target = $(target).parents(\"[\" + action[1] + \"]\")\n                    attr = $(target[0]).attr( action[1])\n\n                }\n\n              evt.stopPropagation();\n              if ( hapi[action[0]] ) return hapi[action[0]]( attr, evt );\n            }\n          },\n\n          runWithParam : ( action ) => {\n            return function ( param ) {\n            if ( hapi[action] ) return hapi[action]( param );\n          }          }\n\n        }\n\n\n        let store = {}\n  \n        for ( var i in fns.change ) {\n          store[i]  = tpls.changeValueTpl( fns.change[ i ])\n        }\n  \n  \n        for ( var i in fns.run ) {\n            store[i]  = tpls.runActionTpl( fns.run[ i ])\n          }\n\n          \n            \n        for ( var i in fns.runWith ) {\n          store[i]  = tpls.runWithActionTpl( fns.runWith[ i ])\n        }\n\n\n\n        for ( var i in fns.runWithParam ) {\n          store[i]  = tpls.runWithParam( fns.runWithParam[ i ])\n        }\n\n        if ( tb )\n          tb.cache.store = store;\n        return store;\n      }\n\n}\n\nvar test = (result) => {\n}\n\ncu.store = {\n    //test,\n\n    run: function (name) {\n        return ub.run(name);\n    },\n    get : function ( tb, hapi,  fns ) {\n        return ub.createStore( tb, hapi, fns )\n    },\n    \n    def: `\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n        payload: {\n            data: {\n\n                items: {},\n                subs: {},\n            },\n\n            src: {\n                getItem: function (id) {\n\n                },\n\n                getSubs: function (id) {\n\n                }\n            },\n\n            tpls: [],\n            registerTpl: function (args, master) {\n                this.tpls.push(args.path);\n            },\n\n            cases: [\n                result => {\n                    let isApplicable = !result.obj.item;\n\n                    if (!isApplicable) return;\n\n                    let id = result.obj.id;\n                    let item = ub.ctx.payload.data.items[id]\n\n                    if (!item) {\n                        item = {\n                            text: faker.company.catchPhrase(),\n                            id: id\n                        }\n\n                        if (ub.ctx.payload.setter)\n                            ub.ctx.payload.setter([\"items\", id], _.cloneDeep(item) )\n                    }\n\n\n                    result.obj.item = item;\n                    return \"applied\";\n                },\n\n                result => {\n                    let isApplicable = !result.obj.subs && result.obj.item && result.obj.level < 4;\n                    if (!isApplicable) return;\n\n                    let obj = result.obj;\n\n                    let id = result.obj.id;\n\n                    let subs = ub.ctx.payload.data.subs[id];\n\n                    if (!subs && !ub.ctx.payload.generated) {\n                        subs = {};\n\n                        let count = 4;\n                        for (var i = 0; i < count; i++) {\n                            let id = faker.random.uuid();\n                            let tpl = null;\n                            if (obj.level == 1) tpl = faker.random.arrayElement([null, \"columns\"]);\n                            let sub = {\n                                id: id,\n                                level: result.obj.level + 1,\n                                tpl: tpl\n                            }\n\n                            subs[id] = sub;\n                        }\n\n                        if (ub.ctx.payload.setter)\n                            ub.ctx.payload.setter([\"subs\", id], _.cloneDeep( subs ) )\n\n                    }\n\n                    if ( !subs ) subs = {}\n\n                    result.obj.subs = subs;\n                    result.subs = subs;\n\n                    return \"applied\";\n                }\n            ]\n        },\n\n        tb: {\n            //parseHtml: cu.parseStringIntoComp\n        }\n    },\n\n    run: function (obj, attrs) {\n        let oldPayload = this.ctx.payload;\n\n        this.ctx.payload.attrs = attrs || [];\n\n        let mold = this.it(obj, []);\n\n        this.ctx.payload = oldPayload;\n\n        return mold;\n    },\n\n\n    it: function (obj, path) {\n        let oldPayload = null;\n        let result = {\n            oldPayload: null,\n\n            obj: obj,\n            sub: obj,\n\n            master: this,\n            path: path,\n            values: {},\n            ops: []\n        }\n\n        this.prepare(result);\n\n        for (var i in result.subs) {\n            let ret = this.it(result.subs[i], path.concat([i]));\n            result.values[i] = ret;\n        }\n\n        return this.integrate(result)\n    },\n\n    addPayload: function (result, obj) {\n        if (!result.oldPayload) {\n            result.oldPayload = this.ctx.payload;\n            this.ctx.payload = Object.create(this.ctx.payload);\n        }\n        Object.assign(this.ctx.payload, obj);\n    },\n\n    prepare: function (result) {\n\n        let cases = this.ctx.payload.cases;\n\n        let hasChanges = true;\n        let applied = false;\n        let count = 0;\n        while (hasChanges && count < 5) {\n            hasChanges = false;\n            count++;\n            for (var i in cases) {\n                let _case = cases[i];\n                let ret = _case(result);\n                if (ret == \"applied\") {\n                    hasChanges = true;\n                    applied = true;\n                    break;\n                }\n            }\n        }\n    },\n\n    integrate: function (result) {\n        if (result.ops.length) {\n            for (var i in result.ops) {\n                let op = result.ops[i];\n                this.ctx.payload[op.name](op.args, this)\n            }\n        };\n\n        if (result.oldPayload) this.ctx.payload = result.oldPayload;\n\n        return result.obj;\n    }\n}\n\nvar inputs = {\n    items: { level: 0 },\n    subs: {},\n}\nvar test = (result) => {\n    let value = ub.run(inputs.items);\n\n    result.x = value;\n\n\n    cu.tests.pin(\"testRepo\", value)\n    //result.mold = value;\n}\n\ncu.testDataGenerator = {\n    //test,\n\n    run: function (id, data, generated,  setter) {\n\n        ub.ctx.payload.data = data;\n        ub.ctx.payload.setter = setter;\n        ub.ctx.payload.generated = generated;\n\n        return ub.run({ id: id || \"root\", level: 0 }, [])\n    },\n\n    init: function () {\n        ub.ctx.tb.parser = cu.tplObjParse;\n        ub.ctx.tb.reactAssembler = cu.reactAssembler;\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nvar cu = window.cu;\n\n\nvar ub = {\n\n    ctx: {\n        tb : {}\n    },\n\n    run : function ( str ) {\n        let mold = str;\n        mold = this.ctx.tb.parser.run( mold , [\"comp\"] );\n\n        return mold;\n    },\n\n\n}\n\n\nvar inputs = {\n    tplTree : {\n        x : `<div> <div id='title' comp='salut' class='{#test1} {#test2}' style='color : {#color}'> {#handle} : {#title}\n        \n        \n            <style>\n                @input \n                .column  { x : 12; background : {styleforred}red;}\n            </style>\n        </div> `\n    }\n}\nvar test = (result) => {\n    let value = ub.run( inputs.tplTree);\n\n    result.x = value.x.mold;\n\n    cu.tests.pin( \"mold\", value)\n    //result.mold = value;\n}\n\ncu.testMolds = {\n    //test,\n\n    run: function (obj) {\n        return ub.run(obj, [])\n    },\n\n    init : function ( ) {\n        ub.ctx.tb.parser = cu.tplObjParse;\n        ub.ctx.tb.reactAssembler = cu.reactAssembler;\n    },\n    \n    def: `\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","import _ from \"lodash\"\nimport $ from \"jquery\"\n\nvar cu = window.cu;\n\n\nvar ub = {\n\n    ctx: {\n        tb: {},\n\n        wallet: {}\n    },\n\n    run: function (str) {\n        let mold = str;\n        mold = this.ctx.tb.parser.run(mold, [\"comp\"]);\n\n        return mold;\n    },\n\n    parseTpl: function (obj) {\n        let mold = this.ctx.tb.parser.run(obj, [\"comp\"]);\n        return mold;\n    },\n\n    renderTpl: function (mold, data, getter) {\n        return this.ctx.tb.reactAssembler.run(mold, data, getter)\n    },\n\n    assembleTpl: function (mold, data) {\n        if (_.isString(mold)) mold = _.get(this.ctx.payload.molds, mold);\n        return this.ctx.tb.reactAssembler.run(mold, data, (data, path) => {\n            let value = _.get( data, path );\n            if ( value.node ) return value.node;\n            return value;\n        })\n    },\n\n\n    iterateBubbles: function (bubbles, count ) {\n        if ( count == undefined ) count = 0;\n\n        if ( count && count > 5 ) return;\n\n        bubbles = bubbles || this.ctx.payload.bubbles;\n\n        let changed = false;\n        for (var i = 0; i< bubbles.length; i++ ) {\n            let bubble = bubbles[i];\n\n            if ( bubble.isReady ) continue;\n\n\n            let shouldAssemble = true;\n\n            for (var j in bubble) {\n                if (bubble[j].tpl) {\n                    if ( !bubble[j].isRegistered ) {\n                        bubble[j].isRegistered = true;\n                        this.addBubble( bubble[j] )\n                    }\n                    if (!bubble[j].isReady) {\n                        shouldAssemble = false;\n                        continue;\n                    }\n                }\n            }\n\n            if (shouldAssemble) {\n                let node = ub.assembleTpl(bubble.tpl, bubble);\n                bubble.node = node;\n                bubble.isReady = true;\n                bubble.computedAtStep = this.ctx.payload.step++;\n                changed = true;\n            }\n        }\n        if ( changed)\n            this.iterateBubbles( bubbles, count+1)\n\n    },\n\n    addBubble: function (bubble) {\n        bubble.uid = cu.uids.run(\"bubble\");\n        bubble.addedAtStep = this.ctx.payload.step;\n        this.ctx.payload.bubbles.push(bubble);\n        //this.iterateBubbles();\n    },\n\n    start: function (molds) {\n        this.ctx.payload = {\n            bubbles: [],\n            molds: molds,\n            step : 0,\n        }\n    }\n\n}\n\n\nvar inputs = {\n    tplTree: {\n        x: `\n            <div><input id='order' syncwith={value} />\n            {value} \n            <div id='menu'> </div>\n            <div id='bar'> </div>\n            <div id='window' > {content}</div>\n            </div>\n        `,\n        y: \"salut {#test} salutare din alt template \"\n    }\n}\nvar test = (result) => {\n\n    ub.start(ub.parseTpl(_.cloneDeep(inputs.tplTree)));\n\n    ub.addBubble({\n        tpl: \"x\", \n        value : \"salutare\", \n        value_setter : () => { console.log( \"setting\")},\n        content : {\n            tpl : \"y\",\n            \"#test\" : \"yo\"\n        }\n    })\n\n    ub.iterateBubbles();\n\n    result.bubbles = ub.ctx.payload;\n    //cu.tests.pin( \"mold\", value)\n    //result.mold = value;\n    //return nodes;\n}\n\nlet data = window.salut = { value: \"elefant\" }\ncu.testTplAssembing = {\n    //test,\n\n    run: function () {\n        ub.start(ub.parseTpl(_.cloneDeep(inputs.tplTree)));\n\n        ub.addBubble({\n            tpl: \"x\", \n            value : \"salutare\", \n            value_setter : () => { console.log( \"setting\")},\n            content : {\n                tpl : \"y\",\n                \"#test\" : \"yo\"\n            }\n        })\n    \n        ub.iterateBubbles();\n    \n        //result.bubbles = ub.ctx.payload;\n        return ub.ctx.payload.bubbles[0].node;\n    },\n\n    init: function () {\n        ub.ctx.tb.parser = cu.tplObjParse;\n        ub.ctx.tb.reactAssembler = cu.reactAssembler;\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nvar cu = window.cu;\n\n\nvar ub = {\n\n    ctx: {\n        payload: {\n            tpls: {},\n            registerTpl: function (args, result,  master) {\n\n                result.obj.uid = cu.uids.run();\n\n                if ( result.obj.mold.props ) result.obj.mold.props.tplId = result.obj.uid;\n                //this.tpls.push(args.path);\n\n                this.tpls[ args.path.join(\".\") ] = result.obj.uid;\n            }\n        },\n\n        tb: {\n            //parseHtml: cu.parseStringIntoComp\n        }\n    },\n\n    run : function ( obj, attrs ) {\n        let oldPayload = this.ctx.payload;\n\n        this.ctx.payload.attrs = attrs;\n\n        let mold = this.it( obj, []);\n\n        this.ctx.payload = oldPayload;\n\n        return mold;\n    },\n\n\n    it: function (obj, path) {\n        let oldPayload = null;\n        let result = {\n            oldPayload: null,\n\n            obj: obj,\n            sub: obj,\n\n            master: this,\n            path: path,\n            values: obj,\n            ops: []\n        }\n\n        this.prepare(result);\n\n        for (var i in result.sub) {\n            let ret = this.it(result.sub[i], path.concat(i));\n            result.values[i] = ret;\n        }\n\n        return this.integrate(result)\n    },\n\n    addPayload: function (result, obj) {\n        if (!result.oldPayload) {\n            result.oldPayload = this.ctx.payload;\n            this.ctx.payload = Object.create(this.ctx.payload);\n        }\n        Object.assign(this.ctx.payload, obj);\n    },\n\n    prepare: function (result) {\n        let checks = {\n            isString: result => result.obj && result.obj.trim,\n            isUnparsedTpl: result => result.obj && result.obj.html && !result.obj.mold,\n            isCollection : result => result.obj && result.obj.isCollection,\n            isObjTpl     : result => result.obj && result.obj.VALUE\n        }\n\n        let cases = {\n            \"isString\": (result) => {\n                result.values = result.obj = { html: result.obj };\n                result.sub = [];\n                return \"applied\";\n            },\n            \"isUnparsedTpl\": (result) => {\n                result.sub = [];\n                let obj = Object.assign({}, result.obj, {\n                    mold: this.ctx.tb.parseHtml.run( result.obj.html, this.ctx.payload.attrs )\n                })\n\n                result.values = result.obj = obj;\n\n                result.ops.push({ name: \"registerTpl\", path: result.path })\n                return \"applied\";\n            },\n            \"isCollection\": (result) => {\n                let sub = {};\n                for ( var i in result.obj ) {\n                    if ( i == \"isCollection\") continue;\n                    sub[ i ] = { VALUE : result.obj[i]}\n                }\n                result.values = {};\n                result.sub = sub;\n                return \"applied\";\n            },\n            \"isObjTpl\": (result) => {\n                result.sub = [];\n                let obj = Object.assign({}, result.obj, {\n                    mold: this.ctx.tb.parseObj.run( result.obj.VALUE, this.ctx.payload.attrs )\n                })\n\n                result.values = result.obj = obj;\n\n                result.ops.push({ name: \"registerTpl\", path: result.path })\n                return \"applied\";\n            },\n        }\n\n        let hasChanges = true;\n        let applied = false;\n        let count = 0;\n        while (hasChanges && count < 5) {\n            hasChanges = false;\n            count++;\n            for (var i in cases) {\n                let _check = checks[i];\n                if (!_check(result)) continue;\n\n                let _case = cases[i];\n                let ret = _case(result);\n                if (ret == \"applied\") {\n                    hasChanges = true;\n                    applied = true;\n                    break;\n                }\n            }\n        }\n    },\n\n    integrate: function (result) {\n        if (result.ops.length) {\n            for (var i in result.ops) {\n                let op = result.ops[i];\n                this.ctx.payload[op.name](op, result, this)\n            }\n        };\n\n        if (result.oldPayload) this.ctx.payload = result.oldPayload;\n\n        return result.values;\n    }\n}\n\nvar test = (result) => {\n    let value = ub.run({ x: `\n        <div pin = \"test\" > \n        <input id=\"dalut\" test=\"{salut}\" />\n            <div> \n                    <div xid='x{#tes}'> \n                    </div>\n            </div>\n\n        </div>\n    `, y: { a: { b: `\n    \n        <div id='yo'> Salutare </div>\n    ` } },\n\nv : {\n\n    isCollection : true, \n    a : {\n        test : \"{x}\"\n    }\n}}, []);\n    //value = ub.it(value, []);\n\n    result.mold = value;\n}\n\ncu.tplObjParse = {\n    //test,\n\n    run: function (obj, attrs ) {\n        return ub.run(obj, attrs )\n    },\n\n    init : function ( ) {\n        ub.ctx.tb.parseHtml = cu.parseStringIntoComp;\n        ub.ctx.tb.parseObj = cu.parseObjIntoMold;\n    },\n    \n    def: `\n        @obj with string or .html slots \n        transform it into componentsObjects\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n        tb: {},\n        payload1: {\n            tplsMapping: [\n                \"map\",\n                \"topic\",\n                \"item\",\n                \"entry\"\n            ],\n            defaultTpl: \"item\",\n            usedGlobalStyles: {},\n\n\n            addSubs: function (args, result, master) {\n                result.obj.subs = result.values;\n                //console.log( arguments );\n\n                let obj = result.obj;\n                let content = [];\n                for (var i in result.values) {\n                    let item = result.values[i];\n                    if (item.nodes && item.nodes.card)\n                        content.push(item.nodes.card)\n                }\n\n                if (content) {\n                    result.obj.nodes.content = master.ctx.payload.useTemplate(obj.tpl + \".content\", { subs: content });\n                }\n\n                let data = result.obj.nodes;\n                result.obj.nodes.card = master.ctx.payload.useTemplate(obj.tpl + \".card\", data)\n\n            },\n\n            useTemplate: function (tpl, data, skipGlobalStyle) {\n\n                if (!skipGlobalStyle) {\n                    let route = tpl.split(\".\");\n                    let root = ub.ctx.wallet.molds;\n\n                    for (var i = 0; i < route.length; i++) {\n                        let step = route[i];\n                        if (root[step].globalStyle) {\n                            let id = root[step].globalStyle.uid;\n                            this.usedGlobalStyles[id] = { parent: root[step] };\n                        }\n                        if (root[step])\n                            root = root[step];\n                        else break;\n                    }\n                }\n\n                let mold = _.get(ub.ctx.wallet.molds, tpl); // .item.title;\n                return ub.ctx.tb.reactAssembler.run(mold, data)\n            },\n            cases: [\n                (result, master) => {\n\n                    let isApplicable = !result.obj.data\n                    if (!isApplicable) return;\n\n                    let tpls = master.ctx.payload.tplsMapping;\n\n                    let defaultTpl = tpls[result.obj.level] || master.ctx.payload.defaultTpl;\n\n\n                    let obj = {\n                        tpl: result.obj.tpl || defaultTpl,\n                        data: result.obj.item,\n                        level: result.obj.level,\n                        nodes: {}\n                    }\n\n                    result.subs = result.obj.subs;\n                    result.obj = obj;\n                    result.ops.push({ name: \"addSubs\", args: \"subs\" })\n\n                    return \"applied\"\n                },\n\n                (result, master) => {\n                    let isApplicable = !result.obj.nodes.title\n                    if (!isApplicable) return;\n\n                    let obj = result.obj;\n\n                    let mold = ub.ctx.wallet.molds.item.title;\n                    let values = {\n                        title: result.obj.data.text,\n                        level: result.obj.level\n                    }\n\n                    result.obj.nodes.title = master.ctx.payload.useTemplate(obj.tpl + \".title\", values);\n\n                    return \"applied\"\n                },\n\n\n            ]\n\n        },\n\n    },\n\n    getMolds: function (tpls) {\n        let molds = this.ctx.tb.parser.run(tpls);\n        return molds;\n    },\n\n\n    buildTpls: function (data) {\n        let node = this.ctx.tb.iterator.run(data, { payload: this.ctx.payload1 });\n        return node;\n    },\n\n    addGlobalStyles: function (nodes, gbs) {\n        let styles = [];\n        gbs = gbs || this.ctx.payload1.usedGlobalStyles\n\n\n        var parent;\n\n        let makeSelector = (path) => \"[tplid='\" + parent[path].uid + \"']\";\n\n        let getter = (data, path) => {\n            if (parent[path]) {\n                return makeSelector(path)\n            }\n            else if (path == \"*\")\n\n                return Object.keys(parent).filter(item => item != \"globalStyle\").map(item => makeSelector(item)).join(\",\")\n\n            return _.get(data, path)\n        }\n\n        let data = { color: \"red\" }\n        for (var i in gbs) {\n            parent = gbs[i].parent;\n            let style = ub.ctx.tb.reactAssembler.run(parent.globalStyle, data, getter)\n            styles.push(style)\n        }\n\n        if (styles.length) {\n            nodes = [nodes, styles];\n        }\n        return nodes;\n    }\n}\n\nvar input = {\n    tpls: {\n        map: {\n            title: \"<div class='title level{level}'>{title}</div>\",\n            content: \"<div>{subs}</div>\",\n            card: \"<div class='map'>{title} {content} </div>\",\n            style: `\n\n            `\n        },\n        topic: {\n            title: \"<div class='title level{level}'>{title}</div>\",\n            content: \"<div class='content'>{subs}</div>\",\n            card: \"<div class='topic'>{title} {content} </div>\"\n        },\n        item: {\n            title: \"<div class='title level{level}'>{title}</div>\",\n            content: \"<div class='content'>{subs}</div>\",\n            card: \"<div class='item'>{title} {content} </div>\",\n            style: `\n            \n            `\n        },\n        entry: {\n            title: \"<div class='title level{level}'>{title}</div>\",\n            content: \"<div class='content'>{subs}</div>\",\n            card: \"<div class='entry'>{title} {content} </div>\"\n        },\n\n        summart: {\n            title: \"<div class='title level{level}'>{title}</div>\",\n            content: \"<div class='content'>summary</div>\",\n            card: \"<div class='entry'>{title} {content} </div>\",\n            style: `\n            \n            `\n        },\n\n        columns: {\n            title: \"<div class='title level{level}'>{title}</div>\",\n            content: \"<div class='content'>{subs}</div>\",\n            card: \"<div class='columns'>{title} {content} </div>\",\n            globalStyle: `<style htmlSlot='content'>\n               {content} { display : flex; background : hsla(100, 50%, 70%, 0.4)}\n               {content}>* { flex-basis : 100px; padding :0px 10px; border-left : 1px solid red; }\n         \n            </style>`\n        },\n    }\n}\n\nvar test = (result) => {\n    let wallet = {\n        molds: ub.getMolds(input.tpls),\n        repo: cu.tests.get(\"testRepo\"),\n    }\n\n    ub.ctx.wallet = wallet;\n\n    wallet.tpls = ub.buildTpls(wallet.repo);\n\n    let card = wallet.tpls.nodes.card;\n    card = ub.addGlobalStyles(card)\n    cu.tests.pin(\"testRoot\", card)\n    Object.assign(result, wallet)\n}\n\ncu.treeCardsBuilder = {\n    //test,\n\n    run: function (obj) {\n\n        let wallet = ub.ctx.wallet = {\n            molds : obj.molds,\n            repo  : obj.data\n        };\n\n        Object.assign(ub.ctx.payload1, {\n            tplsMapping: obj.mappings.tplsMapping,\n            defaultTpl: obj.mappings.defaultTpl, \n            usedGlobalStyles: {},\n        });\n\n        wallet.tpls = ub.buildTpls(wallet.repo);\n\n        let card = wallet.tpls.nodes.card;\n        card = ub.addGlobalStyles(card)\n\n        return card;\n    },\n\n    init: function () {\n        ub.ctx.tb.parser = cu.tplObjParse;\n        ub.ctx.tb.reactAssembler = cu.reactAssembler;\n        ub.ctx.tb.iterator = cu.treeIterator;\n    },\n\n    def: `\n    `,\n\n    debug: {\n        ub: ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n    },\n\n    run : function ( obj, attrs ) {\n        let oldPayload = this.ctx.payload;\n\n        this.ctx.payload.attrs = attrs;\n\n        let mold = this.it( obj, []);\n\n        this.ctx.payload = oldPayload;\n\n        return mold;\n    },\n\n\n    it: function (obj, path) {\n        let oldPayload = null;\n        let result = {\n            oldPayload: null,\n\n            obj: obj,\n            sub: obj,\n\n            master: this,\n            path: path,\n            values: {},\n            ops: []\n        }\n\n        this.prepare(result);\n\n        for (var i in result.subs) {\n            let ret = this.it(result.subs[i], path.concat([i]));\n            result.values[i] = ret;\n        }\n\n        return this.integrate(result)\n    },\n\n    addPayload: function (result, obj) {\n        if (!result.oldPayload) {\n            result.oldPayload = this.ctx.payload;\n            this.ctx.payload = Object.create(this.ctx.payload);\n        }\n        Object.assign(this.ctx.payload, obj);\n    },\n\n    prepare: function (result) {\n\n        let cases = this.ctx.payload.cases;\n\n        let hasChanges = true;\n        let applied = false;\n        let count = 0;\n        while (hasChanges && count < 5) {\n            hasChanges = false;\n            count++;\n            for (var i in cases) {\n                let _case = cases[i];\n                let ret = _case(result, this);\n                if (ret == \"applied\") {\n                    hasChanges = true;\n                    applied = true;\n                    break;\n                }\n            }\n        }\n    },\n\n    integrate: function (result) {\n        if (result.ops.length) {\n            for (var i in result.ops) {\n                let op = result.ops[i];\n                this.ctx.payload[op.name](op.args, result,  this)\n            }\n        };\n\n        if (result.oldPayload) this.ctx.payload = result.oldPayload;\n\n        return result.obj;\n    }\n}\n\nvar test = (result) => {\n}\n\ncu.treeIterator = {\n    //test,\n\n    run: function (obj, ctx ) {\n        let mub = Object.create( ub )\n        mub.ctx = ctx;\n        if ( !ctx.payload ) ctx.payload = { cases : [] }\n        return mub.run(obj, [])\n    },\n\n    init : function ( ) {\n        //ub.ctx.tb.parser = cu.tplObjParse;\n        //ub.ctx.tb.reactAssembler = cu.reactAssembler;\n    },\n    \n    def: `\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","import _ from \"lodash\"\nimport faker from \"faker\"\nvar cu = window.cu;\n\n\n\nvar ub = {\n\n    ctx: {\n        nextUID : 0\n    },\n\n    run : function (name ) {\n        return (name || \"uid\" ) +\"_\"+ this.ctx.nextUID++;\n    },\n\n}\n\nvar test = (result) => {\n}\n\ncu.uids = {\n    //test,\n\n    run: function (name) {\n        return ub.run(name);\n    },\n    \n    def: `\n    `,\n\n    debug : {\n        ub : ub\n    }\n}","import _ from \"lodash\"\nimport \"../libs/dataManager\";\n\nvar cu = window.cu;\n\ncu.DataManager = window.DataManager;\n\nfor (var i in cu) {\n    if (cu[i].init) cu[i].init();\n}\n\n\n\ncu.tests = {\n    wallet: {\n        test: {},\n        pins: {},\n        pending: []\n    },\n    pin: function (name, value) {\n        this.wallet.pins[name] = value;\n    },\n    get: function (name) {\n        let value = _.get(this.wallet.pins, name);\n        if (!value) value = _.get(this.wallet.test, name);\n        return value;\n    }\n}\n\n\nfor (var i in cu) {\n    if (cu[i].test) {\n        cu.tests.wallet.pending.push(i);\n\n    }\n}\n\n\nlet passes = 0;\nwhile (passes < 5 && cu.tests.wallet.pending.length) {\n    let i = cu.tests.wallet.pending.shift();\n    passes++;\n    let result = {};\n    let ret;\n    try {\n        ret = cu[i].test(result);\n    } catch (e) {\n        console.log(\"error when running \", i, e)\n    }\n\n    if (ret == \"pending\") {\n        cu.tests.wallet.pending.push(i)\n        continue;\n    }\n    console.group(\"test for \", i)\n\n    cu.tests.wallet.test[i] = result;\n\n    if (ret) console.log(ret)\n    if (Object.keys(result)) {\n        for (var i in result) console.log(i, result[i])\n    }\n    console.groupEnd();\n}\n\nif (cu.tests.wallet.pending.length)\n    console.error(\"error with tests : \")\n\n\n","\nimport cu from './main.js';\nimport './units/actionFlow.js';\nimport './units/brand.js';\nimport './units/bubbleBoard.js';\nimport './units/bubbleFlow.js';\nimport './units/bubbleGuns.js';\nimport './units/bubbleTest.js';\nimport './units/bubbleTypes.js';\nimport './units/db.js';\nimport './units/parseObjIntoMold.js';\nimport './units/parseStringIntoComp.js';\nimport './units/prettyScode.js';\nimport './units/reactAssembler.js';\nimport './units/reactUtils.js';\nimport './units/store.js';\nimport './units/testDataGenerator.js';\nimport './units/testMolds.js';\nimport './units/testTplAssembling.js';\nimport './units/tplObjParse.js';\nimport './units/treeCardsBuilder.js';\nimport './units/treeIterator.js';\nimport './units/uids.js';\nimport './init.js';\nexport default cu;\n   ","import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport CodeMirrorEditor from \"./components/CodeMirrorEditor\";\nimport _ from \"lodash\";\nimport $ from \"jquery\";\nimport go from \"gojs\";\nimport \"./libs/dataManager\";\nimport KeyboardManager from \"./managers/KeyboardManager\"\nimport StaticManager from \"./managers/StaticManager\"\nimport { TimerManager as TimerManagerBuilder } from \"./managers/TimerManager\"\nimport PouchDB from \"pouchdb\"\nimport js_beautify from \"js-beautify\"\nimport faker from 'faker'\nimport cu from \"./units/\"\nimport moment from \"moment\"\nimport MapDiagram from \"./components/TreeDiagram\"\nimport { reject } from 'q';\n\n\nvar fns = window.fns = {}\n\nwindow.$ = $;\n\nvar ctxpins = window.ctxpins = {};\n\nvar customComponents = {\n  codemirror: CodeMirrorEditor,\n  mapdiagram: MapDiagram,\n}\n\nvar DataManager = window.DataManager;\nDataManager.newAPI = true;\n\nvar TimerManager = TimerManagerBuilder.init(DataManager);\n\n//--------------------\nwindow.$ = $;\n\nvar pinedTasks = `\n`\n\n\nlet myUB = window.myUB = {};\n\nDataManager.setCombined(\"fnsub\", {\n  loader: {\n    get: function () {\n\n\n\n      let fns = myUB;\n\n      if (!fns.fnsub || !fns.fnsub.isReady) {\n        this.make(fns, \"fnsub\", \"ub.fnsub\", {\n          old: fns.fnsub\n        })\n\n        this.setupAll(fns);\n      }\n\n      fns.fnsub.makeUb(\"mapview\", \"ub.mapView\", {\n        \"tb.db\": \"db\",\n        \"state\": \"antsDbState\",\n      })\n\n      fns.fnsub.makeUb(\"antsDbState\", \"ub.antsDbState\", {\n        \"tb.db\": \"db\"\n      })\n\n\n      fns.fnsub.makeUb(\"bridgeLoader\", \"ub.loaders.bridge\", {\n        \"tb.db\": \"db\"\n      })\n\n      fns.fnsub.makeUb(\"searchLoader\", \"ub.loaders.search\", {\n        \"tb.db\": \"db\"\n      })\n\n\n      fns.fnsub.makeUb(\"hudView\", \"ub.loaders.hud\", {\n        \"tb.db\": \"db\"\n      })\n\n\n\n      fns.fnsub.makeUb(\"db\", \"ub.db\", {})\n\n      fns.fnsub.makeUb(\"afterRenderActions\", \"ub.afterRenderActions\", {})\n\n\n      fns.fnsub.makeUb(\"shop\", \"ub.actionshops\", {\n        \"tb.db\": \"db\"\n      });\n\n      fns.fnsub.setupAll();\n\n    },\n\n    setupAll: function (fns) {\n      for (var i in fns) {\n        if (fns[i].goSetup)\n          this.setup(fns, fns[i])\n      }\n\n      return true;\n    },\n\n    make: function (fns, name, path, extra) {\n      let obj = Object.create(DataManager.getValue(path));\n      obj.goSetup = true;\n      obj.extra = extra;\n      obj.uid = cu.uids.run();\n\n      if (fns[name]) _.merge(fns[name], obj)\n      else\n        fns[name] = obj;\n    },\n\n    setup: function (fns, obj) {\n      delete obj.goSetup;\n\n      let values = {};\n      for (var i in obj.extra) {\n        let target = _.isString(obj.extra[i]) ? _.get(fns, obj.extra[i]) : obj.extra[i];\n        if (!target) {\n          target = {};\n          _.set(fns, obj.extra[i], target)\n        }\n        _.set(values, i, target)\n      }\n\n      if (obj.setup)\n        obj.setup(values);\n\n      obj.isReady = true;\n    },\n\n    autostart: true\n\n  }\n})\n\n\n\nDataManager.setCombined(\"ub.afterRenderActions\", {\n  setup: function (opts) {\n    _.merge(this, opts);\n\n    this.wallet = {\n      actions: []\n    }\n  },\n\n  add: function (name) {\n    this.wallet.actions.push(name);\n  },\n\n  runAll: function () {\n    let actions = this.wallet.actions;\n    this.wallet.actions = [];\n\n    for (var i in actions) {\n      if (this[actions[i]])\n        this[actions[i]]();\n    }\n  },\n  scrollIntoViewSelected: function () {\n    let target = $(\".content.selected\").get(0);\n    if (target) target.scrollIntoViewIfNeeded(false);\n  },\n\n  alertAnimation: function () {\n    if ($(\"body.alert\").length) return;\n\n    $(\"body\").addClass(\"alert\");\n\n    window.setTimeout(() => {\n      $(\"body\").removeClass(\"alert\")\n    }, 5000)\n  }\n})\nDataManager.setCombined(\"ub.antsDbState\", {\n  setup: function (opts) {\n    _.merge(this, opts);\n\n    this.wallet = {\n      state: {\n        prefix: \"ants\",\n        id: \"antsDbState\",\n        nextId: 1\n      }\n    };\n\n    myUB.fnsub.onready(this.tb.db)\n      .then(() => {\n        return this.tb.db.loadItems([\"antsDbState\"])\n      })\n      .catch(() => {\n      })\n      .then((state) => {\n        if (!state[0]) {\n          this.tb.db.saveItems(this.uid, [this.wallet.state])\n        }\n        else {\n          this.wallet.state = state[0];\n          this.isReady = true;\n        }\n      })\n  },\n\n  getId: function () {\n    this.wallet.state.nextId++;\n    this.tb.db.request_save(this.uid, [this.wallet.state], 100)\n    return \"ant_\" + this.wallet.state.nextId;\n  },\n\n  getTime: function () {\n    return new Date().getTime();\n  }\n})\n\n\n\nmyUB.fnsub = {\n  subs: [],\n  waiting: {},\n  makeUb: function (a, b, c) {\n    this.subs.push([a, b, c])\n  },\n  onready: function (sub) {\n    let payload = {};\n    let promise = new Promise((resolve) => {\n      payload.resolve = resolve;\n    })\n\n    if (!this.waiting[sub.uid]) this.waiting[sub.uid] = [];\n\n    this.waiting[sub.uid].push(payload);\n\n    return promise;\n  }\n}\n\n\nDataManager.setCombined(\"ub.antsDbState\", {\n  setup: function (opts) {\n    _.merge(this, opts);\n\n    this.wallet = {\n      state: {\n        prefix: \"ants\",\n        id: \"antsDbState\",\n        nextId: 1\n      }\n    };\n\n    myUB.fnsub.onready(this.tb.db)\n      .then(() => {\n        return this.tb.db.loadItems([\"antsDbState\"])\n      })\n      .catch(() => {\n      })\n      .then((state) => {\n        if (!state[0]) {\n          this.tb.db.saveItems(this.uid, [this.wallet.state])\n        }\n        else {\n          this.wallet.state = state[0];\n          this.isReady = true;\n        }\n      })\n  },\n\n  getId: function () {\n    this.wallet.state.nextId++;\n    this.tb.db.request_save(this.uid, [this.wallet.state], 100)\n    return \"ant_\" + this.wallet.state.nextId;\n  },\n\n  getTime: function () {\n    return new Date().getTime();\n  }\n})\n\nDataManager.setCombined(\"ub.fnsub\", {\n  setup: function (opts) {\n\n    _.merge(this, opts)\n\n    this.fns = opts.fns || myUB;\n\n    this.waiting = this.waiting || {};\n\n    let setupRequired = false;\n\n    if (this.old && this.old.subs) {\n      for (var i in this.old.subs) {\n        let sub = this.old.subs[i];\n        this.makeUb(sub[0], sub[1], sub[2])\n      }\n      setupRequired = true;\n      delete this.subs;\n    }\n\n    if (opts.ubs) {\n      for (var i in opts.ubs) {\n        let ub = opts.ubs[i];\n        this.makeUb(ub.name, ub.path, ub.extra)\n      }\n      setupRequired = true;\n    }\n\n    if (setupRequired)\n      this.setupAll();\n  },\n\n\n  detach: function () {\n    let id = cu.uids.run();\n\n    let name = \"internal_\" + id;\n\n    this.makeUb(name, \"ub.fnsub\", {\n      id: id,\n      fns: {},\n      parent: this\n    });\n\n    this.setupAll();\n\n\n    let item = this.fns[name];\n\n    this.fns[name].fns.fnsub = item;\n\n    item.getFromParent(\"db\")\n    return item.fns;\n  },\n\n\n  getFromParent: function (names) {\n    if (_.isString(names)) {\n      names = [names]\n    }\n\n    for (var i in names) {\n      let name = names[i] || i;\n      let ub = this.parent.fns[name];\n\n      this.fns[name] = ub;\n    }\n  },\n  addUb: function (spec) {\n    if (_.isArray(spec)) {\n      spec.forEach(spec => {\n        if (_.isString(spec) || !spec.name) this.getFromParent(spec)\n        else this.makeUb(spec.name, spec.path, spec.extra)\n      });\n      this.setupAll();\n      return;\n    }\n    this.makeUb(spec.name, spec.path, spec.extra);\n    this.setupAll();\n\n    return this.fns[spec.name];\n  },\n  addUbs: function (spec) {\n    this.addUb(Object.values(spec));\n  },\n  setupAll: function () {\n    let fns = this.fns;\n    for (var i in fns) {\n      if (fns[i].goSetup)\n        this.setupUb(fns[i])\n    }\n\n    return true;\n  },\n\n  makeUb: function (name, path, extra, fns) {\n\n    fns = fns || this.fns;\n    let obj = _.isString(path) ? Object.create(DataManager.getValue(path)) : path;\n    obj.goSetup = true;\n    obj.extra = extra;\n    obj.uid = fns[name] && fns[name].id ? fns[name].uid : (extra.id || cu.uids.run());\n\n\n    if (fns[name]) _.merge(fns[name], obj)\n    else\n      fns[name] = obj;\n  },\n\n  setupUb: function (obj, fns) {\n    fns = fns || this.fns;\n    delete obj.goSetup;\n\n    let values = {};\n    for (var i in obj.extra) {\n      let target = _.isString(obj.extra[i]) ? _.get(fns, obj.extra[i]) : obj.extra[i];\n      if (!target) {\n        target = { uid: cu.uids.run() };\n        _.set(fns, obj.extra[i], target)\n      }\n      _.set(values, i, target)\n    }\n\n    if (obj.setup)\n      obj.setup(values);\n\n    obj.isReady = true;\n\n    if (this.waiting[obj.uid]) {\n      this.waiting[obj.uid].forEach(payload => {\n        payload.resolve()\n      })\n\n      this.waiting[obj.uid] = [];\n    }\n  },\n\n  onready: function (sub) {\n\n    if (sub.isReady) return Promise.resolve();\n\n    let payload = {};\n    let promise = new Promise((resolve) => {\n      payload.resolve = resolve;\n    })\n\n    if (!this.waiting[sub.uid]) this.waiting[sub.uid] = [];\n    this.waiting[sub.uid].push(payload);\n\n    return promise;\n  }\n\n\n});\n\nDataManager.setCombined(\"ub.db\", {\n  setup: function () {\n    this.db = cu.db.run(\"thisdb\");\n    this.timers = {};\n  },\n\n  destroy: function () {\n    this.db.destroy();\n  },\n  request_save: function (id, src, delay) {\n    if (this.timers[id]) window.clearTimeout(this.timers[id]);\n\n    this.timers[id] = window.setTimeout(() => {\n      this.saveItems(id, src)\n    }, delay || 1000)\n  },\n\n  saveItems: function (id, src) {\n    if (this.timers[id]) window.clearTimeout(this.timers[id]);\n\n    let items = (_.isArray(src)) ? src : src.getItemsToSave();\n    let promises = [];\n    for (var i in items) {\n      promises.push(this.db.save(items[i], items[i].id));\n    }\n\n    return Promise.all(promises)\n  },\n\n  loadItems: function (src, loadedItems) {\n    let items = (_.isArray(src)) ? src : src.getItemsToSave();\n    let promises = [];\n    loadedItems = loadedItems || {};\n\n    for (var i in items) {\n      if (loadedItems[i])\n        promises.push(Promise.resolve(loadedItems[i]))\n      else\n        promises.push(this.db.load(items[i]))\n\n    }\n\n    return Promise.all(promises);\n  },\n\n\n  searchText: function (text) {\n    return this.db.searchText(text)\n  },\n\n  loadFilter: function (filter, count, sort) {\n    return this.db.loadfilter(filter, count, sort)\n  },\n\n  loadFromIndex: function (params) {\n    let { selector, sortField, sortDir, count, index } = params;\n\n    return this.db.loadFromIndex(selector, sortField, sortDir, count, index);\n  }\n})\n\n\nDataManager.setCombined(\"actionShop.actions\", {\n  makePreview: {\n    path: \"actionshops.generatePreviewItem\",\n    opName: \"main\",\n    guards: {},\n    args: { id: \"antId\", items: \"items\", save: \"save\" },\n    argsArray: { antId: \"1\" }\n  },\n\n  makeTreeMap: {\n    path: \"actionshops.makeTreeMap\",\n    opName: \"main\",\n    guards: {},\n    args: { id: \"antId\", items: \"items\" }\n  }\n})\n\nDataManager.setCombined(\"ub.actionshops\", {\n  setup: function () {\n    this.shops = {};\n    this.ub = myUB.fnsub.detach();\n\n  },\n\n  go: function (actionName, args, guards) {\n    let actions = DataManager.getWallet(\"actionShop.actions\");\n    let action = actions[actionName];\n\n    let path = action.path;\n    let name = action.opName;\n    //let guards = action.guards;\n\n    let values = {};\n    for (var i in action.args) {\n      let slot = action.args[i];\n      let val = _.get(args, i);\n      if (val !== undefined)\n        _.set(values, slot, val)\n    }\n\n    return this.run(path, name, values, guards)\n  },\n  run: function (path, name, values, guards) {\n    let shop = this.get(path);\n\n    return shop.run(name, values, guards);\n  },\n  get: function (path) {\n    let shop;\n    if (this.shops[path]) {\n      shop = this.shops[path]\n    }\n    else {\n      shop = this.createShop(path)\n    }\n\n    return shop;\n  },\n\n  createShop: function (path, extra) {\n    let specs = DataManager.getValue(path);\n    specs = _.cloneDeep(specs);\n\n    specs.setup = cu.actionFlow.setupFlow;\n\n\n    let view = {\n      name: path,\n      path: specs,\n      extra: {\n        \"tb.db\": \"db\",\n      }\n    };\n\n    if (extra) {\n      _.merge(view.extra, extra);\n    }\n\n    let item = this.ub.fnsub.addUb(view)\n\n    this.shops[path] = item;\n\n    return item;\n  },\n\n})\n\n\n\nDataManager.setCombined(\"ub.values\", {\n  setup: function (opts) {\n    Object.assign(this, opts)\n  },\n\n  set: function (path, value) {\n    _.set(this.data, path, value)\n  },\n  get: function (path) {\n    return _.get(this.data, path);\n  },\n  trigger: function (name, value, partial) {\n    console.log(\"triggered\", { name, value, partial })\n    this.set(name, value);\n    let loaderPath = this.data.blockcfg.loaderPath\n    DataManager.markChangeOn(loaderPath, false, true);\n  }\n})\n\nDataManager.setCombined(\"actionsBundle.tree\", {\n  tree: {\n    treeTemplate: {\n      run: function (args, v) {\n        let items = [];\n\n        this.processNode(args.data, args.tpl, items);\n\n        v.actions.pinTo(args, items, v);\n      },\n      processNode: function (data, tpl, v) {\n        let item = cu.moldAssembler.run(tpl, data);\n\n        for (var i in data.subs) {\n          this.processNode(data.subs[i], tpl, v)\n        }\n\n        v.push(item);\n        return item;\n      }\n    },\n    makeTree: {\n      run: function (args, v) {\n        let result = this.makeNode(args, args.startId, { startNode: true }, 0);\n        v.actions.pinTo(args, result, v);\n        return result;\n      },\n\n      makeNode: function (v, id, info, level) {\n        let subs = v.rels[id];\n        let item = v.items[id];\n\n        let result = { subs: {}, item, info, count: 0, level };\n\n        if (!v.maxLevel || v.maxLevel > level)\n          for (var i in subs) {\n            result.subs[i] = this.makeNode(v, i, subs[i], level + 1);\n            result.count++;\n          }\n\n        return result;\n      }\n    },\n\n  }\n})\nDataManager.setCombined(\"actionsBundle.generics\", {\n  isCollection: true,\n  fields: {\n    field: function (args, v) {\n      let value = args.defaultValue || \"\";\n      if (args.item && args.item.fields && args.item.fields[args.field])\n        value = args.item.fields[args.field]\n\n      v.actions.pinTo(args, value, v)\n\n    },\n  },\n  ops: {\n    ops: function (args, v) {\n      console.log(\"test\");\n      v.master.run(args.ops)\n    }\n  },\n\n  molds: {\n    makeMold: function (args, v) {\n      let result = cu.tplObjParse.run(_.cloneDeep(args.tpls));\n      v.actions.pinTo(args, result, v);\n    }\n  },\n})\n\n\nDataManager.setCombined(\"actionshops.card\", {\n  data: {\n    tpls: {\n      card: \"<div>{title} {content}<div>\",\n      title: \"<div> {item.title} </div>\",\n      item: \"<div> {item.title} </div>\"\n    },\n\n    content: \"salut\",\n    item: {\n      title: \"elefant\"\n    }\n\n  },\n  opsCollection: {\n    main: [\n      { name: \"salut\", type: \"runop\", op: \"makeCard\", prefix: \"temp\" }\n    ],\n    setup: {\n      molds: { name: \"molds\", type: \"makeMold\", input: { tpls: \"tpls\" } },\n      ops: { name: \"makeCard\", type: \"combineMoldInOps\", outcome: \"card\", input: { molds: \"molds\" }, list: \"card,title,item\" }\n    }\n  },\n\n  actions: {\n    import: \"actionsBundle.generics\",\n    my: {\n\n      runop: function (args, v) {\n        v.master.run(args.op, args.value || {}, {\n          outcome: [\n            function (path, value, partial) {\n              console.log(\"DONE\", path, value)\n            }\n          ]\n        }, {\n            prefix: args.prefix\n          })\n      },\n      combineMoldInOps: function (args, v) {\n        let names = args.list.split(\",\");\n        let tpls = {};\n        names.forEach(name => {\n          tpls[name] = _.get(args.molds, name);\n        })\n\n        let ops = [];\n\n        let needed = {};\n\n        for (var i in tpls) {\n          let tpl = tpls[i];\n          let op = { type: \"useTpl\", name: null, tpl: null, input: {} }\n          let slot = i == args.outcome ? \"outcome\" : i;\n          op.name = slot;\n          op.tpl = tpl;\n\n          let params = tpl.mold.parameters;\n\n          for (var i in params) {\n            op.input[i] = i;\n            needed[i] = true;\n          }\n\n          ops.push(op)\n        }\n\n        for (var i in ops) {\n          delete needed[ops[i].name]\n        }\n\n        console.log(needed);\n\n        console.log(\"OPS\", ops)\n\n        v.master.ctx.opsCollection[args.name] = ops;\n        ///v.actions.pinTo( args, ops, )\n        console.log(\"master\", v.master)\n      }\n    }\n  }\n})\n\n\nDataManager.setCombined(\"actionshops.generatePrview\", {\n  ops: [\n    { name: \"allmaps\", type: \"searchItems\", filter: { type: \"map\" } },\n    { name: \"previewIds\", type: \"generatePreviewItems\", input: { maps: \"allmaps\" } },\n    { name: \"previews\", type: \"loadItems\", input: { ids: \"previewIds\" } },\n    { type: \"log\", input: { maps: \"allmaps\", previewIds: \"previewIds\", no: \"noPreviews\" } },\n\n    { name: \"noPreviews\", type: \"getItemsWithsNoPreview\", input: { previews: \"previews\", ids: \"allmaps\" } },\n\n    { type: \"iterateList\", input: { items: \"noPreviews\" } }\n  ],\n\n  actions: {\n    import: \"actionsBundle.generics\",\n    myx: {\n      iterateList: function (args, v) {\n        let items = args.items;\n        let index = 0;\n\n        let cb = function (value) {\n          let prom = new Promise((resolve) => {\n            v.tb.generatePreview.run(\"main\", value, {\n              DONE: [\n                (value) => {\n                  console.log(\"done\", value)\n                  resolve(value)\n                }\n              ]\n            })\n          })\n          return prom;\n        }\n\n        let fn = function () {\n          index++;\n          if (index >= items.length) return;\n          let value = items[index];\n          return cb(value).then((result) => {\n          }).then(fn);\n        }\n\n        fn();\n\n\n      },\n      generatePreviewItems: function (args, v) {\n        let ids = args.maps.map(map => { return \"preview_\" + map.id });\n\n        v.actions.pinTo(args, ids, v)\n        return ids;\n      },\n\n      getItemsWithsNoPreview: function (args, v) {\n        var previews = args.previews;\n        var ids = args.ids;\n\n        var items = [];\n\n        for (var i in previews)\n          if (!previews[i]) items.push({ antId: ids[i].id })\n\n\n        //console.log( \"items without preview\", items)\n        v.actions.pinTo(args, items, v)\n\n      }\n    }\n  },\n})\n\n\nDataManager.setCombined(\"actionshops.getRecentPreview\", {\n  ops: [\n    {\n      name: \"previewMaps\",\n      type: \"loadFromIndex\",\n      selector: { type: \"previewItem\" },\n      sortField: \"updatedAt\",\n      sortDir: \"desc\",\n      count: 3,\n      index: [\"updatedAt\", \"type\"],\n      append: \"items\"\n    },\n\n    { type: \"log\", input: { items: \"list\", maps: \"previewMaps\", subitems: \"subitems\" } },\n\n    { name: \"subids\", type: \"selectIds\", input: { src: \"previewMaps\" }, paths: [\"\", \"rels.allSubs\", \"id\"] },\n\n    { name: \"subitems\", append: \"items\", type: \"loadItems\", input: { ids: \"subids\" } },\n\n\n    { name: \"list\", type: \"runopOnList\", input: { subitems: \"subitems\", list: \"previewMaps\", repo: \"items\" }, op: \"map\", result: \"outcome\" }\n  ],\n\n  opsCollection: {\n    line: [\n      { name: \"outcome\", type: \"useTpl\", input: { item: \"item\", time: \"time\", tpl: \"molds.line\" } },\n      { name: \"time\", type: \"makeTime\", input: { timestamp: \"item.placedAt\" } },\n\n    ],\n\n    map: [\n      { type: \"debug\" },\n      { type: \"log\", input: { subitems: \"subitems\", content: \"xcontent\" } },\n      { name: \"outcome\", type: \"useTpl\", input: { item: \"item\", tpl: \"molds.map\", content: \"xcontent\" } },\n      { name: \"subitems\", type: \"getSubitems\", input: { items: \"items\", subs: \"item.rels.allSubs\" } },\n      { name: \"xcontent\", type: \"runopOnList\", input: { list: \"subitems\" }, op: \"line\", result: \"outcome\" },\n      //{ name: \"content\", type: \"listOfOps\", input: {} }\n    ],\n    setup: [\n      { name: \"molds\", input: { tpls: \"tpls\" }, type: \"makeMold\" },\n    ],\n  },\n\n  data: {\n    tpls: {\n      line: \"<div class='adv_entry'><span class='time'>{time}</span> {item.text}</div>\",\n      map: \"<div class='adv_map'>{item.text} <div class='content'> {content}</div></div>\"\n    }\n  },\n\n  actions: {\n    molds: {\n      makeMold: function (args, v) {\n        let result = cu.tplObjParse.run(_.cloneDeep(args.tpls));\n        v.actions.pinTo(args, result, v);\n      }\n    },\n    myx: {\n\n      debug: function (op, tb) {\n        console.log(\"debug\", tb.privat.xcontent, tb.ops)\n      },\n      getSubitems: function (op, v) {\n        let items = [];\n\n        for (var i in op.subs) {\n          items.push(op.items[i])\n        }\n\n        items.sort((a, b) => b.placedAt - a.placedAt)\n        console.log(\"getSubitems\", op.subs, items)\n        v.actions.pinTo(op, items, v)\n      },\n      makeTime: function (op, v) {\n        let time = moment(op.timestamp).fromNow()\n        v.actions.pinTo(op, time, v);\n      },\n\n      runop: function (args, v) {\n        return new Promise((resolve, reject) => {\n\n          console.log(\"runio\", args.xcontent);\n\n          v.master.run(args.op, {},\n            {\n              outcome: [\n                function (path, value, partial) {\n                  resolve(value);\n                }\n              ],\n            },\n            {\n              privat: _.cloneDeep(args)\n            })\n        });\n      },\n\n      runopOnList: function (args, v) {\n        let values = [];\n\n        let list = args.list;\n\n        let xxx = (args.op + args.name)\n        let i = -1;\n\n        let fn = () => {\n          i++;\n          if (i >= list.length) return;\n\n          let opargs = Object.assign({}, _.cloneDeep(args), { item: list[i], index: i })\n\n          return v.actions.runop(opargs, v).then(value => {\n            values.push(value)\n          }).then(fn)\n        }\n\n\n        fn().then(() => {\n          v.actions.pinTo(args, values, v)\n\n        })\n\n      },\n\n\n      selectIds: function (op, v) {\n        let items = [];\n        let paths = op.paths;\n\n        let src = [op.src];\n\n        for (var j = 0; j < paths.length; j++) {\n          let path = paths[j];\n          let items = [];\n          for (var i in src) {\n            let value;\n            if (path) value = _.get(src[i], path)\n            else value = src[i];\n            if (value) {\n              let val = _.isObject(value) ? _.values(value) : value;\n              items = items.concat(val)\n            }\n          }\n          src = items;\n        }\n\n        v.actions.pinTo(op, src, v)\n      }\n    }\n  }\n})\n\nwindow.moment = moment;\n\nDataManager.setCombined(\"actionshops.getListWithoutPreview\", {\n  ops: [\n    { name: \"allmaps\", type: \"searchItems\", filter: { type: \"map\" } },\n    { name: \"previewIds\", type: \"generatePreviewItems\", input: { maps: \"allmaps\" } },\n    { name: \"noPreviews\", extra: { withPreview: \"withPreview\" }, type: \"getItemsWithsNoPreview\", input: { previews: \"previews\", ids: \"allmaps\" } },\n    { name: \"previews\", type: \"loadItems\", input: { ids: \"previewIds\" } },\n    { type: \"log\", input: { previews: \"previews\" } }\n\n  ],\n\n  actions: {\n    import: \"actionsBundle.generics\",\n    myx: {\n      generatePreviewItems: function (args, v) {\n        let ids = args.maps.map(map => { return \"preview_\" + map.id });\n\n        v.actions.pinTo(args, ids, v)\n        return ids;\n      },\n\n      getItemsWithsNoPreview: function (args, v) {\n        var previews = args.previews;\n        var ids = args.ids;\n\n        var items = [];\n        var withPreview = [];\n\n        for (var i in previews)\n          if (!previews[i]) items.push({ antId: ids[i].id })\n          else withPreview.push(previews[i])\n\n        console.log(\"items without preview\", { no: items, wt: withPreview })\n        v.actions.pinTo(args, items, v)\n\n      }\n    }\n  },\n})\n\nDataManager.setCombined(\"actionshops.generatePreviewItem\", {\n  data: {\n    antId: \"ant_2\",\n\n    tpls: {\n      obj: {\n        isCollection: true,\n        preview: {\n          \"rels.allSubs\": \"{latestSubs}\",\n          text: \"{text}\",\n          id: \"preview_{mapId}\",\n          mapId: \"{mapId}\",\n          summary: \"{summary}\",\n          type: \"previewItem\",\n          updatedAt: \"{updatedAt}\"\n        }\n      }\n    }\n  },\n\n  x: { go: \"getField\", on: \"\", use: { item: \"root\" }, field: \"summary\", defaultValue: \"\" },\n\n  ops: [\n    { type: \"log\", input: { outcome: \"previewAnt\" } },\n    { name: \"root\", append: \"items\", input: { id: \"antId\" }, type: \"loadItem\" },\n    { name: \"subs\", append: \"items\", input: { ids: \"root.rels.allSubs\" }, type: \"loadItems\" },\n    { name: \"latest\", extra: { date: \"updatedAt\" }, type: \"getLatestSubs\", input: { root: \"root\", items: \"subs\" }, count: 4 },\n    { name: \"summary\", type: \"field\", input: { item: \"root\" }, field: \"summary\", defaultValue: \"\" },\n    { name: \"previewAnt\", type: \"useTpl\", input: { text: \"root.text\", tpl: \"molds.obj.preview\", latestSubs: \"latest\", mapId: \"antId\" } },\n    //{ type: \"saveItems\", input: { items: \"previewAnt\" } },\n\n    { type: \"fn\", input: { fn: \"save\", item: \"previewAnt\" } },\n  ],\n\n  valuesChain: {\n    \"antId\": {\n      unset: \"root,subs,latest,summary,previewAnt\",\n      reset: {\n        save: { value: (value) => { } }\n      }\n    }\n  },\n\n  opsCollection: {\n    setup: [\n      { name: \"molds\", input: { tpls: \"tpls\" }, type: \"makeMold\" },\n    ],\n\n    test: [\n      { type: \"log\", input: { outcome: \"previewAnt\" } },\n\n      { name: \"root.fields.summary\", type: \"staticValue\", input: { root: \"root\", value: \"summary\" } },\n\n    ],\n  },\n  actions: {\n    bundle: \"actionsBundle.generics\",\n    items: {\n      getLatestSubs: function (args, v) {\n        let items = args.items;\n        items.sort((a, b) => b.placedAt - a.placedAt);\n        let latest = items.slice(0, args.count);\n\n        let date;\n        if (latest.length > 0) {\n          date = latest[0].placedAt;\n        }\n        else date = args.root.startedAt;\n\n        if (args.extra.date)\n          v.actions.pinTo({ pin: args.extra.date }, date, v)\n\n        let latestSubs = {};\n        for (var i in latest)\n          latestSubs[latest[i].id] = { id: latest[i].id, position: i }\n\n        v.actions.pinTo(args, latestSubs, v)\n      }\n    },\n  }\n});\n\n\n\n\n\nDataManager.setCombined(\"actionshops.makeTreeMap\", {\n  data: {\n    antId: \"ant_2\",\n\n    tpls: {\n      main: \"<treemap graph={graph} on_click={actions.select} />\"\n    }\n  },\n  ops: [\n\n    { name: \"root\", append: \"items\", input: { id: \"antId\" }, type: \"loadItem\" },\n    { name: \"subs\", append: \"items\", input: { ids: \"root.rels.allSubs\" }, type: \"loadItems\" },\n    { type: \"log\", input: { items: \"items\", graph: \"graph\" } },\n    { type: \"useTpl\", name: \"nodes\", input: { tpl: \"molds.main\", graph: \"graph\" } },\n    { type: \"getNodesVis\", name: \"graph\", input: { _s: \"subs\", startId: \"root.id\", items: \"items\", subs: \"root.rels.sub\" } },\n    { type: \"getActions\", name: \"actions\" }\n  ],\n\n  valuesChain: {\n    \"antId\": {\n      unset: \"root,subs,graph,nodes\",\n      reset: {\n        save: { value: (value) => { } }\n      }\n    }\n  },\n\n  opsCollection: {\n    setup: [\n      { name: \"molds\", input: { tpls: \"tpls\" }, type: \"makeMold\" },\n    ],\n  },\n  actions: {\n    bundle: \"actionsBundle.generics\",\n    items: {\n\n      getActions: function (op, v) {\n\n        var actions = cu.store.get(null, hapi, {\n          runWithParam: {\n            select: \"select\"\n          }\n        });\n\n\n        v.actions.pinTo(op, actions, v)\n      },\n      getNodes: function (op, v) {\n        let graph = {\n          nodes: [],\n          links: []\n        }\n        let fn = function (id, parentIndex, level) {\n          if (level > 3) return;\n          let index = graph.nodes.push({ name: op.items[id].text, radius: Math.max(5, 40 - level * 10) }) - 1;\n\n          if (parentIndex !== null)\n            graph.links.push({ target: index, source: parentIndex, value: 1 })\n          for (var i in op.subs[id]) {\n            fn(i, index, level + 1)\n          }\n        }\n\n        fn(op.startId, null, 0)\n\n        console.log( \"graph\", graph )\n        v.actions.pinTo(op, graph, v)\n      },\n      getNodesVis: function (op, v) {\n        let graph = {\n          nodes: [],\n          edges: []\n        }\n        let fn = function (id, parentIndex, level, parentId) {\n          //if (level > 3) return;\n          let nodeId = graph.nodes.length + 1;\n          let index = graph.nodes.push({ id: id, label: op.items[id].text }); //name :  op.items[ id ].text ,radius : Math.max( 5, 40  - level * 10 ) } ) -1 ;\n\n          if (parentIndex !== null)\n            graph.edges.push({ to: id, from: parentId })//, value : 1})\n          for (var i in op.subs[id]) {\n            fn(i, index, level + 1, id)\n          }\n        }\n\n        fn(op.startId, null, 0)\n\n        graph.seed = 2;\n        v.actions.pinTo(op, graph, v)\n      }\n    },\n  }\n});\n\n\n\n\n\n\n///2\n\nvar hapi = {\n\n  showMindMap: function (id) {\n    DataManager.runOnLoader(\"antsView.formPanel.nodes\", \"change\", { id: id })\n    DataManager.set(\"workingant.viewState.path\", \"antsView.formPanel.nodes\");\n    DataManager.markChangeOn(\"workingant.viewState\", false, true)\n\n  },\n\n  showhud: function () {\n    let currentView = DataManager.getValue(\"workingant.viewState.path\");\n\n    currentView = currentView !== \"antView.map.nodes\" ? \"map\" : \"bridge\"\n\n    this.goToCard(currentView);\n\n    //DataManager.set(\"workingant.viewState.path\", currentView);\n  },\n  placeorder: function (evt) {\n    if (evt.which !== 13) return;\n\n    flow.place();\n    DataManager.set(\"workingant.data.input\", { text: \"\" })\n    flow.restart();\n  },\n  set: function (path, value) {\n    DataManager.set(path, value)\n  },\n  parseinput: function () {\n    let text = DataManager.getValue(\"workingant.data.input\");\n    if (_.isString(text))\n      flow.parse(text)\n  },\n\n  select: function (id) {\n    console.log(\"selecting\", id)\n    flow.change({ parent: id })\n    DataManager.set(\"repo.uistate.selected\", id)\n\n    $(\"#order\").focus();\n\n    myUB.afterRenderActions.add(\"scrollIntoViewSelected\")\n  },\n\n  goToInfo: function (id) {\n    DataManager.set(\"antsView.hudPanel.cfg.antId\", id);\n    //DataManager.set(\"workingant.viewState.overPanel.hud\", \"antsView.hudPanel.nodes\")\n    this.goToCard(\"info\");\n    return false;\n  },\n\n  goToCard: function (id) {\n    var cards = {\n      bridge: \"antView.bridge.nodes\",\n      map: \"antView.map.nodes\",\n      info: \"antsView.hudPanel.nodes\"\n    }\n\n    let path = cards[id];\n\n    if (id == \"bridge\") {\n      myUB.bridgeLoader.loadBridge();\n    }\n\n    DataManager.set(\"workingant.viewState.path\", path);\n\n  },\n\n  selectMap: function (id) {\n    console.log(\"selecting map\", id);\n    myUB.mapview.loadMap(id)\n    this.goToCard(\"map\");\n  },\n}\n\nDataManager.setTrigger(\"workingant.data.input\", \"ada\", {\n  run: hapi.parseinput\n})\n\n\nDataManager.setCombined(\"ub.menu\", {\n  setup: function () {\n\n  },\n\n  getAll: function () {\n    return DataManager.getValue(\"data.menu\");\n  },\n  set: function (path, value) {\n    DataManager.set([\"data.menu\", path].join(\".\"), value)\n  },\n  showMenu: function () {\n    this.set(\"isvisible\", true);\n  },\n  hideMenu: function () {\n    this.set(\"isvisible\", false);\n  },\n\n  addEntries: function () {\n\n  }\n})\n\nDataManager.setCombined(\"ub.flow\", {\n  start: function () {\n    this.wallet = {\n      step: { createdAt: new Date().getTime() },\n    }\n  },\n\n  parse: function (input) {\n    if (input.indexOf(\".s\") == 0) {\n\n\n      this.wallet.step.showSearch = true;\n      this.wallet.step.noPlace = true;\n    }\n    else {\n      this.wallet.step.showSearch = false;\n      this.wallet.step.noPlace = false;\n    }\n\n    var result = input.match(/^(\\.[^\\s]+\\s+)*/)\n    var text = input.substr(result[0].length)\n    var dirs = result[0].trim().split(\" \");\n\n    if (!this.wallet.step.editStartedAt) this.wallet.step.firstCharAt = new Date().getTime();\n\n    this.wallet.step.text = text;\n  },\n\n  place: function () {\n    let ant = {\n      text: this.wallet.text,\n      id: myUB.antsDbState.getId(),\n      times: {\n        createdAt: this.wallet.step.createdAt,\n        firstCharAt: this.wallet.step.firstCharAt,\n        addedAt: new Date().getTime()\n      }\n    };\n\n    let parent = this.getParent();\n  }\n\n})\n\nvar flow = {\n\n  start: function () {\n    this.wallet = {\n      step: {},\n      actions: this.main,\n      parser: this.parser\n    }\n  },\n\n  restart: function () {\n    let prevStep = this.wallet.step;\n    this.wallet = {\n      step: {\n        parent: prevStep.parent\n      },\n      startedAt: new Date().getTime(),\n      actions: this.main,\n      parser: this.parser\n    }\n  },\n\n  parse: function (text) {\n    this.wallet.parser.parse(this.wallet, text)\n  },\n\n  change: function (values) {\n    this.wallet.actions.change(this.wallet, values)\n  },\n\n  place: function () {\n    this.wallet.actions.place(this.wallet)\n  },\n\n  parser: {\n    parse: function (wallet, text) {\n      wallet.actions.change(wallet, { text: text, x: text.substr(1) })\n    }\n  },\n\n  main: {\n    place: function (wallet) {\n      if (wallet.step.text == \"destroy\") {\n        myUB.db.destroy();\n        return;\n      }\n      else if (wallet.step.text.indexOf(\".m\") == 0) {\n        let id = this.createMap(wallet.step.text.substr(2).trim());\n        hapi.selectMap(id);\n        return;\n      }\n      else if (wallet.step.text.indexOf(\".gi\") == 0) {\n        let id = wallet.step.parent;\n        if (!id) return;\n\n        //hapi.selectMap(id);\n        hapi.goToInfo(id);\n        return;\n      }\n      else if (wallet.step.text.indexOf(\".e\") == 0) {\n        let id = this.changeItem({ text: wallet.step.text.substr(2).trim() }, wallet);\n        return;\n      }\n      else if (wallet.step.text.indexOf(\".i\") == 0) {\n        this.addInfo({ text: wallet.step.text.substr(2).trim() }, wallet);\n        return;\n      }\n      else if (wallet.step.text.indexOf(\".t\") == 0) {\n        let text = wallet.step.text.substr(2).trim();\n        let root = DataManager.getWallet(\"repo.root\");\n        let parent = root.id;\n\n        wallet.step.text = text;\n        wallet.step.parent = parent;\n        wallet.step.selectItem = true;\n      }\n\n      this.add(wallet)\n\n      myUB.afterRenderActions.add(\"alertAnimation\");\n    },\n    change: function (wallet, values) {\n      _.merge(wallet.step, values)\n    },\n\n    createMap: function (name) {\n      let id = myUB.antsDbState.getId();\n      let ant = {\n        id: id,\n        text: name,\n        startedAt: myUB.antsDbState.getTime(),\n        type: \"map\",\n\n        rels: {\n          sub: {},\n          allSubs: {}\n        },\n        mapId: id,\n        parentId: id\n      }\n\n      myUB.mapview.mergeItem(ant.id, ant);\n      DataManager.set(\"repo.items.\" + ant.id, ant);\n\n      return ant.id;\n    },\n\n    changeItem: function (change, wallet) {\n      let id = wallet.step.parent;\n      if (!id) return;\n\n      let ant = DataManager.getWallet(\"repo.items.\" + id);\n\n      _.merge(ant, change);\n\n      if (!ant.history) ant.history = []\n      ant.history.push({ changeAt: Date.now() });\n\n      myUB.mapview.mergeItem(id, ant);\n      DataManager.set(\"repo.items.\" + id, ant);\n\n    },\n\n    addInfo: function (text, wallet) {\n\n      let parent = wallet.step.parent;\n      let root = DataManager.getWallet(\"repo.root\");\n\n      if (!parent)\n        return;\n\n\n      let id = myUB.antsDbState.getId();\n\n      let ant = {\n        text: text,\n        id: id,\n        startedAt: wallet.startedAt,\n        placedAt: new Date().getTime(),\n        mapId: root.id,\n        parentId: parent,\n        targetId: id,\n        type: \"info\"\n      }\n\n      console.log(\"Adding info to\", parent)\n\n      myUB.mapview.mergeItem(parent, { hasInfo: true })\n      myUB.mapview.mergeItem(id, ant);\n      myUB.mapview.mergeRoot(_.set({}, \"rels.info.\" + parent + \".\" + id, { id: id, parent: parent }))\n\n      DataManager.markChangeOn(\"repo.items\", false, true, true);\n      DataManager.markChangeOn(\"repo.root\", false, true);\n\n\n      //DataManager.mergeValue(\"repo.items.\" + parent, { hasInfo: true })\n      //DataManager.set(\"repo.items.\" + id, ant);\n      //DataManager.set(\"repo.root.rels.info.\" + parent + \".\" + id, { id: id, parent: parent })\n    },\n\n    add: function (wallet) {\n\n      let parent = wallet.step.parent;\n      let root = DataManager.getWallet(\"repo.root\");\n\n      if (!parent) {\n        parent = root.id;\n      }\n\n      let state = DataManager.getWallet(\"repo.state\");\n      state.nextId++;\n\n      let id = myUB.antsDbState.getId();\n\n      let ant = {\n        text: wallet.step.text,\n        id: id,\n        startedAt: wallet.startedAt,\n        placedAt: new Date().getTime(),\n        mapId: root.id,\n        parentId: parent\n      }\n\n\n      let obj = {\n        \"{id}\": \"{ant}\",\n        \"{ant.mapId}.rels.sub.{ant.parentId}.{ant.id}\": { id: \"{ant.id}\", parent: \"{ant.parentId}\" },\n        \"{ant.mapId}.rels.allSubs.{ant.id}\": { id: \"{ant.id}\", parent: \"{ant.parentId}\" }\n      }\n\n      myUB.mapview.mergeItem(id, ant);\n      myUB.mapview.mergeRoot(_.set({}, \"rels.sub.\" + parent + \".\" + id, { id: id, parent: parent }))\n      myUB.mapview.mergeRoot(_.set({}, \"rels.allSubs.\" + id, { id: id, parent: parent }))\n\n      DataManager.markChangeOn(\"repo.items\", false, true, true);\n      DataManager.markChangeOn(\"repo.root\", false, true);\n\n      //DataManager.set(\"repo.items.\" + id, ant);\n      //DataManager.set(\"repo.root.rels.sub.\" + parent + \".\" + id, { id: id, parent: parent })\n      //DataManager.set(\"repo.root.rels.allSubs.\" + id, { id: id, parent: parent })\n\n\n      //DataManager.mergeItem( root.id + \"_state\", {lastItemId : id, changedAt : Date.now() }  )\n\n      if (wallet.step.selectItem) {\n        hapi.select(id);\n      }\n      else hapi.select(parent)\n    }\n  }\n}\nflow.start();\n\n\n\n\n\nDataManager.setCombined(\"ub.loaders.map\", {\n  load: function (id) {\n    let startIds = [id, \"info_\" + id]\n    this.tb.db.loadItems(startIds)\n      .then(items => {\n        for (var i in items) {\n          let item = items[i];\n          if (!item) continue;\n          this.wallet.items[items[i].id] = items[i];\n        }\n        if (items[0])\n          this.wallet.root = items[0];\n      })\n      .then(() => {\n        let root = this.wallet.root;\n        let related = _.get(root, \"rels.allSubs\") || {};\n        let ids = Object.keys(related);\n        return this.tb.db.loadItems(ids)\n      })\n      .then(items => {\n        for (var i in items) {\n          let item = items[i];\n          if (!item) continue;\n          this.wallet.items[item.id] = item;\n        }\n      })\n      .then(() => {\n        DataManager.set(\"repo.items\", this.wallet.items)\n        DataManager.set(\"repo.root\", this.wallet.root)\n\n        //notify;\n      })\n  },\n\n});\n\n\nDataManager.setCombined(\"ub.loaders.bridge\", {\n  setup: function (opts) {\n    _.merge(this, opts)\n  },\n\n  loadBridge: function () {\n    let items = {\n      top: {\n        notdb: true,\n        text: \"top\",\n        id: \"top\"\n      },\n      recent: {\n        notdb: true,\n        text: \"recent\",\n        id: \"recent\"\n      },\n      all: {\n        notdb: true,\n        text: \"all\",\n        id: \"all\"\n      },\n\n      root: {\n        notdb: true,\n        text: \"\",\n        id: \"root\"\n      }\n    };\n    let rels = {\n      sub: {\n        root: { top: true, recent: true, all: true },\n        top: {},\n        recent: {},\n        all: {}\n      }\n    }\n\n    items.root.rels = rels;\n\n    this.tb.db.loadFilter({ type: \"map\" }, 10, \"dateChanged\")\n      .then(result => {\n        for (var i in result.docs) {\n          let item = result.docs[i];\n          if (!item.brand) item.brand = cu.brand.getBrand(item.id + item.startedAt);\n\n          items[item.id] = item;\n\n          if (item.text.indexOf(\"ma\") != -1) {\n            rels.sub.top[item.id] = true;\n          }\n\n          if (item.startedAt) {\n            rels.sub.recent[item.id] = { date: item.startedAt }\n          }\n\n          rels.sub.all[item.id] = true;\n        }\n      })\n      .then(() => {\n\n        DataManager.setCombined(\"bridgeRepo\", {\n          items: items,\n          root: items.root\n        })\n      })\n  }\n})\n\n\nDataManager.setCombined(\"ub.loaders.search\", {\n  setup: function (opts) {\n    _.merge(this, opts)\n  },\n\n  search: function () {\n    let items = {\n\n    };\n    let rels = {\n      sub: {\n        root: { top: true, recent: true, all: true },\n        top: {},\n        recent: {},\n        all: {}\n      }\n    }\n\n    items.root.rels = rels;\n\n    this.tb.db.loadFilter({ type: \"map\" }, 10, \"dateChanged\")\n      .then(result => {\n        for (var i in result.docs) {\n          let item = result.docs[i];\n          if (!item.brand) item.brand = cu.brand.getBrand(item.id + item.startedAt);\n\n          items[item.id] = item;\n\n          if (item.text.indexOf(\"ma\") != -1) {\n            rels.sub.top[item.id] = true;\n          }\n\n          if (item.startedAt) {\n            rels.sub.recent[item.id] = { date: item.startedAt }\n          }\n\n          rels.sub.all[item.id] = true;\n        }\n      })\n      .then(() => {\n\n        DataManager.setCombined(\"bridgeRepo\", {\n          items: items,\n          root: items.root\n        })\n      })\n  }\n})\n\nDataManager.setCombined(\"ub.mapView\", {\n  setup: function (args) {\n    this.wallet = {\n      items: {},\n      root: {\n        id: \"ant1\",\n        text: \"welcome\",\n        rels: { sub: {} },\n        type: \"map\",\n        notdb: true,\n      },\n      changed: {},\n      state: { nextId: 1 }\n    };\n\n    this.wallet.items.ant1 = this.wallet.root;\n\n    _.merge(this, args)\n\n    return this;\n  },\n  loadMap: function (id) {\n\n    let startIds = [id, \"info_\" + id]\n\n    let root = DataManager.getWallet(\"repo.root\")\n\n    let start = Promise.resolve();\n\n    if (root.id !== id) {\n      if (!root.notdb)\n        start = start.then(() => this.saveItems());\n\n\n      start = start.then(() => {\n        this.wallet.items = {}\n        this.wallet.root = {\n          id: id,\n          notdb: true,\n          rels: { sub: {} },\n        }\n        this.wallet.items[id] = this.wallet.root;\n        DataManager.set(\"repo.items\", this.wallet.items)\n        DataManager.set(\"repo.root\", this.wallet.root)\n      })\n    }\n\n    start.then(() => this.tb.db.loadItems(startIds))\n      .then(items => {\n        for (var i in items) {\n          let item = items[i];\n          if (!item) continue;\n          this.wallet.items[items[i].id] = items[i];\n        }\n        if (items[0]) {\n          let item = items[0];\n          this.wallet.root = item;\n          if (true || !item.brand) item.brand = cu.brand.getBrand(item.id + item.startedAt)\n\n          let customTpl = {\n            logo: cu.brand.getLogo(item.id + item.startedAt, 10, 5)\n          }\n          let customMolds = cu.tplObjParse.run(customTpl);\n          DataManager.setCombined(\"customTpl\", customTpl);\n\n        }\n      })\n      .then(() => {\n        let root = this.wallet.root;\n        let related = _.get(root, \"rels.allSubs\") || {};\n        let ids = Object.keys(related);\n        return this.tb.db.loadItems(ids)\n      })\n      .then(items => {\n        for (var i in items) {\n          let item = items[i];\n          if (!item) continue;\n          this.wallet.items[item.id] = item;\n        }\n      })\n      .then(() => {\n        DataManager.set(\"repo.items\", this.wallet.items)\n        DataManager.set(\"repo.root\", this.wallet.root)\n\n        //notify;\n      })\n  },\n\n  getItemsToSave: function () {\n    let changed = this.wallet.changed;\n    this.wallet.changed = {};\n\n    let items = [];\n    for (var i in changed) {\n      if (this.wallet.items[i].notdb) continue;\n      items.push(this.wallet.items[i])\n    }\n    return items;\n  },\n  saveItems: function () {\n    let items = this.getItemsToSave();\n    return this.tb.db.saveItems(this.uid, items);\n  },\n  generateId: function () {\n    return this.tb.state.getId();\n  },\n  mergeItem: function (id, value, skipPreview) {\n    if (!id) id = this.generateId();\n    if (!this.wallet.items[id]) {\n      this.wallet.items[id] = { id: id, createdAt: new Date().getTime() };\n    }\n    _.merge(this.wallet.items[id], value);\n    this.wallet.items[id].salut = \"test\";\n\n    if (!skipPreview)\n      this.makePreview();\n\n    this.triggerChange(id);\n    return id;\n  },\n  mergeRoot: function (value) {\n    this.mergeItem(this.wallet.root.id, value)\n    return;\n    _.merge(this.wallet.root, value);\n\n    this.makePreview();\n\n    this.triggerChange(this.wallet.root.id);\n\n  },\n\n  makePreview: function () {\n\n    if (this.timerPreview) window.clearTimeout(this.timerPreview)\n\n    this.timerPreview = window.setTimeout(() => {\n\n      myUB.shop.go(\"makePreview\", {\n        id: this.wallet.root.id,\n        items: this.wallet.items,\n        save: (value) => {\n          this.mergeItem(value.item.id, value.item, true)\n        }\n\n      });\n\n      delete this.timerPreview;\n    }, 1)\n  },\n\n  triggerChange: function (id) {\n    this.wallet.changed[id] = true;\n    this.tb.db.request_save(this.uid, this, 2000);\n  },\n\n  setRel: function (rel, a, b, value) {\n    _.set(this.wallet.root, [\"rels\", rel, a, b], value);\n    this.triggerChange(this.wallet.root.id)\n  },\n\n})\nDataManager.setCombined(\"repo\", {\n  items: {},\n  root: {\n    id: \"ant1\",\n    text: \"welcome\",\n    rels: { sub: {} }\n  },\n  state: {\n    nextId: 2\n  }\n})\n\n\nDataManager.setCombined(\"antView.molds\", {\n  loader: {\n    get: function (tb) {\n      let molds = cu.tplObjParse.run(this.tpls);\n      return molds;\n    },\n    tpls: {\n      title: `<div >item : {value.text}</div>`,\n      item: `<div on_click={actions.select} antid={id}>item : {item.text}</div>`,\n      mapView: {\n        logo: cu.brand.getLogo(faker.company.catchPhrase(), 10, 5),\n\n        frame: `<div class='map'>{title} {content}\n\n        <style>\n          .map { font-size : 15px; margin : 10px;\n            line-height: 26px;\n            background : {colors.background}\n            }\n          .map * { font-size : 17px !important}\n          .map .title { font-size : 17px !important;}\n          .topic>.text { \n              border-bottom : 1px solid {root.brand.fadedColor} ; \n              display : inline-block;\n              padding-left : 5px;\n              padding-right: 25px;\n            }\n          .topic { \n            margin-bottom : 5px;\n            margin-top : 20px;\n            position : sticky;\n            top : 25px;\n            background : {colors.background};\n            z-index : 100\n          }\n\n          .card { \n            margin-bottom : 30px;\n          }\n          .content { margin-left : 10px; padding-left : 10px;}\n\n          .mapviewtitle { position:sticky; top : -30px; margin-bottom : 20px; background : {background}; z-index:200; } \n          .logo { display : inline-block; width : 50px; height : 50px; }\n\n          .selected.title::before { content : \"●\"; display:inline-block; margin-right : 5px; margin-left:5px; color : {root.brand.mainColor}; font-size: 0.7em !important; }\n\n          .title:active { transition: all 0.4s ease; background : #333 !important; }\n          .selected.content { \n            border-left :  1px dotted {root.brand.fadedColor};\n            padding-left:25px;\n            margin-bottom: 15px;\n          }\n\n          .selected.content::after {\n            content: \">\";\n            display: inline-block;\n            border-bottom: 1px dotted {root.brand.fadedColor} ;\n            overflow: hidden;\n            position: relative;\n            left: -25px;\n            padding-left : 10px;\n            top: 8px;\n            width: 20px;\n            margin: 0px;\n          }\n\n          .mapviewtitle { font-variant: petite-caps;}\n\n          polygon.poligon {\n            fill: {root.brand.mainColor} !important;\n          }\n\n          .handle { \n            display: inline-block;\n            font-variant: petite-caps;\n            font-size: 0.7em !important;\n            color: #999;          \n          }\n\n          .alert .poligon_2  {\n            animation: rotate_poligon 5s ease;\n          }\n          \n          @keyframes rotate_poligon {\n            0% {\n              opacity : auto\n            }\n            20% {\n              opacity : 0.2\n            }\n            70% {\n              opacity : 0.7\n            }\n            100% {\n              opacity : auto\n            }\n            \n          }\n\n          .crazy_animation { \n            transform-origin: center;\n            transform: rotate(360deg);\n            transform-box: fill-box;        \n          }\n\n          .info {\n            display: inline-block;\n            color: #ff8900;\n            border: 1px solid #ff8900;\n            text-align: -webkit-center;\n            width: 1.5em;\n            height: 1em;\n            border-radius: 10px;\n            margin-left: 5px;\n            overflow: hidden;\n            font-size: 0.6em !important;\n            vertical-align: middle;\n          }\n          .mindmap { \n            display : inline-block;\n            width : 30px;\n            height:30px;\n          }\n        </style>\n      </div>`,\n\n        title: `\n        <div class='mapviewtitle '> <div class='logo'>{logo}</div> \n          <span on_click={actions.select} antid={id} >{item.text}</span>\n          <span class='mindmap' on_click={actions.showMindMap} antid={id} >✈</span>\n        </div>`,\n      },\n\n\n      map: {\n        topic: \"<div on_click={actions.select} antid={id} class='title topic {isSelected}'><span pin='title' class='text'>{handle} {item.text} </span></div>\",\n        item: \"<div on_click={actions.select} antid={id} class='title item {isSelected}' pin='title'>{handle} {item.text}</div>\",\n        entry: \"<div on_click={actions.select} antid={id} class='title entry {isSelected}' pin='title'>{handle} {item.text}</div>\",\n        other: `<div on_click={actions.select} antid={id} class='title {isSelected}' pin='title'>{handle} {item.text}</div>`,\n        card: `<div class='card reveal {isSelected}'>{title} <div id='content' class='content {isSelected}'>{content}</div>{afterContent}</div>`,\n\n        button: \"<span class='button' on_click={actions.log}>?</span>\",\n        info: \"<span class='info' on_click={actions.goToInfo}>^</span>\",\n\n      },\n\n      handle: \"<span class='handle'>{handle}</span>\",\n\n      bridgeTitle: `<div>{value.text}</div>`,\n      frame: \"<div>{maptitle}{items}</div>\",\n\n      mapTitle: \"\"\n    }\n  }\n})\n\n\n\nDataManager.setCombined(\"antView.map\", {\n  nodes: {\n    loader: {\n      get: function (tb, v) {\n        tb.fetch({\n          uistate: \"repo.uistate\",\n          items: \"repo.items\",\n          root: \"repo.root\",\n          repo: \"repo\",\n          molds: \"antView.molds\",\n          customTpl: \"customTpl\"\n        }, v);\n\n        v.rows = Object.values(v.items);\n\n        let rows = [];\n\n        v.data = {}\n        v.actions = cu.store.get(tb, hapi, { runWith: { showMindMap: [\"showMindMap\", \"antid\"], select: [\"select\", \"antid\"], goToInfo: [\"goToInfo\", \"antid\"] } });\n\n        v.selected = v.uistate.selected;\n\n        v.color = \"#007abc\"\n        v.otherTpl = \"map.other\";\n        v.moldsMap = [\"map.topic\", \"map.item\", \"map.entry\"]\n        v.cardMold = \"map.card\";\n        v.background = \"#eee\";\n\n        //v.button = cu.reactAssembler.run(v.molds.map.button, v);\n        v.info = cu.reactAssembler.run(v.molds.map.info, v);\n\n        v.colors = {\n          background: \"#eee\"\n        }\n\n        v.body = this.getBody(v, v.root.id, v.root.rels.sub);\n        return v.body;\n      },\n\n      setV: function (value, v, memo) {\n        memo = memo || {};\n        for (var i in value) {\n          if (memo[i] === undefined)\n            memo[i] = v[i];\n          v[i] = value[i]\n        }\n\n        return memo;\n      },\n      cleanV: function (v, memo) {\n        for (var i in memo)\n          v[i] = memo[i];\n      },\n\n      getBody: function (v, id, sub) {\n        let list = this.getBodyList(v, id, sub);\n\n        let logo = v.customTpl.logo ? cu.reactAssembler.run(v.customTpl.logo, v) : \"\";\n        let memo = this.setV({ logo: logo, item: v.repo.root, id: v.repo.root.id }, v, memo)\n\n        let title = cu.reactAssembler.run(v.molds.mapView.title, v);\n        memo = this.setV({ content: list, title: title }, v, memo)\n        let node = cu.reactAssembler.run(v.molds.mapView.frame, v)\n        this.cleanV(v, memo);\n        return node;\n      },\n      getBodyList: function (v, id, sub) {\n        let related = sub[id];\n\n        if (!related) return null;\n        if (v.level > 5) return null;\n        let level = v.level != undefined ? v.level + 1 : 0\n\n        let list = [];\n        let memo = this.setV({\n          id: null,\n          item: null,\n          level: 0,\n          isSelected: null,\n          content: null,\n          title: null,\n          handle: null,\n          afterContent: null\n        }, v, memo);\n\n\n        let count = 1;\n        for (var i in related) {\n\n          Object.assign(v, {\n            id: i,\n            item: v.items[i],\n            level: level,\n            isSelected: v.selected == i ? \"selected\" : \"\",\n            count: count,\n            afterContent: null\n          })\n\n          let item = this.getItem(v, sub);\n          list.push(item);\n\n          count++;\n        }\n\n        this.cleanV(v, memo);\n        return list;\n      },\n\n      getHandle: function (v, level, count) {\n        let handle;\n        if (level == 0) {\n          handle = String.fromCharCode(64 + count) + \".\"\n        }\n\n        else if (level == 1) {\n          handle = count + \".\";\n        }\n        else if (level == 2) {\n          handle = \"▪\"\n        }\n        else {\n          handle = \"- \"\n        }\n\n        if (handle == undefined) return \"\";\n\n        let node = cu.reactAssembler.run(v.molds.handle, { handle: handle });\n\n        return node;\n      },\n\n      getItem: function (v, sub) {\n        let item = v.item;\n        let moldName = v.mold;\n        if (!moldName && v.moldsMap) {\n          moldName = v.moldsMap[v.level]\n        }\n\n        if (!moldName) moldName = v.otherTpl;\n        let titleMold = _.get(v.molds, moldName);\n\n\n        v.handle = this.getHandle(v, v.level, v.count);\n\n        v.title = cu.reactAssembler.run(titleMold, v);\n\n        /*\n        let titlePath = titleMold.mold.pins.title;\n        let title;\n        if (titlePath.length) title = _.get(v.title, titlePath);\n        else title = v.title;\n        if (!title.children) title.children = [];\n        title.children.push(v.button);\n        */\n\n        if (v.item.hasInfo) {\n\n          let titlePath = titleMold.mold.pins.title;\n          let title;\n          //v.title = _.cloneDeep( v.title );\n          if (titlePath.length) title = _.get(v.title, titlePath);\n          else title = v.title;\n          if (!title.children) title.children = [];\n\n\n          title.children.push(v.info)\n        }\n\n\n        v.content = this.getBodyList(v, v.id, sub);\n\n        if (v.isSelected && !v.content) v.content = [];\n\n\n        let node;\n        if (v.content) {\n          let cardMold = _.get(v.molds, v.cardMold);\n\n          node = cu.reactAssembler.run(cardMold, v)\n        }\n        else node = v.title;\n\n        return node;\n      },\n\n\n\n    }\n  }\n})\n\n\nDataManager.setCombined(\"antViewBridge.molds\", {\n  loader: {\n    get: function (tb) {\n      let molds = cu.tplObjParse.run(this.tpls);\n      return molds;\n    },\n    tpls: {\n      root: {\n        bridge: `<div class='bridge'>{content}{advanceView} </div>`,\n        card: `<div class='card'><div class='title'><span>{item.text}</span></div> <div class='content'>{content}</div></div>`,\n        item: `<div class='title item' antid='{id}' on_click='{actions.select}' style='--color:{item.brand.mainColor}'>{item.text}</div>`,\n        style: `\n          <style>\n            .title { \n              margin-bottom : 5px;\n              padding-left : 4px;\n            }\n            .item.title::before { \n              color : var(--color);\n              content : '𝌇';\n              display : inline-block;\n              padding-right : 5px; \n            }\n\n            .item.title:active { transition: all 0.4s ease; background : #333 !important; }\n\n\n            .card {\n              margin : 20px 10px;\n            \n              border : 1px solid {brand.borderColor};\n\n              padding : 10px;\n            }\n            .bridge { font-size : 18px; margin : 10px;\n              line-height: 25px;\n              }\n\n            .card>.content { \n            }\n            .card>.title{\n              position: sticky;\n              top: 0px;\n              background : {brand.background};\n              padding-bottom : 10px;\n\n            }\n\n            @keyframes enter {\n              0% { opacity : 0.5; height : 0; overflow:hidden; transform : scaleY(0) translateY( 15px ); }\n              100% { opacity : 1; height:auto; overflow:hidden; transform : scaleY(1) translateY( 0px ); }\n            }\n\n            #easel div { animation: enter 0.5s ease; }\n\n            .card>.title>span{ \n              border-bottom : 1px solid {brand.borderColor};\n              width : fit-content;\n              padding-left: 5px;\n              padding-right : 24px;\n              padding-bottom : 5px;\n              display : inline-block;\n              font-variant: petite-caps;\n            }\n          </style>\n        `\n      },\n    }\n  }\n})\n\n\nDataManager.setCombined(\"antView.bridge\", {\n  nodes: {\n    loader: {\n      get: function (tb, v) {\n        tb.fetch({\n          items: \"bridgeRepo.items\",\n          root: \"bridgeRepo.root\",\n          repo: \"bridgeRepo\",\n          molds: \"antViewBridge.molds\"\n        }, v);\n\n\n        this.addVFn(v);\n\n        v.tplSpecs = {\n          byLevel: [\"root.bridge\", \"root.card\", \"root.item\"],\n\n        }\n\n        v.brand = {\n          borderColor: \"#333\",\n          background: \"#eee\"\n        }\n\n        if (!tb.cache.advanceView) {\n          tb.cache.advanceView = { value: [\"loading\"] };\n\n          myUB.shop.run(\"actionshops.getRecentPreview\", \"main\", {}, {\n            list: [(path, value) => {\n              tb.cache.advanceView.value = value;\n              DataManager.markChangeOn(tb.path(), false, true);\n            }]\n          })\n\n        }\n        v.actions = cu.store.get(tb, hapi, { runWith: { select: [\"selectMap\", \"antid\"] } });\n\n\n        v.color = \"#007abc\"\n        v.otherTpl = \"map.other\";\n        v.moldsMap = []\n        v.defaultTpl = {\n          card: \"root.card\",\n          title: \"root.title\"\n        }\n        v.cardMold = \"map.card\";\n        v.background = \"#eee\";\n        v.level = 0;\n        v.subs = v.root.rels.sub;\n\n        v.id = \"root\";\n        v.item = v.root;\n        v.advanceView = tb.cache.advanceView.value;\n\n        let node = this.makeItem(v);\n\n        let style = cu.reactAssembler.run(v.molds.root.style, v)\n\n        return [node, style];\n      },\n\n      makeItem: function (v) {\n        let moldName = v.mold || v.tplSpecs.byLevel[v.level];\n        if (!moldName) console.error(\"no mold\", v);\n        let mold = _.get(v.molds, moldName);\n\n        let params = mold.mold.parameters;\n\n\n        if (params.content) {\n          let collection = v.subs[v.id];\n          let level = v.level + 1;\n          v.content = this.makeList(v, collection, (value, i) => {\n            return {\n              id: i,\n              item: v.items[i],\n              level: level\n            }\n          })\n        }\n\n\n        let node = cu.reactAssembler.run(mold, v)\n\n        return node;\n      },\n\n\n      makeList: function (v, collection, prepare) {\n        let list = [];\n        v.stack();\n\n        for (var i in collection) {\n          v.set(prepare(collection[i], i));\n          let node = this.makeItem(v);\n          list.push(node);\n        }\n\n        v.clean();\n\n        return list;\n      },\n\n\n\n      addVFn: function (v) {\n        v.set = function (value) {\n          let v = this;\n          let memo = v.memo;\n          for (var i in value) {\n            if (memo[i] === undefined)\n              memo[i] = v[i];\n            v[i] = value[i]\n          }\n\n        }\n\n        v.get = function (value) {\n          let v = this;\n          let memo = v.memo;\n          for (var i in value) {\n            if (memo[i] === undefined)\n              memo[i] = v[i];\n            v[i] = value[i]\n          }\n        }\n\n        v.clean = function () {\n          let v = this;\n          let memo = v.memo;\n\n          for (var i in memo)\n            v[i] = memo[i];\n\n          v.memo = v.stacks.pop();\n        }\n\n        v.stack = function () {\n\n          let v = this;\n\n          if (!v.stacks) v.stacks = [];\n\n          v.stacks.push(v.memo);\n\n          v.memo = {};\n        }\n\n\n      },\n\n\n    }\n  }\n})\n\nDataManager.setCombined(\"dbSavings\", {\n  items: {\n    /*\n    repoitems: { path: \"repo.items\", onload: [\"repo\", \"evaluateflow\"] },\n    bubblestate: \"repo.state\",\n    antsitems: \"repo.ants\",\n    */\n  }\n})\n\nDataManager.setCombined(\"tb.persisitence\", {\n  setup: function () {\n    this.db = cu.db.run(\"thisdb\");\n    window.onbeforeunload = () => { return this.saveAll() };\n    this.loadAll();\n\n  },\n\n  request_save: function () {\n    if (this.timer) window.clearTimeout(this.timer);\n\n    this.timer = window.setTimeout(() => {\n      this.saveAll()\n    }, 60000)\n  },\n\n  saveAll: function () {\n    let tosave = DataManager.getValue(\"dbSavings\").items\n    let savings = []\n    for (var i in tosave) {\n      savings.push(this.saveitem(i, tosave[i]))\n    }\n\n  },\n  saveitem: function (id, target) {\n    let path = target.path || target;\n    let repo = DataManager.getWallet(path);\n    return this.db.save({ repo }, id)\n  },\n\n  loadAll: function () {\n    let tosave = DataManager.getValue(\"dbSavings\").items;\n\n    for (var i in tosave)\n      this.loaditem(i, tosave[i]);\n  },\n\n  loaditem: function (id, target) {\n    let path = target.path || target;\n    let onload = target.onload || null;\n    this.db.load(id).then((items) => {\n      if (items && items.repo) DataManager.set(path, items.repo)\n      if (onload) DataManager.runOn(onload[0], onload[1])\n    })\n  },\n\n  starter: {\n    loader: {\n      autostart: true,\n      get: (tb) => {\n        if (tb.cache.done) return 1;\n        tb.cache.done = true;\n        let v = tb.fetch({ tb: \"tb.persisitence\" });\n        v.tb.setup();\n\n        return 1;\n      }\n    }\n  }\n\n})\n\n\n\n\nDataManager.setCombined(\"ui.molds\", {\n  loader: {\n    get: function (tb) {\n      let molds = cu.tplObjParse.run(this.tpls);\n      return molds;\n    },\n    tpls: {\n      main: `\n          <div id='frame'>\n            <div id='easel'>{view}</div>\n            {overPanel.frame}\n            <div id='bar'>\n              <div id='menu'>{menu}</div>\n              <myinput id='order' auto_complete=\"off\" value={order.value} on_key_press={order.place} on_change={order.change}></myinput>\n              <div id='bumb' on_click='{bumb.action}'>{picture}</div>\n            </div>\n          </div>\n          <style>\n            * { box-sizing : border-box; max-height: 40000em;}\n            body , window, html {\n              color : {textColor};\n              height : 100%; width : 100%; background : {background} }\n            #frame { height : 100%; width : 100%;}\n            #frame { display : flex; flex-direction : column; }\n            #easel { flex : 1; overflow : auto; }\n            #overPanel { position : absolute;left : 0; top : 0; z-index : 200;}\n            \n            #bar   { position : relative; border-top: 1px solid #999; width : 100%; flex-basis : {dim.barHeight}px ; display : flex;flex-direction:row; }\n            #menu  { position: absolute;  bottom: 50px; }\n            #order {  padding-left : 10px; outline: none; flex : 1; border : 0px none transparent; width: 100%;}\n            #bumb  { flex-basis : {dim.barHeight}px; background : {color} } \n\n\n            @keyframes salut {\n              0% { border : 0px solid red;}\n              100% { border : 10px solid red;}\n            }\n\n\n            @keyframes reveal {\n              0% { opacity : 0.7; transform : translateY( -5px ); }\n              100% { opacity : 1; transform : translateY( 0px ); }\n            }\n\n\n\n            @keyframes enter {\n              0% { opacity : 0.5; transform : translateY( 5px ); }\n              100% { opacity : 1; transform : translateY( 0px ); }\n            }\n\n            #easel>div { animation: enter 0.5s ease; }\n            .reveal { animation: enter 0.5s ease; }\n\n            </style>\n          \n  `,\n\n      overPanel: \"<div id='overPanel'>{overPanel.panel}</div>\",\n      bubbleitem: `<div on_click={selectitem} targetid={targetid}>{label}</div>`,\n\n      menuitem: `<div>{label}</div>`\n\n    }\n  }\n})\n\nDataManager.setCombined(\"workingant\", {\n  data: {\n    input: { text: \"\" },\n    currentView: 'main',\n\n    selected: \"\"\n  }\n})\n\n\nDataManager.setCombined(\"antsFrame.ui\", {\n  loader: {\n    paths: { molds: \"ui.molds\", orderText: \"workingant.data\", node: \"antsFrame.prepare\" },\n    get: function (tb, v) {\n\n      tb.fetch(this.paths, v);\n\n      _.set(v.node, v.molds.main.mold.pins.order.concat([\"props\", \"value\"]), v.orderText.input)\n\n      return v.node;\n    }\n  }\n\n})\n\nDataManager.setCombined(\"antsView.formPanel\", {\n  nodes: {\n    loader: {\n      change: function (tb, v, args) {\n        tb.cache.args = args;\n\n        //tb.cache.nodes = \"loading\";\n\n        myUB.shop.go(\"makeTreeMap\", {\n          id: args.id,\n          items: DataManager.getWallet(\"repo.items\")\n        }, {\n            nodes: [\n              function (path, value) {\n                console.log(\"DONEDONE\", value)\n                tb.cache.nodes = value;\n                DataManager.markChangeOn(tb.path(), false, true)\n              }\n            ]\n          });\n\n\n      },\n      get: function (tb, v) {\n\n        tb.fetch({ items: \"repo.items\" }, v);\n\n        if (!tb.cache.loading) {\n          tb.cache.loading = true;\n\n          tb.cache.nodes = \"loading\";\n\n          myUB.shop.go(\"makeTreeMap\", {\n            id: \"ant_2\",\n          }, {\n              nodes: [\n                function (path, value) {\n                  console.log(\"DONEDONE\", value)\n                  tb.cache.nodes = value;\n                  DataManager.markChangeOn(tb.path(), false, true)\n                }\n              ]\n            });\n\n\n        }\n\n        let version = DataManager.getVersion(\"repo.items\");\n        if (tb.cache.args && tb.cache.old&& tb.cache.old.dependsOn[\"repo.items\"].version != version) {\n          //console.log( tb.cache.dependsOn[\"repo.items\"].version ,  version)\n          this.change(tb, v, tb.cache.args)\n        }\n\n\n        return tb.cache.nodes;\n      },\n      updateVersionsMap: true,\n    }\n  }\n})\n\nDataManager.setCombined(\"workingant.viewState\", {\n  path: \"antsView.formPanel.nodes\"\n})\n\nDataManager.setCombined(\"antsFrame.prepare\", {\n  loader: {\n    paths: { molds: \"ui.molds\", data: \"bubbles.data\", repo: \"repo\", viewState: \"workingant.viewState\" },\n    get: function (tb, v) {\n      console.log(\"panel\");\n\n      tb.fetch(this.paths, v);\n\n      tb.fetch({ view: v.viewState.path }, v)\n\n\n      console.log(v.view);\n\n      let store = cu.store.get(tb, hapi,\n        { change: { changeOrder: \"workingant.data.input\" }, run: { bumbAction: \"showhud\", placeOrder: \"placeorder\" } });\n\n      v.dim = {\n        window: {\n          height: \"400\",\n          width: \"200\",\n        },\n        barHeight: \"40\"\n      }\n\n      v.data = {\n        label: \"main\",\n        bubbleList: \"TestList\",\n        order: {\n          change: store.changeOrder,\n          place: store.placeOrder\n        },\n        bumb: {\n          action: store.bumbAction\n        },\n        dim: v.dim,\n\n        view: v.view,\n\n        color: \"#999\",\n        background: \"#eee\",\n        textColor: \"#222\",\n\n        menu: []\n      }\n\n      for (var i in v.viewState.overPanel) {\n        if (v.viewState.overPanel[i]) {\n          v.data.overPanel = tb.fetch({ panel: v.viewState.overPanel[i] })\n          v.data.overPanel.frame = cu.reactAssembler.run(v.molds.overPanel, v.data)\n        }\n      }\n\n      v.node = cu.reactAssembler.run(v.molds.main, v.data)\n      return v.node;\n    },\n    autostart: true\n  }\n})\n\n\n\nDataManager.setCombined(\"test\", {\n  loader: {\n    get: function () {\n      //myUB.mapview.loadMap(\"ant1\")\n      myUB.bridgeLoader.loadBridge();\n    },\n    autostart: true\n  }\n})\n\n///2\n\n\n//DataManager = window._DataManager.setup();\nDataManager.historyManager.recording = false;\nDataManager.runToStart();\n//------------------\n\n\n\nclass Frame extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {}\n  }\n\n  path = \"antsFrame.ui\"\n\n  componentDidMount() {\n    DataManager.setTrigger(this.path, \"asd\", {\n      run: () => {\n        this.setState({ \"version\": new Date().getTime() })\n      }\n    })\n  }\n\n  componentDidUpdate() {\n  }\n\n  render() {\n    let components = DataManager.getValue(this.path);\n    let node = cu.reactUtils.makeComponent(components || []) || \"empty\";\n    return node\n  }\n}\n\n\n\nclass FlatAnt extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      value: { scode: \"salut\" }\n    }\n  }\n\n  _style() {\n    return `\n      html, window, body{ width : 100%; height : 100%; overflow : auto; padding: 0px; margin:0px;}\n      #root, .main { width : 100%; height : 100%;}\n      \n\n.node {\n  stroke: #fff;\n  stroke-width: 1.5px;\n}\n\n.link {\n  fill: none;\n  stroke: blue;\n  stroke-width: 1.5px;\n  opacity: 0.4;\n  marker-end: url(#end-arrow);\n}\n\n.adv_entry {     display: block;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;}\n.adv_entry>.time {     background: #a1a1a1;\n  display: inline-block;\n  border-radius: 5px;\n  padding: 4px 2px;\n  font-size: 0.4em;\n  line-height: 1em;\n }\n.adv_map>.content { }\n.adv_map { border : 1px solid #999; margin : 10px; padding : 10px;}\n    `\n  }\n\n  render() {\n    let style = this._style();\n    let components = [\n      //<TreeDiagram />,\n      <Frame key=\"1\"></Frame>\n    ]\n    return [\n\n      <style key='style'>{style}</style>,\n      components]\n      ;\n  }\n}\n\nexport default FlatAnt;\n","import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport CodeMirrorEditor from \"./components/CodeMirrorEditor\";\nimport _ from \"lodash\";\nimport $ from \"jquery\";\nimport go from \"gojs\";\nimport \"./libs/dataManager.js\";\n\nimport FlatAnt from \"./FlatAnt5\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let content = <FlatAnt />\n    return content;\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  //if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) \n  if ( true ) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      console.error( publicUrl.origin )\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register();\n","var historyManager = {\n  setup: function setup(info) {\n    var item = Object.create(this);\n    item.wallet = {\n      currentStack: {\n        info: [{\n          type: \"startedWith\",\n          info: info\n        }]\n      },\n      stacks: []\n    };\n    item.recording = true;\n    item.wallet.stacks.push(item.wallet.currentStack);\n    return item;\n  },\n  startStack: function startStack(info) {\n    if (!this.recording) return;\n    var stack = {\n      info: [],\n      prevStack: this.wallet.currentStack,\n      index: this.wallet.stacks.length,\n      start: info\n    };\n    this.addInfo({\n      type: \"subStack\",\n      stack: stack\n    }, true);\n    this.wallet.stacks.push(stack);\n    this.wallet.currentStack = stack;\n    if (info) this.addInfo(info);\n  },\n  addInfo: function addInfo(info, skipClone) {\n    if (!this.recording) return;\n    if (!skipClone) info = _.cloneDeep(info);\n    this.wallet.currentStack.info.push(info);\n  },\n  endStack: function endStack(info) {\n    if (!this.recording) return;\n    if (info) this.addInfo(info);\n    this.wallet.currentStack = this.wallet.currentStack.prevStack;\n  }\n};\nvar _DataManager = {\n  setup: function setup() {\n    var item = Object.create(this);\n    item.state = {\n      ctx: {},\n      gettingValue: {},\n      wallet: {},\n      meta: {},\n      cache: {},\n      version: {},\n      loadersCache: {},\n      triggers: {},\n      currentVersion: 1,\n      dependencies: {},\n      nextUID: 1,\n      agenda: {\n        names: {},\n        tasks: []\n      },\n      pins: {},\n      toStart: [],\n      flags: {}\n    };\n    item.historyManager = historyManager.setup(this);\n    return item;\n  },\n  state: {\n    gettingValue: {},\n    wallet: {},\n    meta: {},\n    cache: {},\n    version: {},\n    loadersCache: {},\n    triggers: {},\n    currentVersion: 1,\n    dependencies: {},\n    nextUID: 1,\n    agenda: {\n      names: {},\n      tasks: []\n    },\n    pins: {},\n    toStart: [],\n    flags: {}\n  },\n  setCtx: function setCtx(basePath, ctxPath, value, names) {\n    var ctx = _.get(this.state.ctx, [basePath, \"ctx\"].join(\".\"));\n\n    if (!ctx) _.set(this.state.ctx, [basePath, \"ctx\"].join(\".\"), ctx = {\n      names: []\n    });\n\n    _.set(ctx, ctxPath, value);\n\n    ctx.names.push({\n      names: names,\n      path: ctxPath\n    });\n  },\n  getCtx: function getCtx(basePath, name) {\n    var ctx = _.get(this.state.ctx, [basePath, \"ctx\"].join(\".\"));\n\n    ;\n    if (!ctx) return null;\n    var ctxPath;\n\n    for (var i in ctx.names) {\n      if (ctx.names[i].names.indexOf(name) != -1) {\n        ctxPath = ctx.names[i].path;\n        break;\n      }\n    }\n\n    if (!ctxPath) return null;\n\n    var target = _.get(ctx, ctxPath);\n\n    return target;\n  },\n  runOn: function runOn(basePath, name, args) {\n    var target = this.getCtx(basePath, name);\n    if (!target) return null;\n    return target[name](args);\n  },\n  runFn: function runFn(path, args) {\n    var route = path.split(\".\");\n    var fnName = route.pop();\n    var targetPath = route.join(\".\");\n    var target = this.getValue(targetPath);\n    if (!target[fnName]) return undefined;\n\n    if (_.isFunction(target[fnName])) {\n      return target[fnName](args, path, this);\n    } else if (_.isFunction(target[fnName].run)) {\n      return target[fnName].run(args, path, this);\n    }\n  },\n  getInfluenced: function getInfluenced(path) {\n    var influenced = [];\n\n    var dep = _.get(this.state.dependencies, path + \".DEP\");\n\n    if (!dep) return [];\n\n    for (var i in dep) {\n      influenced.push(i);\n      influenced = influenced.concat(this.getInfluenced(i));\n    }\n\n    return influenced;\n  },\n  getValue: function getValue(path, skipPartialValueCheck) {\n    var route = path.split(\".\");\n    var value = this.checkCache(path);\n    if (value) return value;\n    if (!skipPartialValueCheck) for (var i = 0; i < route.length; i++) {\n      var partialPath = route.slice(0, i).join(\".\");\n\n      if (this.state.gettingValue[partialPath]) {\n        var partialResult = this.state.gettingValue[partialPath].partialResult;\n        var partialSlot = route.slice(i);\n\n        var partialValue = _.get(partialResult, partialSlot);\n\n        if (partialValue !== undefined) return partialValue;\n      }\n    }\n    this.state.gettingValue[path] = true;\n    var list = this.makeList(path);\n    value = this.listToValue(list, path);\n    delete this.state.gettingValue[path];\n\n    if (value !== undefined) {\n      // let shouldUpdate = (  list.length == 1 && list[0].src == \"wallet\" )\n      this.setCache(path, value); //, shouldUpdate);\n      //this.diffCache( oldCache, path );\n    }\n\n    return value;\n  },\n  setCache: function setCache(path, value, shouldUpdate) {\n    this.state.cache[path] = {\n      value: value,\n      shouldUpdate: shouldUpdate || false,\n      version: this.state.currentVersion\n    };\n  },\n  checkCache: function checkCache(path, ignoreUpdates) {\n    if (!this.state.cache[path]) return null;\n    if (ignoreUpdates) return this.state.cache[path].value;\n    if (this.state.cache[path].shouldUpdate) return null;\n    return this.state.cache[path].value;\n  },\n  prepareCache: function prepareCache(path) {\n    var cache = this.state.loadersCache[path];\n\n    if (!cache) {\n      cache = this.state.loadersCache[path] = {\n        old: {},\n        contains: {},\n        dependsOn: {}\n      };\n    }\n\n    var old = {\n      contains: cache.contains || {},\n      dependsOn: cache.dependsOn || {}\n    };\n    cache.old = old;\n    delete cache.contains;\n    delete cache.dependsOn;\n    return old;\n  },\n  diffCache: function diffCache(oldCache, path) {\n    if (!this.state.loadersCache[path]) this.state.loadersCache[path] = {};\n    var cache = this.state.loadersCache[path] || {};\n    var dependencies = this.state.dependencies;\n\n    var addDependency = function addDependency(a, b) {\n      var dep = _.get(dependencies, a + \".DEP\");\n\n      if (!dep) _.set(dependencies, a + \".DEP\", dep = {});\n      dep[b] = true; //_.set( dependencies, a + \".DEP\",dep );\n    };\n\n    var remDependency = function remDependency(a, b) {\n      var dep = _.get(dependencies, a + \".DEP\");\n\n      if (!dep) return;\n      delete dep[b];\n    };\n\n    var check = function check(newC, oldC) {\n      for (var i in newC) {\n        if (!oldC || !oldC[i]) addDependency(i, path);\n      }\n\n      for (var i in oldC) {\n        if (!newC || !newC[i]) remDependency(i, path);\n      }\n    };\n\n    check(cache.contains, oldCache.contains);\n    check(cache.dependsOn, oldCache.dependsOn);\n  },\n  updateVersionsMap: function updateVersionsMap(path) {\n    var cache = this.state.loadersCache[path] || {};\n    var depOn = cache.dependsOn;\n\n    for (var i in depOn) {\n      var currentVersion = this.getVersion(i);\n      depOn[i].version = currentVersion;\n      console.log(\"setting veriosn,\", currentVersion, depOn[i].version);\n    }\n  },\n  makeList: function makeList(path) {\n    var list = [];\n    var route = path.substr ? path.split(\".\") : path;\n\n    var walletValue = _.get(this.state.wallet, path);\n\n    if (walletValue !== undefined) {\n      if (!_.isObjectLike(walletValue)) {\n        list.push({\n          src: \"wallet\",\n          value: walletValue,\n          path: [],\n          srcPath: path,\n          version: 1\n        });\n        return list;\n      }\n\n      walletValue = _.cloneDeep(walletValue);\n      list.push({\n        src: \"wallet\",\n        value: walletValue,\n        path: [],\n        srcPath: path,\n        version: 1\n      });\n    }\n\n    var meta = this.state.meta;\n\n    for (var i = 0; i < route.length; i++) {\n      if (!meta) break;\n\n      if (meta.loader) {\n        var item = {\n          src: \"root\",\n          loader: meta.loader,\n          path: [],\n          srcPath: route.slice(0, i),\n          select: route.slice(i)\n        };\n        list.push(item);\n      }\n\n      meta = meta[route[i]];\n    }\n\n    var rootPath = route;\n\n    var iterate = function iterate(obj, route, list) {\n      if (!obj) return;\n\n      if (obj.loader) {\n        var _item = {\n          src: \"sub\",\n          loader: obj.loader,\n          path: route,\n          srcPath: rootPath.concat(route)\n        };\n        list.push(_item);\n      }\n\n      for (var _i in obj) {\n        if (_i == \"loader\") continue;\n        iterate(obj[_i], route.concat(_i), list);\n      }\n    };\n\n    iterate(meta, [], list);\n    return list;\n  },\n  silentSet: function silentSet(path, value, skipPathAffected) {\n    this.historyManager.addInfo({\n      type: \"silentSet\",\n      path: path,\n      value: value\n    });\n\n    _.set(this.state.wallet, path, value);\n\n    if (this.state.cache[path]) this.state.cache[path].shouldUpdate = true;\n    if (!skipPathAffected) this.getAffectedPaths(path);\n  },\n  listToValue: function listToValue(list, path) {\n    if (list.length == 1 && list[0].value) return list[0].value;\n    var result = {};\n    this.state.gettingValue[path] = {\n      partialResult: result\n    };\n    var postponedSteps = list;\n    var hasSteps = true;\n    var snoozeCount = 0;\n\n    while (hasSteps) {\n      snoozeCount++;\n\n      if (snoozeCount > 5) {\n        //console.log( \"postponed more than 5 times\", path, result, _.cloneDeep( this.state.gettingValue ) );\n        this.state.cache[path].shouldUpdate = true;\n        return result;\n      }\n\n      list = postponedSteps;\n      postponedSteps = [];\n      hasSteps = false;\n\n      for (var i = 0; i < list.length; i++) {\n        var step = list[i];\n        var value = void 0;\n\n        if (step.value) {\n          value = step.value;\n        } else if (step.loader) {\n          try {\n            value = this.getFromLoader(step, result, path);\n          } catch (e) {\n            if (e == \"postpone\") {\n              this.state.cache[path].shouldUpdate = true;\n              postponedSteps.push(step);\n              hasSteps = true;\n            } else {\n              console.error(e);\n            }\n\n            continue;\n          }\n        }\n\n        if (step.select) value = _.get(value, step.select);\n\n        if (step.path.length) {\n          _.set(result, step.path, value);\n        } else {\n          if (Object.values(result).length == 0) {\n            result = value;\n          } else //console.log( \"merging\" , _.cloneDeep( result ), value, result);\n            _.merge(result, value);\n        }\n      }\n    }\n\n    return result;\n  },\n  loadersCache: {},\n  addLog: function addLog(lhs, rel, rhs, value) {\n    if (!this.state.loadersCache[lhs]) this.state.loadersCache[lhs] = {\n      version: this.state.currentVersion,\n      cachedValue: {}\n    };\n    var xcache = this.state.loadersCache[lhs];\n    if (!xcache[rel]) xcache[rel] = {};\n    xcache[rel][rhs] = value || true;\n  },\n  getFromLoader: function getFromLoader(step, result, requester, force) {\n    var _this = this;\n\n    var srcPath = step.srcPath.join(\".\");\n    var value;\n\n    try {\n      var logger = {\n        add: function add(path, name) {\n          _this.addLog(srcPath, \"dependsOn\", path, {\n            version: true,\n            name: name,\n            path: path,\n            srcPath: srcPath\n          });\n        }\n      };\n      var loader = step.loader;\n\n      if (loader.prism) {\n        if (loader.loadedPrism) loader = loader.loadedPrism;else {\n          var loadedPrism = this.getFromDispatch(loader.prism);\n          loader.loadedPrism = loadedPrism;\n          loader = loadedPrism;\n        }\n      }\n\n      if (loader.load) {\n        if (this.state.cache[srcPath]) {\n          return {};\n        }\n\n        value = loader.load(result, this, logger, step.loader, step);\n\n        _.set(this.state.wallet, srcPath, value);\n\n        this.state.cache[srcPath] = {\n          loader: true,\n          value: {}\n        };\n        return value;\n      }\n\n      if (!force) {\n        var _value = this.checkCache(srcPath);\n\n        if (_value) return _value;\n      }\n\n      if (step.src == \"sub\") this.addLog(requester, \"contains\", srcPath);\n      var oldCache = this.prepareCache(srcPath);\n\n      if (loader.get) {\n        try {\n          var tb = TB.init(result, this, logger, step.loader, step, this.state.loadersCache[srcPath]);\n          if (DataManager.newAPI) value = loader.get(tb, tb.v);else value = loader.get(tb, this, logger, step.loader, step, this.state.loadersCache[srcPath]);\n        } catch (e) {\n          if (e && e.type == \"return\") {\n            value = e.value;\n          } else {\n            throw e;\n          }\n        }\n      }\n\n      if (value === \"forceCache\") {\n        return this.checkCache(srcPath, true);\n      } else if (value !== undefined) {\n        this.setCache(srcPath, value);\n        this.diffCache(oldCache, srcPath);\n        if (loader.updateVersionsMap) this.updateVersionsMap(srcPath);\n\n        _.set(this.state.version, srcPath + \".version\", this.state.currentVersion);\n      }\n    } catch (e) {\n      console.error(e);\n    }\n\n    if (loader && loader.skipCache) this.state.cache[srcPath].shouldUpdate = true;\n    return value;\n  },\n  runOnLoader: function runOnLoader(path, name, args) {\n    var srcPath = path;\n\n    var loader = _.get(this.state.meta, path);\n\n    if (!loader) return;\n    loader = loader.loader;\n    if (!loader[name]) return;\n    var tb = TB.init({}, this, {}, loader, {\n      srcPath: srcPath\n    }, this.state.loadersCache[srcPath]);\n    loader[name](tb, tb.v, args);\n    return null;\n  },\n  runUtils: function runUtils(path, args) {\n    var fn = this.getValue(path);\n    if (fn && fn.run) return fn.run.apply(fn, args);\n  },\n  getWallet: function getWallet(path) {\n    return _.get(this.state.wallet, path);\n  },\n  mergeValue: function mergeValue(path, value) {\n    var _this2 = this;\n\n    this.historyManager.addInfo({\n      type: \"mergeValue\",\n      path: path,\n      value: value\n    });\n    var oldValue = path ? _.get(this.state.wallet, path) : this.state.wallet; //this.getValue( path );\n\n    if (!oldValue) {\n      oldValue = {};\n\n      _.set(this.state.wallet, path, oldValue);\n    }\n\n    var changedPaths = [];\n    this.state.currentVersion++;\n    var route = _.isString(path) ? path.split(\".\") : path || [];\n    if (route.length == 1 && route[0] == \"\") route = [];\n    var fn = {\n      addPath: function addPath(relPath) {\n        var fullPath = route.concat(relPath);\n        changedPaths.push(fullPath);\n\n        _.set(_this2.state.version, fullPath.join(\".\") + \".version\", _this2.state.currentVersion);\n      }\n    };\n    this.pauseAll();\n\n    if (_.isObjectLike(value)) {\n      this.setObObj(oldValue, value, fn, []);\n    } else {\n      console.log(\"it's not object\");\n    }\n\n    for (var i in changedPaths) {\n      this.updateVersionForAll(changedPaths[i]);\n      this.getAffectedPaths(changedPaths[i].join(\".\"));\n    }\n\n    this.req_triggers();\n  },\n  pauseAll: function pauseAll() {\n    if (this.state.runningReqTriggers_timer) {\n      this.clearInterval(this.state.runningReqTriggers_timer);\n      delete this.state.runningReqTriggers_timer;\n    }\n\n    if (this.state.runningAgendaTriggers_timer) {\n      this.clearInterval(this.state.runningAgendaTriggers_timer);\n      delete this.state.runningAgendaTriggers_timer;\n    }\n  },\n  setInterval: function setInterval(callback, delay, name) {\n    var stop = false;\n\n    var fn = function fn() {\n      if (stop) return; //console.log( \"interval\", name );\n\n      callback();\n      window.requestAnimationFrame(fn);\n    };\n\n    window.requestAnimationFrame(fn);\n    return function () {\n      stop = true;\n    };\n  },\n  clearInterval: function clearInterval(stopFn) {\n    if (!stopFn) return;\n    return stopFn();\n  },\n  req_triggers: function req_triggers() {\n    var _this3 = this;\n\n    if (this.state.runningReqTriggers_timer) return; //if ( Object.keys( this.affected ).length == 0 ) return;\n\n    this.state.runningReqTriggers_timer = this.setInterval(function () {\n      //console.log( \"affected::\", _.cloneDeep(this.affected ) );\n      _this3.asyncTriggers();\n    }, 0, \"triggers\");\n  },\n  asyncTriggers: function asyncTriggers() {\n    var keys = Object.keys(this.affected);\n\n    if (keys.length == 0) {\n      this.clearInterval(this.state.runningReqTriggers_timer); //console.log( \"affected_checked\", this.affected_checked );\n\n      this.affected_checked = {};\n      delete this.state.runningReqTriggers_timer;\n      return;\n    } //console.log( \"checking\", keys[0 ] );\n\n\n    this.affected_checked[keys[0]] = this.affected[keys[0]];\n    delete this.affected[keys[0]];\n    this.lazy_checkTriggers(keys[0]);\n  },\n  req_Agenda: function req_Agenda() {\n    var _this4 = this;\n\n    if (this.state.runningAgendaTriggers_timer) return;\n    if (this.state.agenda.tasks.length == 0) return;\n    this.state.runningAgendaTriggers_timer = this.setInterval(function () {\n      _this4.asyncTriggersAgenda();\n    }, 0, \"agenda\");\n  },\n  asyncTriggersAgenda: function asyncTriggersAgenda() {\n    if (this.state.agenda.tasks.length == 0) {\n      this.clearInterval(this.state.runningAgendaTriggers_timer);\n      delete this.state.runningAgendaTriggers_timer;\n      return;\n    }\n\n    var trigger = this.state.agenda.tasks.shift();\n    if (!trigger) return console.error(trigger); //console.log( \"checking\", keys[0 ] );\n\n    delete this.state.agenda.names[trigger.id];\n    this.runTrigger(trigger, trigger.target, trigger.listener); //this.lazy_checkTriggers( keys[0] );\n  },\n  lazy_checkTriggers: function lazy_checkTriggers(path) {\n    if (this.state.triggers[path]) {\n      if (this.state.agenda.names[path]) return;\n      var triggers = this.state.triggers[path];\n\n      for (var i in triggers) {\n        var trigger = triggers[i];\n        var id = trigger.id || path + \"___\" + i;\n        if (this.state.agenda.names[i]) continue;\n        if (!trigger.path) trigger.target = path;\n        if (!trigger.token) trigger.listener = i;\n        if (!trigger.id) trigger.id = id;\n        this.state.agenda.names[id] = true;\n        this.state.agenda.tasks.push(trigger);\n      }\n\n      this.sortAgenda();\n      this.req_Agenda();\n    }\n  },\n  sortAgenda: function sortAgenda() {\n    this.state.agenda.tasks.sort(function (taskA, taskB) {\n      if (!taskB.salience) return 1;\n      if (!taskA.salience) return -1;\n      return taskA.salience - taskB.salience;\n    });\n  },\n  setObObj: function setObObj(target, source, fn, path) {\n    for (var i in source) {\n      if (source[i] === undefined) continue;else if (_.isObjectLike(source[i])) {\n        if (!target[i]) target[i] = {};\n        this.setObObj(target[i], source[i], fn, path.concat(i));\n      } else {\n        if (target[i] != source[i]) {\n          target[i] = source[i];\n          fn.addPath(path.concat(i));\n        }\n      }\n    }\n  },\n  appendToArray: function appendToArray(path, value, setVersion) {\n    var target = _.get(this.state.wallet, path);\n\n    if (!target) {\n      value = [value];\n      return this.set(path, value, false, setVersion);\n    }\n\n    var index = target.length;\n    var route = _.isArray(path) ? path : path.split(\".\");\n    route.push(index);\n    return this.set(route, value, false, setVersion);\n  },\n  setByLoader: function setByLoader(path, value) {\n    if (_.isArray(path)) path = path.join(\".\");\n\n    var prism = _.get(this.state.meta, path);\n\n    if (!prism || !prism.loader || !prism.loader.set) return false;\n    var tb = TB.init({}, this, {}, prism.loader, {}, this.state.loadersCache[path]);\n    value = prism.loader.set(tb, value);\n    return true;\n  },\n  set: function set(path, value, isLoaders, setVersion) {\n    this.historyManager.startStack({\n      type: \"set\",\n      path: path,\n      value: value\n    });\n\n    try {\n      if (this.setByLoader(path, value)) {\n        return;\n      }\n\n      var target = isLoaders ? this.state.meta : this.state.wallet;\n\n      _.set(target, path, value); //if ( setVersion ) {\n\n\n      this.state.currentVersion++; //}\n\n      this.updateVersionForAll(path.split(\".\"));\n\n      _.set(this.state.version, path + \".version\", this.state.currentVersion);\n\n      var strPath = _.isArray(path) ? path.join(\".\") : path;\n      this.getAffectedPaths(strPath);\n      this.req_triggers();\n    } catch (e) {\n      console.error(e);\n    } finally {\n      this.historyManager.endStack();\n    }\n  },\n  affected: {},\n  affected_checked: {},\n  affected_version: 1,\n  markChangeOn: function markChangeOn(path, skipTrigger, incAffected, incVersion) {\n    if (incAffected) this.affected_version++;\n    if (!skipTrigger) this.pauseAll();\n\n    if (incVersion) {\n      this.state.currentVersion++;\n      this.updateVersion(path);\n    }\n\n    this.getAffectedPaths(path); //console.log(Object.keys(this.affected), Object.keys(this.affected_checked));\n\n    if (!skipTrigger) this.req_triggers();\n  },\n  getAffectedPaths: function getAffectedPaths(path) {\n    if (this.state.cache[path]) {\n      this.state.cache[path].shouldUpdate = true;\n    }\n\n    if (this.affected[path] && this.affected[path].affected_version == this.affected_version) {\n      return;\n    }\n\n    this.affected[path] = {\n      affected_version: this.affected_version,\n      version: this.state.currentVersion,\n      state: 1\n    };\n    var route = path.split(\".\");\n    var strPath = route[0];\n    this.getAffectedPaths(route[0]);\n\n    for (var i = 1; i < route.length - 1; i++) {\n      strPath += \".\" + route[i];\n      this.getAffectedPaths(strPath);\n    }\n\n    var influenced = this.getInfluenced(path);\n\n    for (var i in influenced) {\n      this.getAffectedPaths(influenced[i]);\n    }\n  },\n  markChangedPaths: function markChangedPaths(path) {\n    //let influenced = this.getInfluenced( path );\n    var route = path.split(\".\");\n    var strPath = route[0];\n\n    for (var i = 1; i < route.length; i++) {\n      strPath += \".\" + route[i];\n      if (this.state.cache[strPath]) this.state.cache[strPath].shouldUpdate = true;\n      this.checkTriggers(strPath);\n      this.setUpdateFlag(strPath);\n    }\n  },\n  changedPaths: {},\n  setUpdateFlag: function setUpdateFlag(path) {\n    var influenced = this.getInfluenced(path);\n    var cache = this.state.cache;\n\n    for (var i in influenced) {\n      if (cache[influenced[i]]) {\n        cache[influenced[i]].shouldUpdate = true;\n      }\n\n      this.setUpdateFlag(cache[influenced[i]]);\n      this.checkTriggers(influenced[i]);\n    }\n  },\n  checkTriggers: function checkTriggers(path) {\n    if (this.state.triggers[path]) {\n      this.runTriggers(this.state.triggers[path], path);\n    }\n  },\n  runTriggers: function runTriggers(collection, path) {\n    for (var i in collection) {\n      this.runTrigger(collection[i], path, i);\n    }\n  },\n  runTrigger: function runTrigger(trigger, path, token) {\n    if (_.isFunction(trigger.run)) {\n      return trigger.run(trigger, path, token);\n    }\n\n    var fn = _.get(this.state.wallet, trigger.run);\n\n    if (_.isFunction(fn)) return fn(trigger, path, token);else if (fn.run) return fn.run(trigger, path, token);\n  },\n  run: function run(path, value) {},\n  fetchValues: function fetchValues(target, map, wallet, master, logger, onlyPaths) {\n    for (var i in map) {\n      if (i == \"type\") continue;\n      var value = map[i];\n\n      if (_.isString(value)) {\n        if (value.charAt(0) == \"$\") {\n          var _path = value.substr(2);\n\n          if (logger) logger.add(_path, i);\n          value = master.getValue(_path);\n        } else if (onlyPaths) {\n          var _path2 = value;\n          if (logger) logger.add(_path2, i);\n          value = master.getValue(_path2);\n        }\n      } else if (value.KEY == \"fullPath\") {\n        path = value.path.join(\".\");\n        if (logger) logger.add(path, i);\n        value = master.getValue(path);\n      }\n\n      if (value === undefined) throw \"postpone\";\n      var slot = i;\n      target[slot] = value;\n      if (!target.src) target.src = {};\n      target.src[slot] = {\n        key: map[i],\n        slot: i\n      };\n    }\n\n    return target;\n  },\n  setCombined: function setCombined(path, value) {\n    this.historyManager.startStack({\n      type: \"setCombined\",\n      path: path,\n      value: value\n    });\n    var payload = {\n      loaders: {},\n      loadersPaths: [],\n      basePath: path.split(\".\"),\n      value: value,\n      pins: [],\n      afterOp: []\n    };\n    var isEmpty = this.iterate(value, [], payload);\n\n    if (payload.pins.length) {\n      var currentPins = {};\n\n      for (var i in payload.pins) {\n        var _pin = payload.pins[i];\n\n        var name = _pin.value || _pin.path.slice(-1)[0];\n\n        currentPins[name] = {\n          path: _pin.path,\n          fullPath: payload.basePath.concat(_pin.path)\n        };\n      }\n\n      var pins = _.get(this.state.pins, path + \".pins\");\n\n      if (!pins) _.set(this.state.pins, path + \".pins\", pins = {});\n\n      _.merge(pins, currentPins);\n    }\n\n    if (payload.afterOp.length) {\n      for (var i in payload.afterOp) {\n        var op = payload.afterOp[i];\n\n        if (op.type == \"gluePin\") {\n          var pin = pins[op.pin];\n          var pinKey = {\n            KEY: \"fullPath\",\n            path: pin.fullPath\n          };\n\n          if (op.isLoader) {\n            _.set(payload.loaders, op.dest, pinKey);\n          } else {\n            _.set(value, op.dest, pinKey);\n          }\n        } else if (op.type == \"flags\") {\n          if (op.flags.hasVersion) {\n            this.updateVersion(op.path);\n          }\n        }\n      }\n    }\n\n    if (!isEmpty) this.set(path, value, false, true);\n\n    if (payload.hasLoaders) {\n      //console.log( \"loaders\", payload.loadersPaths );\n      this.set(path, payload.loaders, true, true);\n\n      for (var i in payload.loadersPaths) {\n        var lPath = payload.loadersPaths[i];\n        this.setCache(lPath.join(\".\"), {}, true);\n\n        var loader = _.get(this.state.meta, lPath);\n\n        if (loader.loader && loader.loader.autostart) {\n          this.state.toStart.push({\n            path: lPath.join(\".\")\n          }); //this.getValue(lPath.join(\".\"));\n        } //console.log( \"loader\", loader );\n\n      }\n    }\n\n    this.historyManager.endStack();\n  },\n  runToStart: function runToStart() {\n    var toStart = this.state.toStart;\n\n    while (toStart.length) {\n      var item = toStart.shift();\n      this.getValue(item.path);\n    }\n  },\n  buildModel: function buildModel(input, path) {\n    var modelName = input.MODEL;\n    input = _.cloneDeep(input);\n    var tokens;\n\n    if (modelName.indexOf(\":\") != -1) {\n      tokens = modelName.split(\":\");\n      modelName = tokens.shift();\n      input.tokens = tokens;\n    }\n\n    var mold = this.getValue(modelName);\n\n    if (mold.handleTokens && tokens) {\n      mold.handleTokens(input, tokens, path);\n    }\n\n    var obj = _.cloneDeep(mold.modelObj);\n\n    if (mold.modelSpec) {\n      var spec = mold.modelSpec;\n\n      if (spec.ops) {\n        for (var i in spec.ops) {\n          var op = spec.ops[i];\n\n          if (op.type == \"replaceValue\") {\n            var value = _.get(input, op.source);\n\n            if (!op.dest) obj = value;else _.set(obj, op.dest, value);\n          } else if (op.type == \"eval\") {\n            var _value2 = op.fn(input, op);\n\n            console.log(_value2);\n\n            _.set(input, op.dest, _value2);\n          }\n        }\n      }\n\n      if (spec.isLoader) {\n        obj = {\n          loader: obj\n        };\n      }\n    }\n\n    if (input.pin !== undefined) obj.pin = input.pin;\n    this.historyManager.addInfo({\n      type: \"buildModel\",\n      path: path,\n      input: input,\n      obj: obj\n    });\n    return obj;\n  },\n  iterate: function iterate(obj, path, payload) {\n    while (obj && obj.MODEL) {\n      var newObj = this.buildModel(obj, payload.basePath.concat(path));\n\n      for (var i in obj) {\n        delete obj[i];\n      }\n\n      _.merge(obj, newObj); //really ? it was easier that way then to put inside the loop and on setCombined ? really ? \n      //yea, keeping the traditional approach\n\n    }\n\n    var isEmpty = true;\n\n    for (var i in obj) {\n      var subPath = path.concat(i);\n\n      if (i == \"pin\") {\n        payload.pins.push({\n          subPath: subPath,\n          path: path,\n          value: obj[i]\n        });\n        delete obj[i];\n      } else if (i == \"loader\") {\n        this.setLoader(payload.loaders, path, obj[i], payload.basePath, payload);\n        payload.loadersPaths.push(payload.basePath.concat(path));\n        delete obj[i];\n        payload.hasLoaders = true;\n      } else if (i == \"flags\") {\n        payload.afterOp.push({\n          type: \"flags\",\n          path: payload.basePath.concat(path).join(\".\"),\n          relPath: path,\n          flags: obj.flags\n        });\n      } else if (_.isString(obj[i]) && obj[i].charAt(0) == \"%\") {\n        obj[i] = this.getStaticValue(obj[i], i, obj, subPath, payload);\n        isEmpty = false;\n      } else if (_.isObjectLike(obj[i])) {\n        var subIsEmpty = this.iterate(obj[i], subPath, payload);\n\n        if (subIsEmpty) {//delete obj[ i ];\n        } else {\n          isEmpty = false;\n        }\n\n        isEmpty = false;\n      } else {\n        isEmpty = false;\n      }\n    }\n\n    return isEmpty;\n  },\n  getStaticValue: function getStaticValue(slot, index, obj, path, payload) {\n    if (slot == \"%PATH\") return payload.basePath.concat(path);else {\n      payload.afterOp.push({\n        type: \"gluePin\",\n        dest: path,\n        pin: slot.substring(1)\n      });\n      return {\n        KEY: \"relative path\"\n      };\n    }\n  },\n  getUID: function getUID() {\n    return this.state.nextUID++;\n  },\n  setTrigger: function setTrigger(target, listener, trigger) {\n    if (!this.state.triggers[target]) this.state.triggers[target] = {};\n    this.state.triggers[target][listener] = trigger;\n  },\n  getTrigger: function getTrigger(target, listener) {\n    if (!this.state.triggers[target]) return null;\n    return this.state.triggers[target][listener];\n  },\n  remTrigger: function remTrigger(target, listener) {\n    if (!this.state.triggers[target]) return;\n    delete this.state.triggers[target][listener];\n  },\n  setLoader: function setLoader(loaders, path, value, basePath, payload) {\n    if (_.isString(value)) {\n      var listenerPath = basePath.concat(path).join(\".\");\n      var oldTrigger = this.getTrigger(value, listenerPath);\n      if (oldTrigger && oldTrigger.path) this.remTrigger(oldTrigger.path, listenerPath);\n      this.setTrigger(value, listenerPath, {\n        run: \"base.updateLoader\",\n        loaderPath: value,\n        destination: listenerPath\n      });\n      value = this.getValue(value);\n    }\n\n    this.prepareLoader(value, basePath, path.concat(\"loader\"), payload);\n\n    _.set(loaders, path.concat(\"loader\"), value); //this.markChangeOn( path, true );\n\n  },\n  prepareLoader: function prepareLoader(loader, basePath, loaderPath, payload) {\n    this.deepTransformObj(loader, [], function (obj, slot, path) {\n      if (_.isString(obj) && obj.charAt(0) == \"%\") {\n        if (obj == \"%PATH\") {\n          return payload.basePath.concat(loaderPath);\n        }\n\n        payload.afterOp.push({\n          type: \"gluePin\",\n          dest: loaderPath.concat(path),\n          pin: obj.substring(1),\n          isLoader: true\n        });\n        return {\n          x: 12\n        };\n      }\n    });\n  },\n  deepTransformObj: function deepTransformObj(obj, path, test) {\n    if (!obj || !_.isObject(obj)) return;\n\n    for (var i in obj) {\n      var value = test(obj[i], i, path.concat([i]));\n\n      if (value !== undefined) {\n        obj[i] = value;\n        continue;\n      }\n\n      if (_.isObject(obj[i])) this.deepTransformObj(obj[i], path.concat([i]), test);\n    }\n  },\n  setMap: function setMap(map) {\n    for (var i in map) {\n      this.setCombined(i, map[i]);\n    }\n  },\n  getFromDispatch: function getFromDispatch(path) {\n    return this.getValue(path);\n  },\n  getVersion: function getVersion(path) {\n    var route = path.split(\".\");\n    var version = -1;\n    var versionsTree = this.state.version;\n\n    for (var i = 0; i < route.length; i++) {\n      var slot = route[i];\n      if (!versionsTree[slot]) return version;\n      versionsTree = versionsTree[slot];\n      if (versionsTree.version) version = versionsTree.version;\n    }\n\n    return version;\n  },\n  getVersionTree: function getVersionTree(path) {\n    var versionsTree = this.state.version;\n    return _.get(versionsTree, path);\n  },\n  updateVersionForAll: function updateVersionForAll(path) {\n    for (var i = 0; i < path.length; i++) {\n      _.set(this.state.version, path.slice(0, i).concat(\"version\"), this.state.currentVersion);\n      /*\n      \n      var node = _.get( this.state.version, path.slice(0,i) );\n      if ( !node ) break;\n      if ( node.version ) node.version = this.state.currentVersion;\n      */\n\n    }\n  },\n  updateVersion: function updateVersion(path) {\n    _.set(this.state.version, path + \".version\", this.state.currentVersion);\n  },\n  objectDiff: function difference(oldObject, newObject) {\n    function changes(oldO, newO) {\n      if (!_.isObject(oldO) || !_.isObject(newO)) return {\n        change: {\n          from: oldO,\n          to: newO\n        }\n      };\n      var result = {};\n      var hasChanges = false;\n\n      for (var i in newO) {\n        if (oldO[i] === undefined) {\n          result[i] = {\n            change: {\n              from: undefined,\n              to: newO[i],\n              type: \"added\"\n            }\n          };\n          hasChanges = true;\n        } else if (_.isFunction(newO[i]) && oldO[i] && newO[i].toString() != oldO[i].toString()) {\n          result[i] = {\n            change: {\n              from: oldO[i],\n              to: newO[i],\n              type: \"function changed\"\n            }\n          };\n          hasChanges = true;\n        } else if (_.isObject(newO[i])) {\n          var subChanges = changes(oldO[i], newO[i]);\n\n          if (subChanges) {\n            result[i] = subChanges;\n            hasChanges = true;\n          }\n        } else if (newO[i] != oldO[i]) {\n          result[i] = {\n            change: {\n              from: oldO[i],\n              to: newO[i],\n              type: \"changed\"\n            }\n          };\n          hasChanges = true;\n        }\n      }\n\n      for (var i in oldO) {\n        if (newO[i] === undefined) {\n          hasChanges = true;\n          result[i] = {\n            change: {\n              from: oldO[i],\n              to: null,\n              type: \"deleted\"\n            }\n          };\n        }\n      }\n\n      return hasChanges ? result : null;\n    }\n\n    return changes(oldObject, newObject);\n  },\n  act: function act(path, args, tb) {\n    var value = _.isObject(path) ? path : this.getValue(path);\n\n    if (!tb) {\n      tb = this.tb();\n    }\n\n    var act = ACT.init(value, this, args, path, tb);\n    return act;\n  },\n  tb: function tb() {\n    var tb = TB.init({}, this, null, {}, {}, {});\n    return tb;\n  }\n};\n\nvar DataManager = _DataManager.setup();\n\nvar ACT = {\n  master: null,\n  actions: null,\n  args: null,\n  init: function init(actions, master, args, path, tb) {\n    var item = Object.create(this);\n    item.master = master;\n    item.actions = actions;\n    item.args = args;\n    item.path = path;\n    item.tb = tb;\n    return item;\n  },\n  run: function run(name, args) {\n    return this.actions[name].apply(this.actions, [args, this.tb]);\n  }\n};\nvar TB = {\n  master: null,\n  logger: null,\n  spec: null,\n  step: null,\n  cache: null,\n  v: null,\n  init: function init(wallet, master, logger, spec, step, cache) {\n    var item = Object.create(this);\n    Object.assign(item, {\n      wallet: wallet,\n      master: master,\n      logger: logger,\n      spec: spec,\n      step: step,\n      cache: cache\n    });\n    item.v = {};\n    return item;\n  },\n  act: function act(path, args) {\n    var act = this.master.act(path, args, this);\n    return act;\n  },\n  go: function go(name, args) {\n    if (!this.toolbox) this.toolbox = DataManager.getValue(\"toolBox\");\n\n    if (!this.toolbox[name]) {\n      console.log(\"no \", name);\n      return null;\n    }\n\n    if (this.toolbox[name].run) return this.toolbox[name].run(args, this);else if (_.isFunction(this.toolbox[name])) return this.toolbox[name](args, this);\n  },\n  path: function path() {\n    return _.isArray(this.step.srcPath) ? this.step.srcPath.join(\".\") : this.step.srcPath;\n  },\n  fetch: function fetch(paths, target) {\n    return this.run_fetch(paths, target);\n  },\n  run_fetch: function run_fetch(paths, target, prefix) {\n    var _this5 = this;\n\n    var singlePath = false;\n\n    if (_.isString(paths) || paths.KEY) {\n      singlePath = true;\n      paths = {\n        SINGLEPATH: paths\n      };\n    }\n\n    var values = {};\n    this.master.fetchValues(values, paths, this.wallet, this.master, {\n      add: function add(path, slot) {\n        if (!_this5.logger) return;\n        var name = slot !== \"SINGLEPATH\" ? (prefix || []).concat(slot) : prefix || [];\n\n        _this5.logger.add(path, name.join(\".\"));\n      }\n    }, true);\n\n    for (var i in values) {\n      if (values[i] && values[i].type == \"routes\") {\n        var subPrefix = i != \"SINGLEPATH\" ? (prefix || []).concat(i) : prefix;\n        values[i] = this.run_fetch(values[i], null, subPrefix);\n      } else if (values[i] && values[i].type == \"value\") {//let subPrefix = i != \"SINGLEPATH\" ? (prefix || [] ).concat( i ) : prefix;\n        //values[ i ] = this.run_fetch( values[ i ], null, subPrefix )\n      } else if (values[i] && _.isString(values[i]) && values[i].charAt(0) == \"$\") {\n        var _subPrefix = i != \"SINGLEPATH\" ? (prefix || []).concat(i) : prefix;\n\n        values[i] = this.run_fetch(values[i].substring(2), null, _subPrefix);\n      }\n    }\n\n    if (singlePath) values = values.SINGLEPATH;\n\n    if (target) {\n      if (target.src) {\n        var src = values.src;\n        delete values.src;\n\n        _.merge(target.src, src);\n      }\n\n      Object.assign(target, values);\n      return target;\n    } else {\n      return values;\n    }\n  },\n  pathOf: function pathOf(path) {\n    var path = this.v.src[path];\n    if (path.key) return path.key;\n    if (_.isString(path)) return path;\n  },\n  set: function set(path, value) {\n    var target = this.v;\n    var route = _.isString(path) ? path.split(\".\") : path;\n    var last_src = null;\n\n    for (var i = 0; i < route.length; i++) {\n      var slot = route[i];\n\n      if (target.src && target.src[slot]) {\n        last_src = {\n          src: target.src[slot],\n          left: route.slice(i + 1)\n        };\n      }\n\n      if (!target[slot]) {\n        break;\n      }\n\n      target = target[slot];\n    }\n\n    if (last_src) {\n      var basePath = _.isString(last_src.src.key) ? last_src.src.key.split(\".\") : last_src.src.key.path;\n      var fullPath = basePath.concat(last_src.left).join(\".\");\n      this.master.set(fullPath, value);\n    }\n  },\n  detach: function detach() {\n    var detached = Object.create(this);\n    detached.v = {};\n    detached.logger = null;\n    return detached;\n  },\n  feed: function feed(path) {\n    var feedModel = this.master.getValue(path);\n    var feed = feedModel.init();\n    var start = 1;\n\n    for (var i = start; i < arguments.length; i++) {\n      feed.in(arguments[i]);\n    }\n\n    return feed;\n  }\n};\n\ntry {\n  if (!window.DataManager) {\n    window.DataManager = DataManager;\n    window._DataManager = _DataManager;\n  } //eval( 'export default DataManager' );\n\n} catch (e) {}","module.exports = __webpack_public_path__ + \"static/media/logo.06a44ff7.svg\";"],"sourceRoot":""}